<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Viktoriia Semenova">
<meta name="dcterms.date" content="2023-09-20">

<title>Lab 3: Describing Relationships</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="r4da-week03_files/libs/clipboard/clipboard.min.js"></script>
<script src="r4da-week03_files/libs/quarto-html/quarto.js"></script>
<script src="r4da-week03_files/libs/quarto-html/popper.min.js"></script>
<script src="r4da-week03_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="r4da-week03_files/libs/quarto-html/anchor.min.js"></script>
<link href="r4da-week03_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="r4da-week03_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="r4da-week03_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="r4da-week03_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="r4da-week03_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Lab 3: Describing Relationships</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Viktoriia Semenova </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 20, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div style="page-break-after: always;"></div>
<section id="last-week" class="level2">
<h2 class="anchored" data-anchor-id="last-week">Last Week</h2>
<ul>
<li>Introduction to <code>ggplot2</code> package for data visualization</li>
<li>Grammar of graphics</li>
<li>Descriptive statistics</li>
</ul>
</section>
<section id="leftovers-from-last-time" class="level2">
<h2 class="anchored" data-anchor-id="leftovers-from-last-time">Leftovers from Last Time</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pei <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(<span class="st">"data/PEI country-level data (PEI_9.0).dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="grammar-of-graphics" class="level3">
<h3 class="anchored" data-anchor-id="grammar-of-graphics">Grammar of Graphics</h3>
<p>Recall that we have multiple layers in the plots:</p>
<ul>
<li><em>data</em>: the dataset containing the variables of interest.</li>
<li><em>aes</em>: aesthetic attributes of the geometric object. The most important are the names of the variables that should be on the x- and y-axes. Aesthetic attributes are mapped to variables in the dataset.</li>
<li><em>geom</em>: the geometric object to display, e.g., scatterplot, line, bar.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> [dataset],</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> [x <span class="sc">-</span> variable],</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> [y <span class="sc">-</span> variable]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_xxx</span>() <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  other options</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="distributions-of-continuous-variables" class="level3">
<h3 class="anchored" data-anchor-id="distributions-of-continuous-variables">Distributions of Continuous Variables</h3>
<section id="boxplot-violin-plot-and-observations-layers-combined" class="level4">
<h4 class="anchored" data-anchor-id="boxplot-violin-plot-and-observations-layers-combined">Boxplot, Violin Plot, and Observations Layers Combined</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp, <span class="at">y =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="co"># adds points with a little random noise (i.e. tiny shifts on both x and y coordinates)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_ydensity()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="distributions-of-discrete-and-categorial-variables" class="level3">
<h3 class="anchored" data-anchor-id="distributions-of-discrete-and-categorial-variables">Distributions of Discrete and Categorial Variables</h3>
<section id="barplot" class="level4">
<h4 class="anchored" data-anchor-id="barplot">Barplot</h4>
<p><code>geom_bar()</code> visualizes the distribution of a categorical or discrete variable. This is a simpler task than creating a histogram, as we are simply counting different categories within a categorical variable, also known as the levels of the categorical variable. Often the best way to visualize these different counts, also known as frequencies, is with a barplot.</p>
<p>Let’s recode the variable <code>region</code> to be more readable and visualize the counts:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pei <span class="ot">&lt;-</span> pei <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">region =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Africa"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Americas"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Asia"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Europe"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Oceania"</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(pei, region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  region       n
  &lt;chr&gt;    &lt;int&gt;
1 Africa      48
2 Americas    30
3 Asia        32
4 Europe      49
5 Oceania     10</code></pre>
</div>
</div>
<p>In bar plots of categorical variables with non-ordered levels, it’s often preferable to reorder the bars based on their frequencies. Doing so requires transforming the variable to a factor (how <code>R</code> handles categorical data) and then reordering the levels of that factor. Below you can find both versions of bar plots:</p>
<div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> region)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> forcats<span class="sc">::</span><span class="fu">fct_infreq</span>(region))) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<section id="category-ordering" class="level5">
<h5 class="anchored" data-anchor-id="category-ordering">Category Ordering</h5>
<p>We can also choose to show the bars horizontally rather than vertically by setting a different axis for <code>region</code>:</p>
<div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> region <span class="sc">%&gt;%</span> <span class="fu">fct_infreq</span>())) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> region <span class="sc">%&gt;%</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">fct_infreq</span>() <span class="sc">%&gt;%</span> <span class="co"># order in frequency</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">fct_rev</span>() <span class="co"># reverse the order </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                     )) <span class="sc">+</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="proportions-vs.-counts" class="level5">
<h5 class="anchored" data-anchor-id="proportions-vs.-counts">Proportions vs.&nbsp;Counts</h5>
<p>There is also a way to show proportions, rather than counts, on the vertical axis… (we can always explicitly calculate these quantities and plot them of course). By default, <code>ggplot</code> creates one group per each bar, so all the proportions are set to 1 (on the left).</p>
<div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> region,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> ..prop..)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..prop..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(prop)` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> region,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> ..prop..,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="important-nuances" class="level3">
<h3 class="anchored" data-anchor-id="important-nuances">Important Nuances</h3>
<section id="order-of-layers-matters" class="level4">
<h4 class="anchored" data-anchor-id="order-of-layers-matters">Order of Layers Matters</h4>
<div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp, <span class="at">y =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_ydensity()`).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp, <span class="at">y =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_ydensity()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="global-vs.-local-mapping" class="level4">
<h4 class="anchored" data-anchor-id="global-vs.-local-mapping">Global vs.&nbsp;Local Mapping</h4>
<p>The plots below illustrate the differences between setting mappings globally, i.e.&nbsp;in <code>ggplot(aes(...))</code> layer and locally, i.e.&nbsp;in <code>geom_</code> layers.</p>
<div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp, <span class="at">y =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_ydensity()`).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei, <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_boxplot()`).
Removed 21 rows containing non-finite values (`stat_ydensity()`).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei)  <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp, <span class="at">y =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_boxplot()`).
Removed 21 rows containing non-finite values (`stat_ydensity()`).</code></pre>
</div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p>While it is often more efficient to set the aesthetics globally, sometimes you may want to show related but different quantities on the plot, so setting aesthetics locally becomes necessary.</p>
</section>
<section id="setting-vs.-mapping" class="level4">
<h4 class="anchored" data-anchor-id="setting-vs.-mapping">Setting vs.&nbsp;Mapping</h4>
<p>So far, we have primarily been using color with no substantive purpose: we were <em>setting</em> it to a particular value. Yet we can use color in mappings, too. - We <em>map</em> variables to aesthetics (e.g.&nbsp;color/fill or shape) if we want the visual attribute represented by that aesthetic to vary based on the values of that <em>variable</em>. This goes inside <code>aes()</code>. - Otherwise, we <em>set</em> the value of an aesthetic. The choice of this value is on us. This goes into <code>geom_</code>.</p>
<div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(region))) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setting can overwrite the mapping </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp)) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(region)), <span class="at">color =</span> <span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mixing up setting and mapping </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp)) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="saving-plot-objects" class="level3">
<h3 class="anchored" data-anchor-id="saving-plot-objects">Saving Plot Objects</h3>
<p>Plots are <code>R</code> objects, just like vectors or data frames. We can create them, print them and save them. Up until now, we have just made them in an <code>R</code> code chunk. That is what most often you will be doing when working with Quarto. Sometimes, however, it is handy to work with a plot object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>my_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(region))) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This code above does not print anything out. In order to make this plot appear, we need to print it out explicitly. Recall that typing the name of an object is the same thing as using <code>print()</code>. Now that we have this object, we can display it whenever we want.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>my_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>But, sometimes, we want a permanent copy of the plot outside of <code>R</code>, saved to our computer. That is the purpose of <code>ggsave()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"figures/pei_plot.png"</span>,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> my_plot</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
</div>
<p>We can then include it into <code>qmd</code> files as an external image like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="at">path =</span> <span class="st">"figures/pei_plot.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="figures/pei_plot.png" class="img-fluid" width="1050"></p>
</div>
</div>
</section>
</section>
<section id="plotting-two-or-more-variables" class="level2">
<h2 class="anchored" data-anchor-id="plotting-two-or-more-variables">Plotting Two or More Variables</h2>
<section id="two-variables-continuous" class="level3">
<h3 class="anchored" data-anchor-id="two-variables-continuous">Two Variables: Continuous</h3>
<p><em>Scatterplots</em>, also called bivariate plots, allow you to visualize the relationship between two numerical variables. The most appropriate <code>geom</code> for that is usually <code>geom_point()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> PEIIndexi,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> gdp_pc_ppp)) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="co"># plots the observations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let’s break down this code, piece-by-piece.</p>
<ul>
<li>The data argument is set to trains via <code>data = pei</code>.</li>
<li>The aesthetic mapping is set via <code>mapping = aes(x = PEIIndexi, y = gdp_pc_ppp)</code>. Here, we map <code>PEIIndexi</code> to the x axis and <code>gdp_pc_ppp</code> to the <code>y</code> axis.</li>
<li>The geometric object is specified using <code>geom_point()</code>, telling <code>R</code> we want a scatterplot. We added a layer using the <code>+</code> sign.</li>
</ul>
<p><code>geom_point</code> works fine on its own if we don’t have <em>too</em> many observations and when there are many distinct values in the variables we plot.</p>
<section id="geom_smooth" class="level4">
<h4 class="anchored" data-anchor-id="geom_smooth"><code>geom_smooth</code></h4>
<div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> PEIIndexi,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> gdp_pc_ppp)) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># plots the observations </span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'loess'</span>, <span class="at">formula =</span> <span class="st">'y ~ x'</span>,  <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> PEIIndexi,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> gdp_pc_ppp)) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># plots the observations </span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">formula =</span> <span class="st">'y ~ x'</span>,  <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite values (`stat_smooth()`).
Removed 2 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p>When needed, transformations to variables can applied directly in the mapping (these changes will not be saved in the dataset).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> PEIIndexi,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> <span class="fu">log</span>(gdp_pc_ppp))) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># plots the observations </span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">formula =</span> <span class="st">'y ~ x'</span>,  <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="three-variables-two-continuous-categorical" class="level3">
<h3 class="anchored" data-anchor-id="three-variables-two-continuous-categorical">Three Variables: Two Continuous + Categorical</h3>
<div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> PEIIndexi,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> gdp_pc_ppp,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> region <span class="co"># add color by region </span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> PEIIndexi,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> gdp_pc_ppp,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> region  <span class="co"># add color by region </span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="co"># make colors colorblind-friendly</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="two-variables-continous-and-categorical" class="level3">
<h3 class="anchored" data-anchor-id="two-variables-continous-and-categorical">Two Variables: Continous and Categorical</h3>
<p>Let’s consider a few options for plotting such combinations of variables:</p>
<div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> PEIIndexi,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> region)) <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> PEIIndexi,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> region)) <span class="sc">+</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>) </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> PEIIndexi,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> region)) <span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() </span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexi,</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> region)) <span class="sc">+</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() </span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexi,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> region,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) </span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexi)) <span class="sc">+</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(region))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-19-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-19-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-19-6.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="two-categorical-variables" class="level3">
<h3 class="anchored" data-anchor-id="two-categorical-variables">Two Categorical Variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> oecd,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> region</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">factor</span>(oecd),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> region</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">factor</span>(oecd),</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> region</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pei, <span class="fu">aes</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> region,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="fu">factor</span>(oecd)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-20-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pei, <span class="fu">aes</span>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> region,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="fu">factor</span>(oecd)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-20-5.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="basic-data-wrangling-functions" class="level2">
<h2 class="anchored" data-anchor-id="basic-data-wrangling-functions">Basic Data Wrangling Functions</h2>
<p>We can’t use all the beautiful plots until we have “wrangled” the data into a convenient shape and have all the variables we need for plotting. You have seen some of these functions already, but let’s now look at them a bit more systematically. Key wrangling functions include:</p>
<ul>
<li><p><code>filter()</code>: to pick out the <em>rows</em> we want to keep from a tibble.</p></li>
<li><p><code>select()</code>: to pick out the <em>columns</em> we want to keep from a tibble.</p></li>
<li><p><code>arrange()</code>: to sort the rows in a tibble, in either ascending or descending order.</p></li>
<li><p><code>mutate()</code>: to create new columns.</p></li>
<li><p><code>summarize()</code>: to create a new tibble comprised of summary statistics for one (or more) rows, depending on the use of the <code>.by</code> argument.</p></li>
</ul>
<section id="the-pipe-operator-again" class="level3">
<h3 class="anchored" data-anchor-id="the-pipe-operator-again">The pipe operator: <code>%&gt;%</code> (again)</h3>
<p>The pipe operator (<code>%&gt;%</code>) allows us to combine multiple operations in <code>R</code> into a single sequential <em>chain</em> of actions. Much like how the <code>+</code> sign has to come at the end of the line when constructing plots — because we are building the plot layer-by-layer — the pipe operator <code>%&gt;%</code> has to come at the end of the line because we are building a data wrangling pipeline step-by-step. If you do not include the pipe operator, R assumes the next line of code is unrelated to the layers you built and you will get an error.</p>
</section>
<section id="filter-rows" class="level3">
<h3 class="anchored" data-anchor-id="filter-rows"><code>filter</code> rows</h3>
<p>The <code>filter()</code> function works much like the “Filter” option in Microsoft Excel. It allows you to specify criteria about the values of a variable in your dataset and then selects only the rows that match that criteria.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only Europe (show, not store in the environment)</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"Europe"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 49 × 169
   country ISO   y2012   y2013   y2014   y2015   y2016   y2017   y2018   y2019  
   &lt;chr&gt;   &lt;chr&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
 1 Albania ALB   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res…
 2 Armenia ARM   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res…
 3 Austria AUT   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201…
 4 Azerba… AZE   0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 5 Belgium BEL   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 6 Bulgar… BGR   0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res…
 7 Bosnia  BIH   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 8 Belarus BLR   1 [201… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res… 1 [201…
 9 Switze… CHE   0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201…
10 Cyprus  CYP   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res…
# ℹ 39 more rows
# ℹ 159 more variables: y2020 &lt;dbl+lbl&gt;, y2021 &lt;dbl+lbl&gt;, y2022 &lt;dbl+lbl&gt;,
#   COUNTRYDATA &lt;dbl&gt;, PR &lt;dbl&gt;, CL &lt;dbl&gt;, development &lt;dbl&gt;, gdp_pc_ppp &lt;dbl&gt;,
#   region &lt;chr&gt;, region9 &lt;dbl+lbl&gt;, oecd &lt;dbl&gt;, OVERALLINTEGRITY &lt;dbl&gt;,
#   PEIIndexp &lt;dbl&gt;, PEIIndexi &lt;dbl&gt;, rating &lt;dbl&gt;, LAWS &lt;dbl&gt;,
#   lawsunfair &lt;dbl&gt;, lawsunfair2 &lt;dbl&gt;, favoredincumbent &lt;dbl&gt;,
#   favoredincumbent2 &lt;dbl&gt;, citizens &lt;dbl&gt;, citizens2 &lt;dbl&gt;, laws &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>Here are a few more operators that we can use here:</p>
<ul>
<li><code>&gt;</code> for “greater than”</li>
<li><code>&lt;</code> for “less than”</li>
<li><code>&gt;=</code> for “greater than or equal to”</li>
<li><code>&lt;=</code> for “less than or equal to”</li>
<li><code>!=</code> for “not equal to”</li>
<li><code>%in%</code> for “inside”</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># everything but Europe (show, not store in the environment)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">!=</span> <span class="st">"Europe"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 120 × 169
   country ISO   y2012   y2013   y2014   y2015   y2016   y2017   y2018   y2019  
   &lt;chr&gt;   &lt;chr&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
 1 Afghan… AFG   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201…
 2 Angola  AGO   1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res…
 3 Argent… ARG   0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201…
 4 Antigu… ATG   0 [Res… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 5 Austra… AUS   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201…
 6 Burundi BDI   0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res…
 7 Benin   BEN   0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res… 1 [201…
 8 Burkin… BFA   1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res…
 9 Bangla… BGD   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 0 [Res…
10 Bahrain BHR   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
# ℹ 110 more rows
# ℹ 159 more variables: y2020 &lt;dbl+lbl&gt;, y2021 &lt;dbl+lbl&gt;, y2022 &lt;dbl+lbl&gt;,
#   COUNTRYDATA &lt;dbl&gt;, PR &lt;dbl&gt;, CL &lt;dbl&gt;, development &lt;dbl&gt;, gdp_pc_ppp &lt;dbl&gt;,
#   region &lt;chr&gt;, region9 &lt;dbl+lbl&gt;, oecd &lt;dbl&gt;, OVERALLINTEGRITY &lt;dbl&gt;,
#   PEIIndexp &lt;dbl&gt;, PEIIndexi &lt;dbl&gt;, rating &lt;dbl&gt;, LAWS &lt;dbl&gt;,
#   lawsunfair &lt;dbl&gt;, lawsunfair2 &lt;dbl&gt;, favoredincumbent &lt;dbl&gt;,
#   favoredincumbent2 &lt;dbl&gt;, citizens &lt;dbl&gt;, citizens2 &lt;dbl&gt;, laws &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># every row where PEI index is ABOVE 50</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PEIIndexi <span class="sc">&gt;</span> <span class="dv">55</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 84 × 169
   country ISO   y2012   y2013   y2014   y2015   y2016   y2017   y2018   y2019  
   &lt;chr&gt;   &lt;chr&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
 1 Argent… ARG   0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201…
 2 Armenia ARM   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res…
 3 Austra… AUS   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201…
 4 Austria AUT   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201…
 5 Belgium BEL   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 6 Benin   BEN   0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res… 1 [201…
 7 Bulgar… BGR   0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res…
 8 Brazil  BRA   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 9 Barbad… BRB   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
10 Bhutan  BTN   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
# ℹ 74 more rows
# ℹ 159 more variables: y2020 &lt;dbl+lbl&gt;, y2021 &lt;dbl+lbl&gt;, y2022 &lt;dbl+lbl&gt;,
#   COUNTRYDATA &lt;dbl&gt;, PR &lt;dbl&gt;, CL &lt;dbl&gt;, development &lt;dbl&gt;, gdp_pc_ppp &lt;dbl&gt;,
#   region &lt;chr&gt;, region9 &lt;dbl+lbl&gt;, oecd &lt;dbl&gt;, OVERALLINTEGRITY &lt;dbl&gt;,
#   PEIIndexp &lt;dbl&gt;, PEIIndexi &lt;dbl&gt;, rating &lt;dbl&gt;, LAWS &lt;dbl&gt;,
#   lawsunfair &lt;dbl&gt;, lawsunfair2 &lt;dbl&gt;, favoredincumbent &lt;dbl&gt;,
#   favoredincumbent2 &lt;dbl&gt;, citizens &lt;dbl&gt;, citizens2 &lt;dbl&gt;, laws &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># every row where PEI type is ABOVE 3</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PEItype <span class="sc">&gt;</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 61 × 169
   country ISO   y2012   y2013   y2014   y2015   y2016   y2017   y2018   y2019  
   &lt;chr&gt;   &lt;chr&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
 1 Argent… ARG   0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201…
 2 Austra… AUS   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201…
 3 Austria AUT   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201…
 4 Belgium BEL   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 5 Bulgar… BGR   0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res…
 6 Brazil  BRA   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 7 Barbad… BRB   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 8 Bhutan  BTN   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 9 Canada  CAN   0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201…
10 Switze… CHE   0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201…
# ℹ 51 more rows
# ℹ 159 more variables: y2020 &lt;dbl+lbl&gt;, y2021 &lt;dbl+lbl&gt;, y2022 &lt;dbl+lbl&gt;,
#   COUNTRYDATA &lt;dbl&gt;, PR &lt;dbl&gt;, CL &lt;dbl&gt;, development &lt;dbl&gt;, gdp_pc_ppp &lt;dbl&gt;,
#   region &lt;chr&gt;, region9 &lt;dbl+lbl&gt;, oecd &lt;dbl&gt;, OVERALLINTEGRITY &lt;dbl&gt;,
#   PEIIndexp &lt;dbl&gt;, PEIIndexi &lt;dbl&gt;, rating &lt;dbl&gt;, LAWS &lt;dbl&gt;,
#   lawsunfair &lt;dbl&gt;, lawsunfair2 &lt;dbl&gt;, favoredincumbent &lt;dbl&gt;,
#   favoredincumbent2 &lt;dbl&gt;, citizens &lt;dbl&gt;, citizens2 &lt;dbl&gt;, laws &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># every row where PEI index is EQUAL TO or ABOVE 50</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PEIIndexi <span class="sc">&gt;=</span> <span class="dv">55</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 84 × 169
   country ISO   y2012   y2013   y2014   y2015   y2016   y2017   y2018   y2019  
   &lt;chr&gt;   &lt;chr&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
 1 Argent… ARG   0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201…
 2 Armenia ARM   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res…
 3 Austra… AUS   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201…
 4 Austria AUT   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201…
 5 Belgium BEL   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 6 Benin   BEN   0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res… 1 [201…
 7 Bulgar… BGR   0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res…
 8 Brazil  BRA   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 9 Barbad… BRB   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
10 Bhutan  BTN   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
# ℹ 74 more rows
# ℹ 159 more variables: y2020 &lt;dbl+lbl&gt;, y2021 &lt;dbl+lbl&gt;, y2022 &lt;dbl+lbl&gt;,
#   COUNTRYDATA &lt;dbl&gt;, PR &lt;dbl&gt;, CL &lt;dbl&gt;, development &lt;dbl&gt;, gdp_pc_ppp &lt;dbl&gt;,
#   region &lt;chr&gt;, region9 &lt;dbl+lbl&gt;, oecd &lt;dbl&gt;, OVERALLINTEGRITY &lt;dbl&gt;,
#   PEIIndexp &lt;dbl&gt;, PEIIndexi &lt;dbl&gt;, rating &lt;dbl&gt;, LAWS &lt;dbl&gt;,
#   lawsunfair &lt;dbl&gt;, lawsunfair2 &lt;dbl&gt;, favoredincumbent &lt;dbl&gt;,
#   favoredincumbent2 &lt;dbl&gt;, citizens &lt;dbl&gt;, citizens2 &lt;dbl&gt;, laws &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># every row where PEI type is EQUAL TO or ABOVE 3</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PEItype <span class="sc">&gt;=</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 104 × 169
   country ISO   y2012   y2013   y2014   y2015   y2016   y2017   y2018   y2019  
   &lt;chr&gt;   &lt;chr&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
 1 Argent… ARG   0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201…
 2 Armenia ARM   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res…
 3 Austra… AUS   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201…
 4 Austria AUT   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201…
 5 Belgium BEL   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 6 Benin   BEN   0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res… 1 [201…
 7 Bulgar… BGR   0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res…
 8 Bahamas BHS   0 [Res… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res…
 9 Bosnia  BIH   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
10 Belize  BLZ   0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res…
# ℹ 94 more rows
# ℹ 159 more variables: y2020 &lt;dbl+lbl&gt;, y2021 &lt;dbl+lbl&gt;, y2022 &lt;dbl+lbl&gt;,
#   COUNTRYDATA &lt;dbl&gt;, PR &lt;dbl&gt;, CL &lt;dbl&gt;, development &lt;dbl&gt;, gdp_pc_ppp &lt;dbl&gt;,
#   region &lt;chr&gt;, region9 &lt;dbl+lbl&gt;, oecd &lt;dbl&gt;, OVERALLINTEGRITY &lt;dbl&gt;,
#   PEIIndexp &lt;dbl&gt;, PEIIndexi &lt;dbl&gt;, rating &lt;dbl&gt;, LAWS &lt;dbl&gt;,
#   lawsunfair &lt;dbl&gt;, lawsunfair2 &lt;dbl&gt;, favoredincumbent &lt;dbl&gt;,
#   favoredincumbent2 &lt;dbl&gt;, citizens &lt;dbl&gt;, citizens2 &lt;dbl&gt;, laws &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>Furthermore, you can combine multiple criteria using operators that make comparisons:</p>
<ul>
<li><code>|</code> for “or”</li>
<li><code>&amp;</code> for “and” (or just <code>,</code>)</li>
<li><code>!</code> for “not”</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># every row where PEI type is EQUAL TO or ABOVE 3</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    PEItype <span class="sc">&lt;=</span> <span class="dv">3</span>,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"Europe"</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 169
   country ISO   y2012   y2013   y2014   y2015   y2016   y2017   y2018   y2019  
   &lt;chr&gt;   &lt;chr&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
 1 Albania ALB   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res…
 2 Armenia ARM   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res…
 3 Azerba… AZE   0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 4 Bosnia  BIH   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 5 Belarus BLR   1 [201… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res… 1 [201…
 6 Georgia GEO   1 [201… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res…
 7 Hungary HUN   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 8 Kazakh… KAZ   0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res… 1 [201…
 9 Kyrgyz… KGZ   0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 0 [Res…
10 Moldova MDA   0 [Res… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res…
11 Macedo… MKD   0 [Res… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201…
12 Monten… MNE   1 [201… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res…
13 Romania ROU   1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201…
14 Russia  RUS   0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res…
15 Serbia  SRB   0 [Res… 0 [Res… 1 [201… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res…
16 Tajiki… TJK   0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res…
17 Turkme… TKM   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res…
18 Turkey  TUR   0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res…
19 Ukraine UKR   1 [201… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201…
20 Uzbeki… UZB   0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res… 0 [Res…
# ℹ 159 more variables: y2020 &lt;dbl+lbl&gt;, y2021 &lt;dbl+lbl&gt;, y2022 &lt;dbl+lbl&gt;,
#   COUNTRYDATA &lt;dbl&gt;, PR &lt;dbl&gt;, CL &lt;dbl&gt;, development &lt;dbl&gt;, gdp_pc_ppp &lt;dbl&gt;,
#   region &lt;chr&gt;, region9 &lt;dbl+lbl&gt;, oecd &lt;dbl&gt;, OVERALLINTEGRITY &lt;dbl&gt;,
#   PEIIndexp &lt;dbl&gt;, PEIIndexi &lt;dbl&gt;, rating &lt;dbl&gt;, LAWS &lt;dbl&gt;,
#   lawsunfair &lt;dbl&gt;, lawsunfair2 &lt;dbl&gt;, favoredincumbent &lt;dbl&gt;,
#   favoredincumbent2 &lt;dbl&gt;, citizens &lt;dbl&gt;, citizens2 &lt;dbl&gt;, laws &lt;dbl&gt;,
#   lawsi &lt;dbl&gt;, PROCEDURES &lt;dbl&gt;, managed &lt;dbl&gt;, votinginfo &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select every observation that is in Europe or Asia, has PEI index above 50, and GDP above average </span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    PEIIndexi <span class="sc">&gt;</span> <span class="dv">50</span>,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"Europe"</span> <span class="sc">|</span> region <span class="sc">==</span> <span class="st">"Asia"</span>,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    gdp_pc_ppp <span class="sc">&gt;</span> <span class="fu">mean</span>(gdp_pc_ppp, <span class="at">na.rm =</span> T)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 38 × 169
   country ISO   y2012   y2013   y2014   y2015   y2016   y2017   y2018   y2019  
   &lt;chr&gt;   &lt;chr&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
 1 Austria AUT   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201…
 2 Belgium BEL   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 3 Bulgar… BGR   0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res…
 4 Switze… CHE   0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 5 Cyprus  CYP   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res…
 6 Czech … CZE   1 [201… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res…
 7 Germany DEU   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res…
 8 Denmark DNK   0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 9 Spain   ESP   0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res… 1 [201…
10 Estonia EST   0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201…
# ℹ 28 more rows
# ℹ 159 more variables: y2020 &lt;dbl+lbl&gt;, y2021 &lt;dbl+lbl&gt;, y2022 &lt;dbl+lbl&gt;,
#   COUNTRYDATA &lt;dbl&gt;, PR &lt;dbl&gt;, CL &lt;dbl&gt;, development &lt;dbl&gt;, gdp_pc_ppp &lt;dbl&gt;,
#   region &lt;chr&gt;, region9 &lt;dbl+lbl&gt;, oecd &lt;dbl&gt;, OVERALLINTEGRITY &lt;dbl&gt;,
#   PEIIndexp &lt;dbl&gt;, PEIIndexi &lt;dbl&gt;, rating &lt;dbl&gt;, LAWS &lt;dbl&gt;,
#   lawsunfair &lt;dbl&gt;, lawsunfair2 &lt;dbl&gt;, favoredincumbent &lt;dbl&gt;,
#   favoredincumbent2 &lt;dbl&gt;, citizens &lt;dbl&gt;, citizens2 &lt;dbl&gt;, laws &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same result but %in% instead or OR (|) for regions  </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    PEIIndexi <span class="sc">&gt;</span> <span class="dv">50</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Europe"</span>, <span class="st">"Asia"</span>),</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    gdp_pc_ppp <span class="sc">&gt;</span> <span class="fu">mean</span>(gdp_pc_ppp, <span class="at">na.rm =</span> T)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 38 × 169
   country ISO   y2012   y2013   y2014   y2015   y2016   y2017   y2018   y2019  
   &lt;chr&gt;   &lt;chr&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
 1 Austria AUT   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201…
 2 Belgium BEL   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 3 Bulgar… BGR   0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res…
 4 Switze… CHE   0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 5 Cyprus  CYP   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res…
 6 Czech … CZE   1 [201… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res…
 7 Germany DEU   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res…
 8 Denmark DNK   0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 9 Spain   ESP   0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res… 1 [201…
10 Estonia EST   0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201…
# ℹ 28 more rows
# ℹ 159 more variables: y2020 &lt;dbl+lbl&gt;, y2021 &lt;dbl+lbl&gt;, y2022 &lt;dbl+lbl&gt;,
#   COUNTRYDATA &lt;dbl&gt;, PR &lt;dbl&gt;, CL &lt;dbl&gt;, development &lt;dbl&gt;, gdp_pc_ppp &lt;dbl&gt;,
#   region &lt;chr&gt;, region9 &lt;dbl+lbl&gt;, oecd &lt;dbl&gt;, OVERALLINTEGRITY &lt;dbl&gt;,
#   PEIIndexp &lt;dbl&gt;, PEIIndexi &lt;dbl&gt;, rating &lt;dbl&gt;, LAWS &lt;dbl&gt;,
#   lawsunfair &lt;dbl&gt;, lawsunfair2 &lt;dbl&gt;, favoredincumbent &lt;dbl&gt;,
#   favoredincumbent2 &lt;dbl&gt;, citizens &lt;dbl&gt;, citizens2 &lt;dbl&gt;, laws &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select every observation that is in not in Europe nor Asia, has PEI index above or equal to 40, and GDP above median </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="select-variables" class="level3">
<h3 class="anchored" data-anchor-id="select-variables"><code>select</code> variables</h3>
<p>This is used for subsetting variables (columns, not rows), deleting columns, and re-arranging columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select PEIIndexi and ISO variables only </span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(PEIIndexi, ISO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 169 × 2
   PEIIndexi ISO  
       &lt;dbl&gt; &lt;chr&gt;
 1      34.6 AFG  
 2      36.3 AGO  
 3      49.7 ALB  
 4      66.6 ARG  
 5      57.7 ARM  
 6      47.9 ATG  
 7      69.8 AUS  
 8      78.9 AUT  
 9      36.1 AZE  
10      27.1 BDI  
# ℹ 159 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove ISO and y2012 variables </span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>ISO, <span class="sc">-</span>y2012)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 169 × 167
   country       y2013   y2014   y2015   y2016   y2017   y2018   y2019   y2020  
   &lt;chr&gt;         &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
 1 Afghanistan   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res…
 2 Angola        0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res…
 3 Albania       1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res…
 4 Argentina     1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res…
 5 Armenia       1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res…
 6 Antigua and … 0 [Res… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res…
 7 Australia     1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 8 Austria       1 [201… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201… 0 [Res…
 9 Azerbaijan    1 [201… 0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res… 1 [202…
10 Burundi       0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [202…
# ℹ 159 more rows
# ℹ 158 more variables: y2021 &lt;dbl+lbl&gt;, y2022 &lt;dbl+lbl&gt;, COUNTRYDATA &lt;dbl&gt;,
#   PR &lt;dbl&gt;, CL &lt;dbl&gt;, development &lt;dbl&gt;, gdp_pc_ppp &lt;dbl&gt;, region &lt;chr&gt;,
#   region9 &lt;dbl+lbl&gt;, oecd &lt;dbl&gt;, OVERALLINTEGRITY &lt;dbl&gt;, PEIIndexp &lt;dbl&gt;,
#   PEIIndexi &lt;dbl&gt;, rating &lt;dbl&gt;, LAWS &lt;dbl&gt;, lawsunfair &lt;dbl&gt;,
#   lawsunfair2 &lt;dbl&gt;, favoredincumbent &lt;dbl&gt;, favoredincumbent2 &lt;dbl&gt;,
#   citizens &lt;dbl&gt;, citizens2 &lt;dbl&gt;, laws &lt;dbl&gt;, lawsi &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change the order of columns in dataset </span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(PEIIndexi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 169 × 169
   PEIIndexi country       ISO   y2012   y2013   y2014   y2015   y2016   y2017  
       &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
 1      34.6 Afghanistan   AFG   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res…
 2      36.3 Angola        AGO   1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 3      49.7 Albania       ALB   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 4      66.6 Argentina     ARG   0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201…
 5      57.7 Armenia       ARM   0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 6      47.9 Antigua and … ATG   0 [Res… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 0 [Res…
 7      69.8 Australia     AUS   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 8      78.9 Austria       AUT   0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 1 [201…
 9      36.1 Azerbaijan    AZE   0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 0 [Res…
10      27.1 Burundi       BDI   0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res…
# ℹ 159 more rows
# ℹ 160 more variables: y2018 &lt;dbl+lbl&gt;, y2019 &lt;dbl+lbl&gt;, y2020 &lt;dbl+lbl&gt;,
#   y2021 &lt;dbl+lbl&gt;, y2022 &lt;dbl+lbl&gt;, COUNTRYDATA &lt;dbl&gt;, PR &lt;dbl&gt;, CL &lt;dbl&gt;,
#   development &lt;dbl&gt;, gdp_pc_ppp &lt;dbl&gt;, region &lt;chr&gt;, region9 &lt;dbl+lbl&gt;,
#   oecd &lt;dbl&gt;, OVERALLINTEGRITY &lt;dbl&gt;, PEIIndexp &lt;dbl&gt;, rating &lt;dbl&gt;,
#   LAWS &lt;dbl&gt;, lawsunfair &lt;dbl&gt;, lawsunfair2 &lt;dbl&gt;, favoredincumbent &lt;dbl&gt;,
#   favoredincumbent2 &lt;dbl&gt;, citizens &lt;dbl&gt;, citizens2 &lt;dbl&gt;, laws &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change the order of columns in dataset </span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ISO, PEIIndexi, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 169 × 169
   ISO   PEIIndexi country       y2012   y2013   y2014   y2015   y2016   y2017  
   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;         &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
 1 AFG        34.6 Afghanistan   0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res…
 2 AGO        36.3 Angola        1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 3 ALB        49.7 Albania       0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 4 ARG        66.6 Argentina     0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201…
 5 ARM        57.7 Armenia       0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res… 1 [201…
 6 ATG        47.9 Antigua and … 0 [Res… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 0 [Res…
 7 AUS        69.8 Australia     0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 8 AUT        78.9 Austria       0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 1 [201…
 9 AZE        36.1 Azerbaijan    0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res… 0 [Res…
10 BDI        27.1 Burundi       0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res…
# ℹ 159 more rows
# ℹ 160 more variables: y2018 &lt;dbl+lbl&gt;, y2019 &lt;dbl+lbl&gt;, y2020 &lt;dbl+lbl&gt;,
#   y2021 &lt;dbl+lbl&gt;, y2022 &lt;dbl+lbl&gt;, COUNTRYDATA &lt;dbl&gt;, PR &lt;dbl&gt;, CL &lt;dbl&gt;,
#   development &lt;dbl&gt;, gdp_pc_ppp &lt;dbl&gt;, region &lt;chr&gt;, region9 &lt;dbl+lbl&gt;,
#   oecd &lt;dbl&gt;, OVERALLINTEGRITY &lt;dbl&gt;, PEIIndexp &lt;dbl&gt;, rating &lt;dbl&gt;,
#   LAWS &lt;dbl&gt;, lawsunfair &lt;dbl&gt;, lawsunfair2 &lt;dbl&gt;, favoredincumbent &lt;dbl&gt;,
#   favoredincumbent2 &lt;dbl&gt;, citizens &lt;dbl&gt;, citizens2 &lt;dbl&gt;, laws &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only select variables starting with "y"</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"y"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 169 × 11
   y2012     y2013     y2014     y2015   y2016   y2017   y2018   y2019   y2020  
   &lt;dbl+lbl&gt; &lt;dbl+lbl&gt; &lt;dbl+lbl&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;
 1 0 [Rest]  0 [Rest]  1 [2014]  0 [Res… 0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res…
 2 1 [2012]  0 [Rest]  0 [Rest]  0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res…
 3 0 [Rest]  1 [2013]  0 [Rest]  0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res… 0 [Res…
 4 0 [Rest]  1 [2013]  0 [Rest]  1 [201… 0 [Res… 1 [201… 0 [Res… 1 [201… 0 [Res…
 5 0 [Rest]  1 [2013]  0 [Rest]  0 [Res… 0 [Res… 1 [201… 1 [201… 0 [Res… 0 [Res…
 6 0 [Rest]  0 [Rest]  0 [Rest]  0 [Res… 0 [Res… 0 [Res… 1 [201… 0 [Res… 0 [Res…
 7 0 [Rest]  1 [2013]  0 [Rest]  0 [Res… 1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res…
 8 0 [Rest]  1 [2013]  0 [Rest]  0 [Res… 1 [201… 1 [201… 0 [Res… 1 [201… 0 [Res…
 9 0 [Rest]  1 [2013]  0 [Rest]  1 [201… 0 [Res… 0 [Res… 1 [201… 0 [Res… 1 [202…
10 0 [Rest]  0 [Rest]  0 [Rest]  1 [201… 0 [Res… 0 [Res… 0 [Res… 0 [Res… 1 [202…
# ℹ 159 more rows
# ℹ 2 more variables: y2021 &lt;dbl+lbl&gt;, y2022 &lt;dbl+lbl&gt;</code></pre>
</div>
</div>
</section>
<section id="mutate-variables" class="level3">
<h3 class="anchored" data-anchor-id="mutate-variables"><code>mutate</code> variables</h3>
<p><code>mutate()</code> takes existing columns and creates a new column or overwrites the existing one. Here we will recode the variable <code>gdp_pc_ppp</code> to be in 1000 USD (we use <code>select()</code> at the start of the pipe so that it is easier to see the new and old variables at the same time).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ISO, gdp_pc_ppp) <span class="sc">%&gt;%</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp_pc_ppp_1000 =</span> gdp_pc_ppp <span class="sc">/</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 169 × 3
   ISO   gdp_pc_ppp gdp_pc_ppp_1000
   &lt;chr&gt;      &lt;dbl&gt;           &lt;dbl&gt;
 1 AFG        1944.           1.94 
 2 AGO        6140.           6.14 
 3 ALB       12678.          12.7  
 4 ARG       21212.          21.2  
 5 ARM       10051.          10.1  
 6 ATG       21491.          21.5  
 7 AUS       50122.          50.1  
 8 AUT       51637.          51.6  
 9 AZE       16319.          16.3  
10 BDI         788.           0.788
# ℹ 159 more rows</code></pre>
</div>
</div>
<p>Here is how we can remove remove variables with <code>mutate()</code> (although the same can be done with <code>select()</code> command):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ISO, gdp_pc_ppp) <span class="sc">%&gt;%</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp_pc_ppp =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 169 × 1
   ISO  
   &lt;chr&gt;
 1 AFG  
 2 AGO  
 3 ALB  
 4 ARG  
 5 ARM  
 6 ATG  
 7 AUS  
 8 AUT  
 9 AZE  
10 BDI  
# ℹ 159 more rows</code></pre>
</div>
</div>
<p>Let’s do something a little more complex and create a variable <code>gdp_outlier</code> that shows whether the observation for <code>gdp_pc_ppp</code> is an outlier:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>pei <span class="ot">&lt;-</span> pei <span class="sc">%&gt;%</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp_outlier_l =</span> gdp_pc_ppp <span class="sc">&lt;</span> <span class="fu">quantile</span>(gdp_pc_ppp, <span class="fl">0.25</span>, <span class="at">na.rm =</span> T) <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> <span class="fu">IQR</span>(gdp_pc_ppp, <span class="at">na.rm =</span> T),</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">gdp_outlier_u =</span> gdp_pc_ppp <span class="sc">&gt;</span> <span class="fu">quantile</span>(gdp_pc_ppp, <span class="fl">0.75</span>, <span class="at">na.rm =</span> T) <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> <span class="fu">IQR</span>(gdp_pc_ppp, <span class="at">na.rm =</span> T),</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">gdp_outlier =</span> gdp_outlier_u <span class="sc">|</span> gdp_outlier_u <span class="sc">==</span> <span class="cn">TRUE</span>,</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">gdp_outlier_l =</span> <span class="cn">NULL</span>, <span class="co"># remove the intermediate variables </span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">gdp_outlier_u =</span> <span class="cn">NULL</span> <span class="co"># remove the intermediate variables </span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And you have already seen this function when we renamed the regions above:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>pei <span class="ot">&lt;-</span> pei <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">region =</span> <span class="fu">case_when</span>(</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Africa"</span>,</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Americas"</span>,</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Asia"</span>,</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Europe"</span>,</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Oceania"</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="arrange-variables" class="level3">
<h3 class="anchored" data-anchor-id="arrange-variables"><code>arrange</code> variables</h3>
<p><code>arrange()</code> allows us to sort/reorder a tibble’s (dataframe) rows according to the values of a specific variable. Unlike <code>filter()</code> or <code>select()</code>, <code>arrange()</code> does not remove any rows or columns from the tibble. Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(PEIIndexp) <span class="sc">%&gt;%</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ISO, PEIIndexp) <span class="sc">%&gt;%</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   ISO   PEIIndexp
   &lt;chr&gt;     &lt;dbl&gt;
 1 COM        15.8
 2 GNQ        18.2
 3 CAF        18.4
 4 TJK        18.4
 5 SYR        19.4
 6 GAB        25.6
 7 HND        26.5
 8 TCD        28.6
 9 CMR        30.3
10 VEN        30.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(PEIIndexp)) <span class="sc">%&gt;%</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ISO, PEIIndexp) <span class="sc">%&gt;%</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   ISO   PEIIndexp
   &lt;chr&gt;     &lt;dbl&gt;
 1 DNK        90.3
 2 ISR        88.3
 3 CAN        87.4
 4 URY        85.7
 5 SWE        85.6
 6 DEU        84.2
 7 FIN        82.9
 8 ISL        82.0
 9 MAR        81.6
10 NLD        81.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>PEIIndexp) <span class="sc">%&gt;%</span> <span class="co"># trick for descending order </span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ISO, PEIIndexp) <span class="sc">%&gt;%</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   ISO   PEIIndexp
   &lt;chr&gt;     &lt;dbl&gt;
 1 DNK        90.3
 2 ISR        88.3
 3 CAN        87.4
 4 URY        85.7
 5 SWE        85.6
 6 DEU        84.2
 7 FIN        82.9
 8 ISL        82.0
 9 MAR        81.6
10 NLD        81.0</code></pre>
</div>
</div>
</section>
<section id="summarize-tibbles" class="level3">
<h3 class="anchored" data-anchor-id="summarize-tibbles"><code>summarize()</code> tibbles</h3>
<p>We often need to calculate <em>summary statistics</em>, things like the <em>mean</em> (also called the average) and the <em>median</em> (the middle value). Other examples of summary statistics include the <em>sum</em>, the <em>minimum</em>, the <em>maximum</em>, and the <em>standard deviation</em>.</p>
<p>The function <code>summarize()</code> allows us to calculate these statistics on individual columns from a tibble. Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> <span class="co"># take dataset</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_PEIindex =</span> <span class="fu">mean</span>(PEIIndexi, <span class="at">na.rm =</span> T),</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_PEIindex =</span> <span class="fu">sd</span>(PEIIndexi) </span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  mean_PEIindex sd_PEIindex
          &lt;dbl&gt;       &lt;dbl&gt;
1          55.0        15.0</code></pre>
</div>
</div>
<p>We can also let <code>R</code> perform operations within subgroups, rather than on the entire dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> <span class="co"># take dataset</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span> <span class="co"># group by region</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_PEIindex =</span> <span class="fu">mean</span>(PEIIndexi, <span class="at">na.rm =</span> T),</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_PEIindex =</span> <span class="fu">sd</span>(PEIIndexi, <span class="at">na.rm =</span> T) <span class="co"># why NA?</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  region   mean_PEIindex sd_PEIindex
  &lt;chr&gt;            &lt;dbl&gt;       &lt;dbl&gt;
1 Africa            45.4        11.7
2 Americas          57.8        12.3
3 Asia              52.1        13.3
4 Europe            63.5        15.7
5 Oceania           60.3        11.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> <span class="co"># take dataset</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span> <span class="co"># group by region</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  region   count
  &lt;chr&gt;    &lt;int&gt;
1 Africa      48
2 Americas    30
3 Asia        32
4 Europe      49
5 Oceania     10</code></pre>
</div>
</div>
</section>
</section>
<section id="special-cases-for-data-viz" class="level2">
<h2 class="anchored" data-anchor-id="special-cases-for-data-viz">Special Cases for Data Viz</h2>
<section id="adding-text-layer-with-geom_text" class="level3">
<h3 class="anchored" data-anchor-id="adding-text-layer-with-geom_text">Adding Text Layer with <code>geom_text</code></h3>
<p>Sometimes you may want to provide additional layer of information, such as, for instance, the country labels with text. <code>geom_text</code> allows us to do so for all observations at once (or a portion of them):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> PEIIndexi, <span class="co"># vertical axis </span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> gdp_pc_ppp, <span class="co"># horizontal axis </span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> region <span class="co"># add color by region</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># add points </span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span> <span class="co"># show 0 to 100 values for y</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> ISO), <span class="co"># add label aesthetic, from ISO code variable </span></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span> <span class="co"># hide letters in the legend </span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="co"># make colors colorblind-friendly</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values (`geom_text()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="adding-text-layer-to-outliers-in-boxplot-ggrepel-package" class="level3">
<h3 class="anchored" data-anchor-id="adding-text-layer-to-outliers-in-boxplot-ggrepel-package">Adding Text Layer to Outliers in Boxplot (<code>ggrepel</code> package)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> gdp_pc_ppp, <span class="at">y =</span> <span class="dv">1</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pei <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gdp_outlier),</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> ISO), <span class="at">nudge_y =</span> <span class="fl">0.05</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> gdp_pc_ppp, <span class="at">y =</span> <span class="dv">1</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pei <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gdp_outlier),</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> ISO)</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="adding-two-layers-with-different-scales-advanced" class="level3">
<h3 class="anchored" data-anchor-id="adding-two-layers-with-different-scales-advanced">Adding Two Layers with Different Scales (Advanced)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexi) <span class="co"># mapping for every geom below</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="co"># mapping only for histogram</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="dv">2</span>, <span class="co"># one bin = one unit of x variable </span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">boundary =</span> <span class="dv">0</span>, <span class="co"># there is a cutoff at 0 (for interpretation)</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="co"># transparency</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey20"</span> <span class="co"># color for borders</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Density"</span>, <span class="co"># name of the main axis </span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>( <span class="co"># add second axis </span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">trans =</span> <span class="sc">~</span> .x <span class="sc">*</span> (<span class="fu">nrow</span>(pei)), <span class="co"># the transformation to the main axis to be applied </span></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Count"</span>, <span class="co"># name of the second axis </span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r4da-week03_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">Resources</h2>
<ul>
<li>Chapter 4 <strong>Data transformation</strong> in <a href="https://r4ds.hadley.nz/data-transform" class="uri">https://r4ds.hadley.nz/data-transform</a></li>
<li>Section 2.5 <strong>Visualizing relationships</strong> in <a href="https://r4ds.hadley.nz/data-visualize#visualizing-relationships" class="uri">https://r4ds.hadley.nz/data-visualize#visualizing-relationships</a></li>
<li>Chapter 10 <strong>Layers</strong> in <a href="https://r4ds.hadley.nz/layers" class="uri">https://r4ds.hadley.nz/layers</a></li>
</ul>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb116" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Lab 3: Describing Relationships"</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Viktoriia Semenova"</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "September 20, 2023"</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: slides.scss </span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf:</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="co">    colorlinks: true</span></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a><span class="co">    geometry: </span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a><span class="co">      - top=30mm</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a><span class="co">      - left=30mm</span></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a><span class="an">highlight-style:</span><span class="co"> github</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a><span class="co"># packages needed</span></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a><span class="co"># put all packages we use in a vector</span></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a>p_needed <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyverse"</span>, <span class="co"># shortcut for ggplot2, dplyr, readr</span></span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"haven"</span>, <span class="co"># for reading dta files </span></span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"janitor"</span>, <span class="co"># clean_names for datasets </span></span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"modelsummary"</span>, <span class="co"># descriptive stats tables</span></span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"styler"</span> <span class="co"># to style the code</span></span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a><span class="co"># check if they are already installed, install if not installed</span></span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(</span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a>  p_needed[<span class="sc">!</span>(p_needed <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>()))],</span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a>  install.packages</span>
<span id="cb116-38"><a href="#cb116-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-39"><a href="#cb116-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-40"><a href="#cb116-40" aria-hidden="true" tabindex="-1"></a><span class="co"># load the packages</span></span>
<span id="cb116-41"><a href="#cb116-41" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(p_needed, library, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-42"><a href="#cb116-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-43"><a href="#cb116-43" aria-hidden="true" tabindex="-1"></a><span class="co"># same theme for all plots</span></span>
<span id="cb116-44"><a href="#cb116-44" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>())</span>
<span id="cb116-45"><a href="#cb116-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-46"><a href="#cb116-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-47"><a href="#cb116-47" aria-hidden="true" tabindex="-1"></a>\newpage</span>
<span id="cb116-48"><a href="#cb116-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-49"><a href="#cb116-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## Last Week</span></span>
<span id="cb116-50"><a href="#cb116-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-51"><a href="#cb116-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Introduction to <span class="in">`ggplot2`</span> package for data visualization </span>
<span id="cb116-52"><a href="#cb116-52" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Grammar of graphics </span>
<span id="cb116-53"><a href="#cb116-53" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Descriptive statistics </span>
<span id="cb116-54"><a href="#cb116-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-55"><a href="#cb116-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-56"><a href="#cb116-56" aria-hidden="true" tabindex="-1"></a><span class="fu">## Leftovers from Last Time </span></span>
<span id="cb116-57"><a href="#cb116-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-60"><a href="#cb116-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-61"><a href="#cb116-61" aria-hidden="true" tabindex="-1"></a>pei <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(<span class="st">"data/PEI country-level data (PEI_9.0).dta"</span>)</span>
<span id="cb116-62"><a href="#cb116-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-63"><a href="#cb116-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-64"><a href="#cb116-64" aria-hidden="true" tabindex="-1"></a><span class="fu">### Grammar of Graphics</span></span>
<span id="cb116-65"><a href="#cb116-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-66"><a href="#cb116-66" aria-hidden="true" tabindex="-1"></a>Recall that we have multiple layers in the plots:</span>
<span id="cb116-67"><a href="#cb116-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-68"><a href="#cb116-68" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*data*: the dataset containing the variables of interest.</span>
<span id="cb116-69"><a href="#cb116-69" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*aes*: aesthetic attributes of the geometric object. The most important are the names of the variables that should be on the x- and y-axes. Aesthetic attributes are mapped to variables in the dataset.</span>
<span id="cb116-70"><a href="#cb116-70" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*geom*: the geometric object to display, e.g., scatterplot, line, bar.</span>
<span id="cb116-71"><a href="#cb116-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-74"><a href="#cb116-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-75"><a href="#cb116-75" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: ggplot-anatomy</span></span>
<span id="cb116-76"><a href="#cb116-76" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb116-77"><a href="#cb116-77" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> [dataset],</span>
<span id="cb116-78"><a href="#cb116-78" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb116-79"><a href="#cb116-79" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> [x <span class="sc">-</span> variable],</span>
<span id="cb116-80"><a href="#cb116-80" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> [y <span class="sc">-</span> variable]</span>
<span id="cb116-81"><a href="#cb116-81" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb116-82"><a href="#cb116-82" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb116-83"><a href="#cb116-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_xxx</span>() <span class="sc">+</span></span>
<span id="cb116-84"><a href="#cb116-84" aria-hidden="true" tabindex="-1"></a>  other options</span>
<span id="cb116-85"><a href="#cb116-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-86"><a href="#cb116-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-87"><a href="#cb116-87" aria-hidden="true" tabindex="-1"></a><span class="fu">### Distributions of Continuous Variables</span></span>
<span id="cb116-88"><a href="#cb116-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-89"><a href="#cb116-89" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Boxplot, Violin Plot, and Observations Layers Combined </span></span>
<span id="cb116-90"><a href="#cb116-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-93"><a href="#cb116-93" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-94"><a href="#cb116-94" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-95"><a href="#cb116-95" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp, <span class="at">y =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb116-96"><a href="#cb116-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb116-97"><a href="#cb116-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb116-98"><a href="#cb116-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="co"># adds points with a little random noise (i.e. tiny shifts on both x and y coordinates)</span></span>
<span id="cb116-99"><a href="#cb116-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-100"><a href="#cb116-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-101"><a href="#cb116-101" aria-hidden="true" tabindex="-1"></a><span class="fu">### Distributions of Discrete and Categorial Variables</span></span>
<span id="cb116-102"><a href="#cb116-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-103"><a href="#cb116-103" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Barplot</span></span>
<span id="cb116-104"><a href="#cb116-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-105"><a href="#cb116-105" aria-hidden="true" tabindex="-1"></a><span class="in">`geom_bar()`</span> visualizes the distribution of a categorical or discrete variable. This is a simpler task than creating a histogram, as we are simply counting different categories within a categorical variable, also known as the levels of the categorical variable. Often the best way to visualize these different counts, also known as frequencies, is with a barplot.</span>
<span id="cb116-106"><a href="#cb116-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-107"><a href="#cb116-107" aria-hidden="true" tabindex="-1"></a>Let's recode the variable <span class="in">`region`</span> to be more readable and visualize the counts:</span>
<span id="cb116-108"><a href="#cb116-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-111"><a href="#cb116-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-112"><a href="#cb116-112" aria-hidden="true" tabindex="-1"></a>pei <span class="ot">&lt;-</span> pei <span class="sc">%&gt;%</span></span>
<span id="cb116-113"><a href="#cb116-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb116-114"><a href="#cb116-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">region =</span> <span class="fu">case_when</span>(</span>
<span id="cb116-115"><a href="#cb116-115" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Africa"</span>,</span>
<span id="cb116-116"><a href="#cb116-116" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Americas"</span>,</span>
<span id="cb116-117"><a href="#cb116-117" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Asia"</span>,</span>
<span id="cb116-118"><a href="#cb116-118" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Europe"</span>,</span>
<span id="cb116-119"><a href="#cb116-119" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Oceania"</span></span>
<span id="cb116-120"><a href="#cb116-120" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb116-121"><a href="#cb116-121" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb116-122"><a href="#cb116-122" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(pei, region)</span>
<span id="cb116-123"><a href="#cb116-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-124"><a href="#cb116-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-125"><a href="#cb116-125" aria-hidden="true" tabindex="-1"></a>In bar plots of categorical variables with non-ordered levels, it's often preferable to reorder the bars based on their frequencies. Doing so requires transforming the variable to a factor (how <span class="in">`R`</span> handles categorical data) and then reordering the levels of that factor. Below you can find both versions of bar plots:</span>
<span id="cb116-126"><a href="#cb116-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-129"><a href="#cb116-129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-130"><a href="#cb116-130" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb116-131"><a href="#cb116-131" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-132"><a href="#cb116-132" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> region)) <span class="sc">+</span></span>
<span id="cb116-133"><a href="#cb116-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() </span>
<span id="cb116-134"><a href="#cb116-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-135"><a href="#cb116-135" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-136"><a href="#cb116-136" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> forcats<span class="sc">::</span><span class="fu">fct_infreq</span>(region))) <span class="sc">+</span></span>
<span id="cb116-137"><a href="#cb116-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() </span>
<span id="cb116-138"><a href="#cb116-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-139"><a href="#cb116-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-140"><a href="#cb116-140" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Category Ordering</span></span>
<span id="cb116-141"><a href="#cb116-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-142"><a href="#cb116-142" aria-hidden="true" tabindex="-1"></a>We can also choose to show the bars horizontally rather than vertically by setting a different axis for <span class="in">`region`</span>:</span>
<span id="cb116-143"><a href="#cb116-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-146"><a href="#cb116-146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-147"><a href="#cb116-147" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb116-148"><a href="#cb116-148" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-149"><a href="#cb116-149" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> region <span class="sc">%&gt;%</span> <span class="fu">fct_infreq</span>())) <span class="sc">+</span> </span>
<span id="cb116-150"><a href="#cb116-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span>
<span id="cb116-151"><a href="#cb116-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-152"><a href="#cb116-152" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-153"><a href="#cb116-153" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> region <span class="sc">%&gt;%</span> </span>
<span id="cb116-154"><a href="#cb116-154" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">fct_infreq</span>() <span class="sc">%&gt;%</span> <span class="co"># order in frequency</span></span>
<span id="cb116-155"><a href="#cb116-155" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">fct_rev</span>() <span class="co"># reverse the order </span></span>
<span id="cb116-156"><a href="#cb116-156" aria-hidden="true" tabindex="-1"></a>                     )) <span class="sc">+</span> </span>
<span id="cb116-157"><a href="#cb116-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() </span>
<span id="cb116-158"><a href="#cb116-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-159"><a href="#cb116-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-160"><a href="#cb116-160" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Proportions vs. Counts</span></span>
<span id="cb116-161"><a href="#cb116-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-162"><a href="#cb116-162" aria-hidden="true" tabindex="-1"></a>There is also a way to show proportions, rather than counts, on the vertical axis... (we can always explicitly calculate these quantities and plot them of course). By default, <span class="in">`ggplot`</span> creates one group per each bar, so all the proportions are set to 1 (on the left). </span>
<span id="cb116-163"><a href="#cb116-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-166"><a href="#cb116-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-167"><a href="#cb116-167" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb116-168"><a href="#cb116-168" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-169"><a href="#cb116-169" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> region,</span>
<span id="cb116-170"><a href="#cb116-170" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> ..prop..)) <span class="sc">+</span></span>
<span id="cb116-171"><a href="#cb116-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb116-172"><a href="#cb116-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())</span>
<span id="cb116-173"><a href="#cb116-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-174"><a href="#cb116-174" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-175"><a href="#cb116-175" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> region,</span>
<span id="cb116-176"><a href="#cb116-176" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> ..prop..,</span>
<span id="cb116-177"><a href="#cb116-177" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb116-178"><a href="#cb116-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb116-179"><a href="#cb116-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())</span>
<span id="cb116-180"><a href="#cb116-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-181"><a href="#cb116-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-182"><a href="#cb116-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-183"><a href="#cb116-183" aria-hidden="true" tabindex="-1"></a><span class="fu">### Important Nuances</span></span>
<span id="cb116-184"><a href="#cb116-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-185"><a href="#cb116-185" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Order of Layers Matters</span></span>
<span id="cb116-186"><a href="#cb116-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-189"><a href="#cb116-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-190"><a href="#cb116-190" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb116-191"><a href="#cb116-191" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-192"><a href="#cb116-192" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp, <span class="at">y =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb116-193"><a href="#cb116-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb116-194"><a href="#cb116-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span>
<span id="cb116-195"><a href="#cb116-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-196"><a href="#cb116-196" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-197"><a href="#cb116-197" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp, <span class="at">y =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb116-198"><a href="#cb116-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb116-199"><a href="#cb116-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() </span>
<span id="cb116-200"><a href="#cb116-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-201"><a href="#cb116-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-202"><a href="#cb116-202" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Global vs. Local Mapping</span></span>
<span id="cb116-203"><a href="#cb116-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-204"><a href="#cb116-204" aria-hidden="true" tabindex="-1"></a>The plots below illustrate the differences between setting mappings globally, i.e. in <span class="in">`ggplot(aes(...))`</span> layer and locally, i.e. in <span class="in">`geom_`</span> layers. </span>
<span id="cb116-205"><a href="#cb116-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-208"><a href="#cb116-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-209"><a href="#cb116-209" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb116-210"><a href="#cb116-210" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-211"><a href="#cb116-211" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp, <span class="at">y =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb116-212"><a href="#cb116-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb116-213"><a href="#cb116-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span>
<span id="cb116-214"><a href="#cb116-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-215"><a href="#cb116-215" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei, <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp)) <span class="sc">+</span></span>
<span id="cb116-216"><a href="#cb116-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb116-217"><a href="#cb116-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">1</span>))</span>
<span id="cb116-218"><a href="#cb116-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-219"><a href="#cb116-219" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei)  <span class="sc">+</span></span>
<span id="cb116-220"><a href="#cb116-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp)) <span class="sc">+</span></span>
<span id="cb116-221"><a href="#cb116-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp, <span class="at">y =</span> <span class="dv">1</span>))</span>
<span id="cb116-222"><a href="#cb116-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-223"><a href="#cb116-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-224"><a href="#cb116-224" aria-hidden="true" tabindex="-1"></a>While it is often more efficient to set the aesthetics globally, sometimes you may want to show related but different quantities on the plot, so setting aesthetics locally becomes necessary.</span>
<span id="cb116-225"><a href="#cb116-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-226"><a href="#cb116-226" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Setting vs. Mapping</span></span>
<span id="cb116-227"><a href="#cb116-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-228"><a href="#cb116-228" aria-hidden="true" tabindex="-1"></a>So far, we have primarily been using color with no substantive purpose: we were *setting* it to a particular value. Yet we can use color in mappings, too. - We *map* variables to aesthetics (e.g. color/fill or shape) if we want the visual attribute represented by that aesthetic to vary based on the values of that *variable*. This goes inside `aes()`. - Otherwise, we *set* the value of an aesthetic. The choice of this value is on us. This goes into <span class="in">`geom_`</span>.</span>
<span id="cb116-229"><a href="#cb116-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-232"><a href="#cb116-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-233"><a href="#cb116-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 3</span></span>
<span id="cb116-234"><a href="#cb116-234" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-235"><a href="#cb116-235" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp)) <span class="sc">+</span></span>
<span id="cb116-236"><a href="#cb116-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(region))) <span class="sc">+</span></span>
<span id="cb116-237"><a href="#cb116-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span>
<span id="cb116-238"><a href="#cb116-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-239"><a href="#cb116-239" aria-hidden="true" tabindex="-1"></a><span class="co"># setting can overwrite the mapping </span></span>
<span id="cb116-240"><a href="#cb116-240" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-241"><a href="#cb116-241" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp)) <span class="sc">+</span></span>
<span id="cb116-242"><a href="#cb116-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(region)), <span class="at">color =</span> <span class="st">"red"</span>) </span>
<span id="cb116-243"><a href="#cb116-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-244"><a href="#cb116-244" aria-hidden="true" tabindex="-1"></a><span class="co"># mixing up setting and mapping </span></span>
<span id="cb116-245"><a href="#cb116-245" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-246"><a href="#cb116-246" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp)) <span class="sc">+</span></span>
<span id="cb116-247"><a href="#cb116-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"red"</span>))</span>
<span id="cb116-248"><a href="#cb116-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-249"><a href="#cb116-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-250"><a href="#cb116-250" aria-hidden="true" tabindex="-1"></a><span class="fu">### Saving Plot Objects</span></span>
<span id="cb116-251"><a href="#cb116-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-252"><a href="#cb116-252" aria-hidden="true" tabindex="-1"></a>Plots are <span class="in">`R`</span> objects, just like vectors or data frames. We can create them, print them and save them. Up until now, we have just made them in an <span class="in">`R`</span> code chunk. That is what most often you will be doing when working with Quarto. Sometimes, however, it is handy to work with a plot object.</span>
<span id="cb116-253"><a href="#cb116-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-256"><a href="#cb116-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-257"><a href="#cb116-257" aria-hidden="true" tabindex="-1"></a>my_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-258"><a href="#cb116-258" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexp)) <span class="sc">+</span></span>
<span id="cb116-259"><a href="#cb116-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(region))) <span class="sc">+</span></span>
<span id="cb116-260"><a href="#cb116-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span>
<span id="cb116-261"><a href="#cb116-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-262"><a href="#cb116-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-263"><a href="#cb116-263" aria-hidden="true" tabindex="-1"></a>This code above does not print anything out. In order to make this plot appear, we need to print it out explicitly. Recall that typing the name of an object is the same thing as using <span class="in">`print()`</span>. Now that we have this object, we can display it whenever we want.</span>
<span id="cb116-264"><a href="#cb116-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-267"><a href="#cb116-267" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-268"><a href="#cb116-268" aria-hidden="true" tabindex="-1"></a>my_plot</span>
<span id="cb116-269"><a href="#cb116-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-270"><a href="#cb116-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-271"><a href="#cb116-271" aria-hidden="true" tabindex="-1"></a>But, sometimes, we want a permanent copy of the plot outside of <span class="in">`R`</span>, saved to our computer. That is the purpose of <span class="in">`ggsave()`</span>:</span>
<span id="cb116-272"><a href="#cb116-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-275"><a href="#cb116-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-276"><a href="#cb116-276" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb116-277"><a href="#cb116-277" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"figures/pei_plot.png"</span>,</span>
<span id="cb116-278"><a href="#cb116-278" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> my_plot</span>
<span id="cb116-279"><a href="#cb116-279" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-280"><a href="#cb116-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-281"><a href="#cb116-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-282"><a href="#cb116-282" aria-hidden="true" tabindex="-1"></a>We can then include it into <span class="in">`qmd`</span> files as an external image like this:</span>
<span id="cb116-283"><a href="#cb116-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-286"><a href="#cb116-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-287"><a href="#cb116-287" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="at">path =</span> <span class="st">"figures/pei_plot.png"</span>)</span>
<span id="cb116-288"><a href="#cb116-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-289"><a href="#cb116-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-290"><a href="#cb116-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-291"><a href="#cb116-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-292"><a href="#cb116-292" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plotting Two or More Variables </span></span>
<span id="cb116-293"><a href="#cb116-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-294"><a href="#cb116-294" aria-hidden="true" tabindex="-1"></a><span class="fu">### Two Variables: Continuous </span></span>
<span id="cb116-295"><a href="#cb116-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-296"><a href="#cb116-296" aria-hidden="true" tabindex="-1"></a>*Scatterplots*, also called bivariate plots, allow you to visualize the relationship between two numerical variables. The most appropriate <span class="in">`geom`</span> for that is usually <span class="in">`geom_point()`</span>:</span>
<span id="cb116-297"><a href="#cb116-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-300"><a href="#cb116-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-301"><a href="#cb116-301" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-302"><a href="#cb116-302" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> PEIIndexi,</span>
<span id="cb116-303"><a href="#cb116-303" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> gdp_pc_ppp)) <span class="sc">+</span></span>
<span id="cb116-304"><a href="#cb116-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="co"># plots the observations</span></span>
<span id="cb116-305"><a href="#cb116-305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-306"><a href="#cb116-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-307"><a href="#cb116-307" aria-hidden="true" tabindex="-1"></a>Let's break down this code, piece-by-piece.</span>
<span id="cb116-308"><a href="#cb116-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-309"><a href="#cb116-309" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The data argument is set to trains via <span class="in">`data = pei`</span>.</span>
<span id="cb116-310"><a href="#cb116-310" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The aesthetic mapping is set via <span class="in">`mapping = aes(x = PEIIndexi, y = gdp_pc_ppp)`</span>. Here, we map <span class="in">`PEIIndexi`</span> to the x axis and <span class="in">`gdp_pc_ppp`</span> to the <span class="in">`y`</span> axis.</span>
<span id="cb116-311"><a href="#cb116-311" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The geometric object is specified using <span class="in">`geom_point()`</span>, telling <span class="in">`R`</span> we want a scatterplot. We added a layer using the <span class="in">`+`</span> sign.</span>
<span id="cb116-312"><a href="#cb116-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-313"><a href="#cb116-313" aria-hidden="true" tabindex="-1"></a><span class="in">`geom_point`</span> works fine on its own if we don't have _too_ many observations and when there are many distinct values in the variables we plot.</span>
<span id="cb116-314"><a href="#cb116-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-315"><a href="#cb116-315" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `geom_smooth`</span></span>
<span id="cb116-316"><a href="#cb116-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-319"><a href="#cb116-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-320"><a href="#cb116-320" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb116-321"><a href="#cb116-321" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-322"><a href="#cb116-322" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> PEIIndexi,</span>
<span id="cb116-323"><a href="#cb116-323" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> gdp_pc_ppp)) <span class="sc">+</span></span>
<span id="cb116-324"><a href="#cb116-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># plots the observations </span></span>
<span id="cb116-325"><a href="#cb116-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'loess'</span>, <span class="at">formula =</span> <span class="st">'y ~ x'</span>,  <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb116-326"><a href="#cb116-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-327"><a href="#cb116-327" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-328"><a href="#cb116-328" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> PEIIndexi,</span>
<span id="cb116-329"><a href="#cb116-329" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> gdp_pc_ppp)) <span class="sc">+</span></span>
<span id="cb116-330"><a href="#cb116-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># plots the observations </span></span>
<span id="cb116-331"><a href="#cb116-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">formula =</span> <span class="st">'y ~ x'</span>,  <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb116-332"><a href="#cb116-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-333"><a href="#cb116-333" aria-hidden="true" tabindex="-1"></a>When needed, transformations to variables can applied directly in the mapping (these changes will not be saved in the dataset). </span>
<span id="cb116-334"><a href="#cb116-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-337"><a href="#cb116-337" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-338"><a href="#cb116-338" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-339"><a href="#cb116-339" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> PEIIndexi,</span>
<span id="cb116-340"><a href="#cb116-340" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> <span class="fu">log</span>(gdp_pc_ppp))) <span class="sc">+</span></span>
<span id="cb116-341"><a href="#cb116-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># plots the observations </span></span>
<span id="cb116-342"><a href="#cb116-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">formula =</span> <span class="st">'y ~ x'</span>,  <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb116-343"><a href="#cb116-343" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-344"><a href="#cb116-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-345"><a href="#cb116-345" aria-hidden="true" tabindex="-1"></a><span class="fu">### Three Variables: Two Continuous + Categorical </span></span>
<span id="cb116-346"><a href="#cb116-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-349"><a href="#cb116-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-350"><a href="#cb116-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb116-351"><a href="#cb116-351" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb116-352"><a href="#cb116-352" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb116-353"><a href="#cb116-353" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb116-354"><a href="#cb116-354" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> PEIIndexi,</span>
<span id="cb116-355"><a href="#cb116-355" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> gdp_pc_ppp,</span>
<span id="cb116-356"><a href="#cb116-356" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> region <span class="co"># add color by region </span></span>
<span id="cb116-357"><a href="#cb116-357" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-358"><a href="#cb116-358" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb116-359"><a href="#cb116-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-360"><a href="#cb116-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>()) </span>
<span id="cb116-361"><a href="#cb116-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-362"><a href="#cb116-362" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb116-363"><a href="#cb116-363" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb116-364"><a href="#cb116-364" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb116-365"><a href="#cb116-365" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> PEIIndexi,</span>
<span id="cb116-366"><a href="#cb116-366" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> gdp_pc_ppp,</span>
<span id="cb116-367"><a href="#cb116-367" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> region  <span class="co"># add color by region </span></span>
<span id="cb116-368"><a href="#cb116-368" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-369"><a href="#cb116-369" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb116-370"><a href="#cb116-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-371"><a href="#cb116-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb116-372"><a href="#cb116-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="co"># make colors colorblind-friendly</span></span>
<span id="cb116-373"><a href="#cb116-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-374"><a href="#cb116-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-375"><a href="#cb116-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-376"><a href="#cb116-376" aria-hidden="true" tabindex="-1"></a><span class="fu">### Two Variables: Continous and Categorical </span></span>
<span id="cb116-377"><a href="#cb116-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-378"><a href="#cb116-378" aria-hidden="true" tabindex="-1"></a>Let's consider a few options for plotting such combinations of variables: </span>
<span id="cb116-379"><a href="#cb116-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-382"><a href="#cb116-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-383"><a href="#cb116-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 3</span></span>
<span id="cb116-384"><a href="#cb116-384" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-385"><a href="#cb116-385" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> PEIIndexi,</span>
<span id="cb116-386"><a href="#cb116-386" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> region)) <span class="sc">+</span></span>
<span id="cb116-387"><a href="#cb116-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb116-388"><a href="#cb116-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-389"><a href="#cb116-389" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-390"><a href="#cb116-390" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> PEIIndexi,</span>
<span id="cb116-391"><a href="#cb116-391" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> region)) <span class="sc">+</span></span>
<span id="cb116-392"><a href="#cb116-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>) </span>
<span id="cb116-393"><a href="#cb116-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-394"><a href="#cb116-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-395"><a href="#cb116-395" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-396"><a href="#cb116-396" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> PEIIndexi,</span>
<span id="cb116-397"><a href="#cb116-397" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> region)) <span class="sc">+</span></span>
<span id="cb116-398"><a href="#cb116-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() </span>
<span id="cb116-399"><a href="#cb116-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-400"><a href="#cb116-400" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-401"><a href="#cb116-401" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexi,</span>
<span id="cb116-402"><a href="#cb116-402" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> region)) <span class="sc">+</span></span>
<span id="cb116-403"><a href="#cb116-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() </span>
<span id="cb116-404"><a href="#cb116-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-405"><a href="#cb116-405" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-406"><a href="#cb116-406" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexi,</span>
<span id="cb116-407"><a href="#cb116-407" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> region,</span>
<span id="cb116-408"><a href="#cb116-408" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb116-409"><a href="#cb116-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) </span>
<span id="cb116-410"><a href="#cb116-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-411"><a href="#cb116-411" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pei,</span>
<span id="cb116-412"><a href="#cb116-412" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexi)) <span class="sc">+</span></span>
<span id="cb116-413"><a href="#cb116-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb116-414"><a href="#cb116-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(region))</span>
<span id="cb116-415"><a href="#cb116-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-416"><a href="#cb116-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-417"><a href="#cb116-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-418"><a href="#cb116-418" aria-hidden="true" tabindex="-1"></a><span class="fu">### Two Categorical Variables </span></span>
<span id="cb116-419"><a href="#cb116-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-422"><a href="#cb116-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-423"><a href="#cb116-423" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb116-424"><a href="#cb116-424" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb116-425"><a href="#cb116-425" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb116-426"><a href="#cb116-426" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> oecd,</span>
<span id="cb116-427"><a href="#cb116-427" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> region</span>
<span id="cb116-428"><a href="#cb116-428" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-429"><a href="#cb116-429" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb116-430"><a href="#cb116-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>)</span>
<span id="cb116-431"><a href="#cb116-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-432"><a href="#cb116-432" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb116-433"><a href="#cb116-433" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb116-434"><a href="#cb116-434" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb116-435"><a href="#cb116-435" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">factor</span>(oecd),</span>
<span id="cb116-436"><a href="#cb116-436" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> region</span>
<span id="cb116-437"><a href="#cb116-437" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-438"><a href="#cb116-438" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb116-439"><a href="#cb116-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>)</span>
<span id="cb116-440"><a href="#cb116-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-441"><a href="#cb116-441" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb116-442"><a href="#cb116-442" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb116-443"><a href="#cb116-443" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb116-444"><a href="#cb116-444" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">factor</span>(oecd),</span>
<span id="cb116-445"><a href="#cb116-445" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> region</span>
<span id="cb116-446"><a href="#cb116-446" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-447"><a href="#cb116-447" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb116-448"><a href="#cb116-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_count</span>()</span>
<span id="cb116-449"><a href="#cb116-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-450"><a href="#cb116-450" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pei, <span class="fu">aes</span>(</span>
<span id="cb116-451"><a href="#cb116-451" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> region,</span>
<span id="cb116-452"><a href="#cb116-452" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="fu">factor</span>(oecd)</span>
<span id="cb116-453"><a href="#cb116-453" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb116-454"><a href="#cb116-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span>
<span id="cb116-455"><a href="#cb116-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-456"><a href="#cb116-456" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pei, <span class="fu">aes</span>(</span>
<span id="cb116-457"><a href="#cb116-457" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> region,</span>
<span id="cb116-458"><a href="#cb116-458" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="fu">factor</span>(oecd)</span>
<span id="cb116-459"><a href="#cb116-459" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb116-460"><a href="#cb116-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>)</span>
<span id="cb116-461"><a href="#cb116-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-462"><a href="#cb116-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-463"><a href="#cb116-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-464"><a href="#cb116-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-465"><a href="#cb116-465" aria-hidden="true" tabindex="-1"></a><span class="fu">## Basic Data Wrangling Functions </span></span>
<span id="cb116-466"><a href="#cb116-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-467"><a href="#cb116-467" aria-hidden="true" tabindex="-1"></a>We can't use all the beautiful plots until we have "wrangled" the data into a convenient shape and have all the variables we need for plotting. You have seen some of these functions already, but let's now look at them a bit more systematically. Key wrangling functions include:</span>
<span id="cb116-468"><a href="#cb116-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-469"><a href="#cb116-469" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`filter()`</span>: to pick out the *rows* we want to keep from a tibble.</span>
<span id="cb116-470"><a href="#cb116-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-471"><a href="#cb116-471" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`select()`</span>: to pick out the *columns* we want to keep from a tibble.</span>
<span id="cb116-472"><a href="#cb116-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-473"><a href="#cb116-473" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`arrange()`</span>: to sort the rows in a tibble, in either ascending or descending order.</span>
<span id="cb116-474"><a href="#cb116-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-475"><a href="#cb116-475" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`mutate()`</span>: to create new columns.</span>
<span id="cb116-476"><a href="#cb116-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-477"><a href="#cb116-477" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`summarize()`</span>: to create a new tibble comprised of summary statistics for one (or more) rows, depending on the use of the <span class="in">`.by`</span> argument.</span>
<span id="cb116-478"><a href="#cb116-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-479"><a href="#cb116-479" aria-hidden="true" tabindex="-1"></a><span class="fu">### The pipe operator: `%&gt;%` (again)</span></span>
<span id="cb116-480"><a href="#cb116-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-481"><a href="#cb116-481" aria-hidden="true" tabindex="-1"></a>The pipe operator (<span class="in">`%&gt;%`</span>) allows us to combine multiple operations in <span class="in">`R`</span> into a single sequential *chain* of actions. Much like how the <span class="in">`+`</span> sign has to come at the end of the line when constructing plots --- because we are building the plot layer-by-layer --- the pipe operator <span class="in">`%&gt;%`</span> has to come at the end of the line because we are building a data wrangling pipeline step-by-step. If you do not include the pipe operator, R assumes the next line of code is unrelated to the layers you built and you will get an error.</span>
<span id="cb116-482"><a href="#cb116-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-483"><a href="#cb116-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-484"><a href="#cb116-484" aria-hidden="true" tabindex="-1"></a><span class="fu">### `filter` rows  </span></span>
<span id="cb116-485"><a href="#cb116-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-486"><a href="#cb116-486" aria-hidden="true" tabindex="-1"></a>The <span class="in">`filter()`</span> function works much like the "Filter" option in Microsoft Excel. It allows you to specify criteria about the values of a variable in your dataset and then selects only the rows that match that criteria.</span>
<span id="cb116-487"><a href="#cb116-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-490"><a href="#cb116-490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-491"><a href="#cb116-491" aria-hidden="true" tabindex="-1"></a><span class="co"># only Europe (show, not store in the environment)</span></span>
<span id="cb116-492"><a href="#cb116-492" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb116-493"><a href="#cb116-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"Europe"</span>)</span>
<span id="cb116-494"><a href="#cb116-494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-495"><a href="#cb116-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-496"><a href="#cb116-496" aria-hidden="true" tabindex="-1"></a>Here are a few more operators that we can use here:</span>
<span id="cb116-497"><a href="#cb116-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-498"><a href="#cb116-498" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`&gt;`</span> for "greater than"</span>
<span id="cb116-499"><a href="#cb116-499" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`&lt;`</span> for "less than"</span>
<span id="cb116-500"><a href="#cb116-500" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`&gt;=`</span> for "greater than or equal to"</span>
<span id="cb116-501"><a href="#cb116-501" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`&lt;=`</span> for "less than or equal to"</span>
<span id="cb116-502"><a href="#cb116-502" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`!=`</span> for "not equal to"</span>
<span id="cb116-503"><a href="#cb116-503" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`%in%`</span> for "inside"</span>
<span id="cb116-504"><a href="#cb116-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-507"><a href="#cb116-507" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-508"><a href="#cb116-508" aria-hidden="true" tabindex="-1"></a><span class="co"># everything but Europe (show, not store in the environment)</span></span>
<span id="cb116-509"><a href="#cb116-509" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb116-510"><a href="#cb116-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">!=</span> <span class="st">"Europe"</span>)</span>
<span id="cb116-511"><a href="#cb116-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-512"><a href="#cb116-512" aria-hidden="true" tabindex="-1"></a><span class="co"># every row where PEI index is ABOVE 50</span></span>
<span id="cb116-513"><a href="#cb116-513" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb116-514"><a href="#cb116-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PEIIndexi <span class="sc">&gt;</span> <span class="dv">55</span>)</span>
<span id="cb116-515"><a href="#cb116-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-516"><a href="#cb116-516" aria-hidden="true" tabindex="-1"></a><span class="co"># every row where PEI type is ABOVE 3</span></span>
<span id="cb116-517"><a href="#cb116-517" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb116-518"><a href="#cb116-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PEItype <span class="sc">&gt;</span> <span class="dv">3</span>)</span>
<span id="cb116-519"><a href="#cb116-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-520"><a href="#cb116-520" aria-hidden="true" tabindex="-1"></a><span class="co"># every row where PEI index is EQUAL TO or ABOVE 50</span></span>
<span id="cb116-521"><a href="#cb116-521" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb116-522"><a href="#cb116-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PEIIndexi <span class="sc">&gt;=</span> <span class="dv">55</span>)</span>
<span id="cb116-523"><a href="#cb116-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-524"><a href="#cb116-524" aria-hidden="true" tabindex="-1"></a><span class="co"># every row where PEI type is EQUAL TO or ABOVE 3</span></span>
<span id="cb116-525"><a href="#cb116-525" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb116-526"><a href="#cb116-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PEItype <span class="sc">&gt;=</span> <span class="dv">3</span>)</span>
<span id="cb116-527"><a href="#cb116-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-528"><a href="#cb116-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-529"><a href="#cb116-529" aria-hidden="true" tabindex="-1"></a>Furthermore, you can combine multiple criteria using operators that make comparisons:</span>
<span id="cb116-530"><a href="#cb116-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-531"><a href="#cb116-531" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`|`</span> for "or"</span>
<span id="cb116-532"><a href="#cb116-532" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`&amp;`</span> for "and" (or just <span class="in">`,`</span>)</span>
<span id="cb116-533"><a href="#cb116-533" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`!`</span> for "not"</span>
<span id="cb116-534"><a href="#cb116-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-537"><a href="#cb116-537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-538"><a href="#cb116-538" aria-hidden="true" tabindex="-1"></a><span class="co"># every row where PEI type is EQUAL TO or ABOVE 3</span></span>
<span id="cb116-539"><a href="#cb116-539" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb116-540"><a href="#cb116-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb116-541"><a href="#cb116-541" aria-hidden="true" tabindex="-1"></a>    PEItype <span class="sc">&lt;=</span> <span class="dv">3</span>,</span>
<span id="cb116-542"><a href="#cb116-542" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"Europe"</span></span>
<span id="cb116-543"><a href="#cb116-543" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-544"><a href="#cb116-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-545"><a href="#cb116-545" aria-hidden="true" tabindex="-1"></a><span class="co"># select every observation that is in Europe or Asia, has PEI index above 50, and GDP above average </span></span>
<span id="cb116-546"><a href="#cb116-546" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb116-547"><a href="#cb116-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb116-548"><a href="#cb116-548" aria-hidden="true" tabindex="-1"></a>    PEIIndexi <span class="sc">&gt;</span> <span class="dv">50</span>,</span>
<span id="cb116-549"><a href="#cb116-549" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"Europe"</span> <span class="sc">|</span> region <span class="sc">==</span> <span class="st">"Asia"</span>,</span>
<span id="cb116-550"><a href="#cb116-550" aria-hidden="true" tabindex="-1"></a>    gdp_pc_ppp <span class="sc">&gt;</span> <span class="fu">mean</span>(gdp_pc_ppp, <span class="at">na.rm =</span> T)</span>
<span id="cb116-551"><a href="#cb116-551" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-552"><a href="#cb116-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-553"><a href="#cb116-553" aria-hidden="true" tabindex="-1"></a><span class="co"># same result but %in% instead or OR (|) for regions  </span></span>
<span id="cb116-554"><a href="#cb116-554" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb116-555"><a href="#cb116-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb116-556"><a href="#cb116-556" aria-hidden="true" tabindex="-1"></a>    PEIIndexi <span class="sc">&gt;</span> <span class="dv">50</span>,</span>
<span id="cb116-557"><a href="#cb116-557" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Europe"</span>, <span class="st">"Asia"</span>),</span>
<span id="cb116-558"><a href="#cb116-558" aria-hidden="true" tabindex="-1"></a>    gdp_pc_ppp <span class="sc">&gt;</span> <span class="fu">mean</span>(gdp_pc_ppp, <span class="at">na.rm =</span> T)</span>
<span id="cb116-559"><a href="#cb116-559" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-560"><a href="#cb116-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-561"><a href="#cb116-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-562"><a href="#cb116-562" aria-hidden="true" tabindex="-1"></a><span class="co"># select every observation that is in not in Europe nor Asia, has PEI index above or equal to 40, and GDP above median </span></span>
<span id="cb116-563"><a href="#cb116-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-564"><a href="#cb116-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-565"><a href="#cb116-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-566"><a href="#cb116-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-567"><a href="#cb116-567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-568"><a href="#cb116-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-569"><a href="#cb116-569" aria-hidden="true" tabindex="-1"></a><span class="fu">### `select` variables</span></span>
<span id="cb116-570"><a href="#cb116-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-571"><a href="#cb116-571" aria-hidden="true" tabindex="-1"></a>This is used for subsetting variables (columns, not rows), deleting columns, and re-arranging columns. </span>
<span id="cb116-572"><a href="#cb116-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-575"><a href="#cb116-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-576"><a href="#cb116-576" aria-hidden="true" tabindex="-1"></a><span class="co"># select PEIIndexi and ISO variables only </span></span>
<span id="cb116-577"><a href="#cb116-577" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb116-578"><a href="#cb116-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(PEIIndexi, ISO)</span>
<span id="cb116-579"><a href="#cb116-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-580"><a href="#cb116-580" aria-hidden="true" tabindex="-1"></a><span class="co"># remove ISO and y2012 variables </span></span>
<span id="cb116-581"><a href="#cb116-581" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb116-582"><a href="#cb116-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>ISO, <span class="sc">-</span>y2012)</span>
<span id="cb116-583"><a href="#cb116-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-584"><a href="#cb116-584" aria-hidden="true" tabindex="-1"></a><span class="co"># change the order of columns in dataset </span></span>
<span id="cb116-585"><a href="#cb116-585" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb116-586"><a href="#cb116-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(PEIIndexi)</span>
<span id="cb116-587"><a href="#cb116-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-588"><a href="#cb116-588" aria-hidden="true" tabindex="-1"></a><span class="co"># change the order of columns in dataset </span></span>
<span id="cb116-589"><a href="#cb116-589" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb116-590"><a href="#cb116-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ISO, PEIIndexi, <span class="fu">everything</span>())</span>
<span id="cb116-591"><a href="#cb116-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-592"><a href="#cb116-592" aria-hidden="true" tabindex="-1"></a><span class="co"># only select variables starting with "y"</span></span>
<span id="cb116-593"><a href="#cb116-593" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb116-594"><a href="#cb116-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"y"</span>))</span>
<span id="cb116-595"><a href="#cb116-595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-596"><a href="#cb116-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-597"><a href="#cb116-597" aria-hidden="true" tabindex="-1"></a><span class="fu">### `mutate` variables</span></span>
<span id="cb116-598"><a href="#cb116-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-599"><a href="#cb116-599" aria-hidden="true" tabindex="-1"></a><span class="in">`mutate()`</span> takes existing columns and creates a new column or overwrites the existing one. Here we will recode the variable <span class="in">`gdp_pc_ppp`</span> to be in 1000 USD (we use <span class="in">`select()`</span> at the start of the pipe so that it is easier to see the new and old variables at the same time).</span>
<span id="cb116-600"><a href="#cb116-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-601"><a href="#cb116-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-604"><a href="#cb116-604" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-605"><a href="#cb116-605" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb116-606"><a href="#cb116-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ISO, gdp_pc_ppp) <span class="sc">%&gt;%</span> </span>
<span id="cb116-607"><a href="#cb116-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp_pc_ppp_1000 =</span> gdp_pc_ppp <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb116-608"><a href="#cb116-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-609"><a href="#cb116-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-610"><a href="#cb116-610" aria-hidden="true" tabindex="-1"></a>Here is how we can remove remove variables with <span class="in">`mutate()`</span> (although the same can be done with <span class="in">`select()`</span> command):</span>
<span id="cb116-611"><a href="#cb116-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-614"><a href="#cb116-614" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-615"><a href="#cb116-615" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> </span>
<span id="cb116-616"><a href="#cb116-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ISO, gdp_pc_ppp) <span class="sc">%&gt;%</span> </span>
<span id="cb116-617"><a href="#cb116-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp_pc_ppp =</span> <span class="cn">NULL</span>)</span>
<span id="cb116-618"><a href="#cb116-618" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-619"><a href="#cb116-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-620"><a href="#cb116-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-621"><a href="#cb116-621" aria-hidden="true" tabindex="-1"></a>Let's do something a little more complex and create a variable <span class="in">`gdp_outlier`</span> that shows whether the observation for <span class="in">`gdp_pc_ppp`</span> is an outlier:</span>
<span id="cb116-622"><a href="#cb116-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-625"><a href="#cb116-625" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-626"><a href="#cb116-626" aria-hidden="true" tabindex="-1"></a>pei <span class="ot">&lt;-</span> pei <span class="sc">%&gt;%</span> </span>
<span id="cb116-627"><a href="#cb116-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp_outlier_l =</span> gdp_pc_ppp <span class="sc">&lt;</span> <span class="fu">quantile</span>(gdp_pc_ppp, <span class="fl">0.25</span>, <span class="at">na.rm =</span> T) <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> <span class="fu">IQR</span>(gdp_pc_ppp, <span class="at">na.rm =</span> T),</span>
<span id="cb116-628"><a href="#cb116-628" aria-hidden="true" tabindex="-1"></a>         <span class="at">gdp_outlier_u =</span> gdp_pc_ppp <span class="sc">&gt;</span> <span class="fu">quantile</span>(gdp_pc_ppp, <span class="fl">0.75</span>, <span class="at">na.rm =</span> T) <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> <span class="fu">IQR</span>(gdp_pc_ppp, <span class="at">na.rm =</span> T),</span>
<span id="cb116-629"><a href="#cb116-629" aria-hidden="true" tabindex="-1"></a>         <span class="at">gdp_outlier =</span> gdp_outlier_u <span class="sc">|</span> gdp_outlier_u <span class="sc">==</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-630"><a href="#cb116-630" aria-hidden="true" tabindex="-1"></a>         <span class="at">gdp_outlier_l =</span> <span class="cn">NULL</span>, <span class="co"># remove the intermediate variables </span></span>
<span id="cb116-631"><a href="#cb116-631" aria-hidden="true" tabindex="-1"></a>         <span class="at">gdp_outlier_u =</span> <span class="cn">NULL</span> <span class="co"># remove the intermediate variables </span></span>
<span id="cb116-632"><a href="#cb116-632" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb116-633"><a href="#cb116-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-634"><a href="#cb116-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-635"><a href="#cb116-635" aria-hidden="true" tabindex="-1"></a>And you have already seen this function when we renamed the regions above:</span>
<span id="cb116-636"><a href="#cb116-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-639"><a href="#cb116-639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-640"><a href="#cb116-640" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb116-641"><a href="#cb116-641" aria-hidden="true" tabindex="-1"></a>pei <span class="ot">&lt;-</span> pei <span class="sc">%&gt;%</span></span>
<span id="cb116-642"><a href="#cb116-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb116-643"><a href="#cb116-643" aria-hidden="true" tabindex="-1"></a>    <span class="at">region =</span> <span class="fu">case_when</span>(</span>
<span id="cb116-644"><a href="#cb116-644" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Africa"</span>,</span>
<span id="cb116-645"><a href="#cb116-645" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Americas"</span>,</span>
<span id="cb116-646"><a href="#cb116-646" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Asia"</span>,</span>
<span id="cb116-647"><a href="#cb116-647" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Europe"</span>,</span>
<span id="cb116-648"><a href="#cb116-648" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Oceania"</span></span>
<span id="cb116-649"><a href="#cb116-649" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb116-650"><a href="#cb116-650" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb116-651"><a href="#cb116-651" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-652"><a href="#cb116-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-653"><a href="#cb116-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-654"><a href="#cb116-654" aria-hidden="true" tabindex="-1"></a><span class="fu">### `arrange` variables</span></span>
<span id="cb116-655"><a href="#cb116-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-656"><a href="#cb116-656" aria-hidden="true" tabindex="-1"></a><span class="in">`arrange()`</span> allows us to sort/reorder a tibble's (dataframe) rows according to the values of a specific variable. Unlike <span class="in">`filter()`</span> or <span class="in">`select()`</span>, <span class="in">`arrange()`</span> does not remove any rows or columns from the tibble. Example:</span>
<span id="cb116-657"><a href="#cb116-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-660"><a href="#cb116-660" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-661"><a href="#cb116-661" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb116-662"><a href="#cb116-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(PEIIndexp) <span class="sc">%&gt;%</span> </span>
<span id="cb116-663"><a href="#cb116-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ISO, PEIIndexp) <span class="sc">%&gt;%</span></span>
<span id="cb116-664"><a href="#cb116-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb116-665"><a href="#cb116-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-666"><a href="#cb116-666" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb116-667"><a href="#cb116-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(PEIIndexp)) <span class="sc">%&gt;%</span> </span>
<span id="cb116-668"><a href="#cb116-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ISO, PEIIndexp) <span class="sc">%&gt;%</span></span>
<span id="cb116-669"><a href="#cb116-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb116-670"><a href="#cb116-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-671"><a href="#cb116-671" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span></span>
<span id="cb116-672"><a href="#cb116-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>PEIIndexp) <span class="sc">%&gt;%</span> <span class="co"># trick for descending order </span></span>
<span id="cb116-673"><a href="#cb116-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ISO, PEIIndexp) <span class="sc">%&gt;%</span></span>
<span id="cb116-674"><a href="#cb116-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb116-675"><a href="#cb116-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-676"><a href="#cb116-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-677"><a href="#cb116-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-678"><a href="#cb116-678" aria-hidden="true" tabindex="-1"></a><span class="fu">### `summarize()` tibbles</span></span>
<span id="cb116-679"><a href="#cb116-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-680"><a href="#cb116-680" aria-hidden="true" tabindex="-1"></a>We often need to calculate *summary statistics*, things like the *mean* (also called the average) and the *median* (the middle value). Other examples of summary statistics include the *sum*, the *minimum*, the *maximum*, and the *standard deviation*.</span>
<span id="cb116-681"><a href="#cb116-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-682"><a href="#cb116-682" aria-hidden="true" tabindex="-1"></a>The function <span class="in">`summarize()`</span> allows us to calculate these statistics on individual columns from a tibble. Example:</span>
<span id="cb116-683"><a href="#cb116-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-686"><a href="#cb116-686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-687"><a href="#cb116-687" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> <span class="co"># take dataset</span></span>
<span id="cb116-688"><a href="#cb116-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb116-689"><a href="#cb116-689" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_PEIindex =</span> <span class="fu">mean</span>(PEIIndexi, <span class="at">na.rm =</span> T),</span>
<span id="cb116-690"><a href="#cb116-690" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_PEIindex =</span> <span class="fu">sd</span>(PEIIndexi) </span>
<span id="cb116-691"><a href="#cb116-691" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-692"><a href="#cb116-692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-693"><a href="#cb116-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-694"><a href="#cb116-694" aria-hidden="true" tabindex="-1"></a>We can also let <span class="in">`R`</span> perform operations within subgroups, rather than on the entire dataset:</span>
<span id="cb116-695"><a href="#cb116-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-698"><a href="#cb116-698" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-699"><a href="#cb116-699" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> <span class="co"># take dataset</span></span>
<span id="cb116-700"><a href="#cb116-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span> <span class="co"># group by region</span></span>
<span id="cb116-701"><a href="#cb116-701" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb116-702"><a href="#cb116-702" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_PEIindex =</span> <span class="fu">mean</span>(PEIIndexi, <span class="at">na.rm =</span> T),</span>
<span id="cb116-703"><a href="#cb116-703" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_PEIindex =</span> <span class="fu">sd</span>(PEIIndexi, <span class="at">na.rm =</span> T) <span class="co"># why NA?</span></span>
<span id="cb116-704"><a href="#cb116-704" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-705"><a href="#cb116-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-706"><a href="#cb116-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-707"><a href="#cb116-707" aria-hidden="true" tabindex="-1"></a>pei <span class="sc">%&gt;%</span> <span class="co"># take dataset</span></span>
<span id="cb116-708"><a href="#cb116-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span> <span class="co"># group by region</span></span>
<span id="cb116-709"><a href="#cb116-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb116-710"><a href="#cb116-710" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-711"><a href="#cb116-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-712"><a href="#cb116-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-713"><a href="#cb116-713" aria-hidden="true" tabindex="-1"></a><span class="fu">## Special Cases for Data Viz </span></span>
<span id="cb116-714"><a href="#cb116-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-715"><a href="#cb116-715" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adding Text Layer with `geom_text`</span></span>
<span id="cb116-716"><a href="#cb116-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-717"><a href="#cb116-717" aria-hidden="true" tabindex="-1"></a>Sometimes you may want to provide additional layer of information, such as, for instance, the country labels with text. <span class="in">`geom_text`</span> allows us to do so for all observations at once (or a portion of them): </span>
<span id="cb116-718"><a href="#cb116-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-721"><a href="#cb116-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-722"><a href="#cb116-722" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb116-723"><a href="#cb116-723" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb116-724"><a href="#cb116-724" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb116-725"><a href="#cb116-725" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> PEIIndexi, <span class="co"># vertical axis </span></span>
<span id="cb116-726"><a href="#cb116-726" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> gdp_pc_ppp, <span class="co"># horizontal axis </span></span>
<span id="cb116-727"><a href="#cb116-727" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> region <span class="co"># add color by region</span></span>
<span id="cb116-728"><a href="#cb116-728" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-729"><a href="#cb116-729" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb116-730"><a href="#cb116-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># add points </span></span>
<span id="cb116-731"><a href="#cb116-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">100</span>) <span class="sc">+</span> <span class="co"># show 0 to 100 values for y</span></span>
<span id="cb116-732"><a href="#cb116-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb116-733"><a href="#cb116-733" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> ISO), <span class="co"># add label aesthetic, from ISO code variable </span></span>
<span id="cb116-734"><a href="#cb116-734" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span> <span class="co"># hide letters in the legend </span></span>
<span id="cb116-735"><a href="#cb116-735" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb116-736"><a href="#cb116-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="co"># make colors colorblind-friendly</span></span>
<span id="cb116-737"><a href="#cb116-737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-738"><a href="#cb116-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-739"><a href="#cb116-739" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adding Text Layer to Outliers in Boxplot (`ggrepel` package)</span></span>
<span id="cb116-740"><a href="#cb116-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-743"><a href="#cb116-743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-744"><a href="#cb116-744" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb116-745"><a href="#cb116-745" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb116-746"><a href="#cb116-746" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> gdp_pc_ppp, <span class="at">y =</span> <span class="dv">1</span>)</span>
<span id="cb116-747"><a href="#cb116-747" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb116-748"><a href="#cb116-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb116-749"><a href="#cb116-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb116-750"><a href="#cb116-750" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pei <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gdp_outlier),</span>
<span id="cb116-751"><a href="#cb116-751" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> ISO), <span class="at">nudge_y =</span> <span class="fl">0.05</span></span>
<span id="cb116-752"><a href="#cb116-752" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-753"><a href="#cb116-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-754"><a href="#cb116-754" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb116-755"><a href="#cb116-755" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb116-756"><a href="#cb116-756" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> gdp_pc_ppp, <span class="at">y =</span> <span class="dv">1</span>)</span>
<span id="cb116-757"><a href="#cb116-757" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb116-758"><a href="#cb116-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb116-759"><a href="#cb116-759" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb116-760"><a href="#cb116-760" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pei <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gdp_outlier),</span>
<span id="cb116-761"><a href="#cb116-761" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> ISO)</span>
<span id="cb116-762"><a href="#cb116-762" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-763"><a href="#cb116-763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-764"><a href="#cb116-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-765"><a href="#cb116-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-766"><a href="#cb116-766" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adding Two Layers with Different Scales (Advanced)</span></span>
<span id="cb116-767"><a href="#cb116-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-770"><a href="#cb116-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-771"><a href="#cb116-771" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb116-772"><a href="#cb116-772" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> pei,</span>
<span id="cb116-773"><a href="#cb116-773" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> PEIIndexi) <span class="co"># mapping for every geom below</span></span>
<span id="cb116-774"><a href="#cb116-774" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb116-775"><a href="#cb116-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb116-776"><a href="#cb116-776" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="co"># mapping only for histogram</span></span>
<span id="cb116-777"><a href="#cb116-777" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="dv">2</span>, <span class="co"># one bin = one unit of x variable </span></span>
<span id="cb116-778"><a href="#cb116-778" aria-hidden="true" tabindex="-1"></a>    <span class="at">boundary =</span> <span class="dv">0</span>, <span class="co"># there is a cutoff at 0 (for interpretation)</span></span>
<span id="cb116-779"><a href="#cb116-779" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="co"># transparency</span></span>
<span id="cb116-780"><a href="#cb116-780" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey20"</span> <span class="co"># color for borders</span></span>
<span id="cb116-781"><a href="#cb116-781" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb116-782"><a href="#cb116-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb116-783"><a href="#cb116-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb116-784"><a href="#cb116-784" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Density"</span>, <span class="co"># name of the main axis </span></span>
<span id="cb116-785"><a href="#cb116-785" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>( <span class="co"># add second axis </span></span>
<span id="cb116-786"><a href="#cb116-786" aria-hidden="true" tabindex="-1"></a>      <span class="at">trans =</span> <span class="sc">~</span> .x <span class="sc">*</span> (<span class="fu">nrow</span>(pei)), <span class="co"># the transformation to the main axis to be applied </span></span>
<span id="cb116-787"><a href="#cb116-787" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Count"</span>, <span class="co"># name of the second axis </span></span>
<span id="cb116-788"><a href="#cb116-788" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb116-789"><a href="#cb116-789" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb116-790"><a href="#cb116-790" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-791"><a href="#cb116-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-792"><a href="#cb116-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-793"><a href="#cb116-793" aria-hidden="true" tabindex="-1"></a><span class="fu">## Resources</span></span>
<span id="cb116-794"><a href="#cb116-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-795"><a href="#cb116-795" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Chapter 4 **Data transformation** in <span class="ot">&lt;https://r4ds.hadley.nz/data-transform&gt;</span></span>
<span id="cb116-796"><a href="#cb116-796" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Section 2.5 **Visualizing relationships** in <span class="ot">&lt;https://r4ds.hadley.nz/data-visualize#visualizing-relationships&gt;</span></span>
<span id="cb116-797"><a href="#cb116-797" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Chapter 10 **Layers** in <span class="ot">&lt;https://r4ds.hadley.nz/layers&gt;</span></span>
<span id="cb116-798"><a href="#cb116-798" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>