<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Viktoriia Semenova">
<meta name="dcterms.date" content="2023-10-18">

<title>Lab 6: Regression for Describing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="r4da-week06_files/libs/clipboard/clipboard.min.js"></script>
<script src="r4da-week06_files/libs/quarto-html/quarto.js"></script>
<script src="r4da-week06_files/libs/quarto-html/popper.min.js"></script>
<script src="r4da-week06_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="r4da-week06_files/libs/quarto-html/anchor.min.js"></script>
<link href="r4da-week06_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="r4da-week06_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="r4da-week06_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="r4da-week06_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="r4da-week06_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="r4da-week06_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="r4da-week06_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Lab 6: Regression for Describing</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Viktoriia Semenova </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 18, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="goals-for-today" class="level2">
<h2 class="anchored" data-anchor-id="goals-for-today">Goals for Today</h2>
<ol type="1">
<li>Regression with <code>R</code>
<ul>
<li>Fitting a linear model</li>
<li>Interpreting coefficients for continuous predictors</li>
<li>Interpreting coefficients for categorical predictors<br>
</li>
</ul></li>
<li>Regression Diagnostics</li>
<li>Regression Output
<ul>
<li>Make a well-formatted regression table with <code>modelsummary</code></li>
<li>Write up regression equations nicely with <code>equatiomatic</code></li>
</ul></li>
</ol>
<div style="page-break-after: always;"></div>
</section>
<section id="dataset" class="level2">
<h2 class="anchored" data-anchor-id="dataset">Dataset</h2>
<p>We will be working with data on student evaluations of instructors’ beauty and teaching quality for several courses at the University of Texas. The teaching evaluations were conducted at the end of the semester, and the beauty judgments were made later, by six students who had not attended the classes and were not aware of the course evaluations.</p>
<table class="table">
<colgroup>
<col style="width: 27%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>eval</code></td>
<td>Average course rating: (1) very unsatisfactory - (5) excellent</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>beauty</code></td>
<td>Composite beauty rating of 6 students’, with 1 being lowest and 10 highest</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>female</code></td>
<td>Instructor’s a female</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>age</code></td>
<td>Instructor’s age</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>minority</code></td>
<td>Minority status</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>nonenglish</code></td>
<td>Instructor’s non-English speaking native</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>lower</code></td>
<td>Lower division course (years 1-2)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>rank</code></td>
<td>Professor’s tenure rank (tenured, tenure track, teaching)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>course_id</code></td>
<td>Unique course ID</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>students</code></td>
<td>Number of students per class</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>formal</code></td>
<td>Outfit of professor in picture: not formal, formal</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>blkandwhite</code></td>
<td>color of professor’s picture: color, black &amp; white</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>bty_[student_id]</code></td>
<td>Beauty rating of professor from one of 6 students</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>tenure</code></td>
<td>Instructor’s on tenure track</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>tenured</code></td>
<td>Instructor’s on tenure track and already got tenure</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p>Is this an observational study or an experiment? The original research question posed in the paper is whether beauty leads directly to the differences in course evaluations. Given the study design, is it possible to answer this question as it is phrased? If not, rephrase the question.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>evals <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/evals.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 463 Columns: 21
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (1): rank
dbl (20): tenured, prof, minority, age, bty_f2upper, bty_flowerdiv, bty_fupp...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(evals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 463
Columns: 21
$ tenured       &lt;dbl&gt; 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0,…
$ prof          &lt;dbl&gt; 2, 5, 6, 8, 9, 12, 13, 14, 18, 19, 20, 24, 25, 32, 33, 3…
$ minority      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,…
$ age           &lt;dbl&gt; 59, 31, 62, 51, 33, 37, 42, 49, 48, 46, 57, 64, 34, 47, …
$ bty_f2upper   &lt;dbl&gt; 2, 9, 5, 6, 5, 5, 5, 5, 6, 5, 4, 5, 8, 3, 6, 8, 5, 6, 3,…
$ bty_flowerdiv &lt;dbl&gt; 4, 7, 6, 4, 3, 4, 4, 3, 3, 4, 5, 5, 8, 1, 5, 6, 3, 4, 3,…
$ bty_fupperdiv &lt;dbl&gt; 4, 9, 6, 6, 7, 5, 7, 3, 5, 4, 4, 4, 9, 4, 6, 8, 2, 4, 5,…
$ bty_m2upper   &lt;dbl&gt; 3, 6, 6, 3, 5, 4, 5, 5, 4, 5, 6, 5, 8, 3, 5, 5, 3, 4, 4,…
$ bty_mlowerdiv &lt;dbl&gt; 2, 7, 5, 2, 5, 3, 4, 1, 4, 2, 5, 3, 6, 2, 6, 5, 3, 2, 3,…
$ bty_mupperdiv &lt;dbl&gt; 3, 6, 5, 3, 3, 5, 4, 7, 4, 6, 2, 3, 8, 3, 5, 7, 2, 2, 6,…
$ eval          &lt;dbl&gt; 4.5, 4.4, 4.2, 3.4, 4.5, 4.0, 3.8, 3.4, 3.8, 4.3, 3.4, 4…
$ female        &lt;dbl&gt; 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0,…
$ formal        &lt;dbl&gt; 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,…
$ lower         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,…
$ nonenglish    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ students      &lt;dbl&gt; 20, 48, 282, 41, 60, 34, 40, 36, 135, 31, 28, 24, 26, 15…
$ tenure        &lt;dbl&gt; 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,…
$ blkandwhite   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ course_id     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ beauty        &lt;dbl&gt; 3.000000, 7.333333, 5.500000, 4.000000, 4.666667, 4.3333…
$ rank          &lt;chr&gt; "tenured", "tenure track", "tenured", "tenured", "tenure…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive stats table for our datasets</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(str_to_title) <span class="sc">%&gt;%</span> <span class="co"># capitalize all columns for table</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Course_id, <span class="sc">-</span>Prof) <span class="sc">%&gt;%</span> <span class="co"># remove ID variables</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  modelsummary<span class="sc">::</span><span class="fu">datasummary_skim</span>(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Descriptive Statistics for Course Evaluations Dataset"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">histogram =</span> <span class="cn">FALSE</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Descriptive Statistics for Course Evaluations Dataset</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> Unique (#) </th>
   <th style="text-align:right;"> Missing (%) </th>
   <th style="text-align:right;"> Mean </th>
   <th style="text-align:right;"> SD </th>
   <th style="text-align:right;"> Min </th>
   <th style="text-align:right;"> Median </th>
   <th style="text-align:right;"> Max </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Tenured </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.5 </td>
   <td style="text-align:right;"> 0.5 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 1.0 </td>
   <td style="text-align:right;"> 1.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Minority </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.1 </td>
   <td style="text-align:right;"> 0.3 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 1.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Age </td>
   <td style="text-align:right;"> 35 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 48.4 </td>
   <td style="text-align:right;"> 9.8 </td>
   <td style="text-align:right;"> 29.0 </td>
   <td style="text-align:right;"> 48.0 </td>
   <td style="text-align:right;"> 73.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Bty_f2upper </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 5.2 </td>
   <td style="text-align:right;"> 2.0 </td>
   <td style="text-align:right;"> 1.0 </td>
   <td style="text-align:right;"> 5.0 </td>
   <td style="text-align:right;"> 10.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Bty_flowerdiv </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 4.0 </td>
   <td style="text-align:right;"> 1.9 </td>
   <td style="text-align:right;"> 1.0 </td>
   <td style="text-align:right;"> 4.0 </td>
   <td style="text-align:right;"> 8.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Bty_fupperdiv </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 5.0 </td>
   <td style="text-align:right;"> 1.9 </td>
   <td style="text-align:right;"> 1.0 </td>
   <td style="text-align:right;"> 5.0 </td>
   <td style="text-align:right;"> 9.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Bty_m2upper </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 4.8 </td>
   <td style="text-align:right;"> 1.6 </td>
   <td style="text-align:right;"> 1.0 </td>
   <td style="text-align:right;"> 5.0 </td>
   <td style="text-align:right;"> 9.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Bty_mlowerdiv </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3.4 </td>
   <td style="text-align:right;"> 1.6 </td>
   <td style="text-align:right;"> 1.0 </td>
   <td style="text-align:right;"> 3.0 </td>
   <td style="text-align:right;"> 7.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Bty_mupperdiv </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 4.1 </td>
   <td style="text-align:right;"> 2.1 </td>
   <td style="text-align:right;"> 1.0 </td>
   <td style="text-align:right;"> 4.0 </td>
   <td style="text-align:right;"> 9.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Eval </td>
   <td style="text-align:right;"> 29 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 4.0 </td>
   <td style="text-align:right;"> 0.6 </td>
   <td style="text-align:right;"> 2.1 </td>
   <td style="text-align:right;"> 4.0 </td>
   <td style="text-align:right;"> 5.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Female </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.4 </td>
   <td style="text-align:right;"> 0.5 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 1.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Formal </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.2 </td>
   <td style="text-align:right;"> 0.4 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 1.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Lower </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.3 </td>
   <td style="text-align:right;"> 0.5 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 1.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Nonenglish </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.1 </td>
   <td style="text-align:right;"> 0.2 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 1.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Students </td>
   <td style="text-align:right;"> 127 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 55.2 </td>
   <td style="text-align:right;"> 75.1 </td>
   <td style="text-align:right;"> 8.0 </td>
   <td style="text-align:right;"> 29.0 </td>
   <td style="text-align:right;"> 581.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Tenure </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.8 </td>
   <td style="text-align:right;"> 0.4 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 1.0 </td>
   <td style="text-align:right;"> 1.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Blkandwhite </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.2 </td>
   <td style="text-align:right;"> 0.4 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 1.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Beauty </td>
   <td style="text-align:right;"> 35 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 4.4 </td>
   <td style="text-align:right;"> 1.5 </td>
   <td style="text-align:right;"> 1.7 </td>
   <td style="text-align:right;"> 4.3 </td>
   <td style="text-align:right;"> 8.2 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="plotting-the-relationship" class="level2">
<h2 class="anchored" data-anchor-id="plotting-the-relationship">Plotting the Relationship</h2>
<p>The fundamental phenomenon suggested by the study is that better looking teachers are evaluated more favorably. Let’s create a scatterplot to see if this appears to be the case:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(evals, <span class="fu">aes</span>(<span class="at">x =</span> beauty, <span class="at">y =</span> eval)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="r4da-week06_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Before we draw conclusions about the trend, compare the number of observations in the data frame with the approximate number of points on the scatterplot. Is anything awry?</p>
<p>Let’s replot the scatterplot, but this time use <code>geom_jitter</code> and changing the transparency of the data points to handle the potential overplotting:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(evals, <span class="fu">aes</span>(beauty, eval)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_smooth(</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   method = "lm",</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   se = FALSE</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ) +</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>, <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r4da-week06_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fitting-a-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="fitting-a-linear-regression">Fitting a Linear Regression</h2>
<section id="continuous-predictor" class="level3">
<h3 class="anchored" data-anchor-id="continuous-predictor">Continuous Predictor</h3>
<p>Now let’s fit the regression and explore the output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>m_eval1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> beauty, <span class="at">data =</span> evals)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_eval1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = eval ~ beauty, data = evals)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.79906 -0.36728  0.07762  0.40182  1.11261 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.68914    0.07760  47.541  &lt; 2e-16 ***
beauty       0.06997    0.01660   4.215 3.01e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5451 on 461 degrees of freedom
Multiple R-squared:  0.0371,    Adjusted R-squared:  0.03501 
F-statistic: 17.76 on 1 and 461 DF,  p-value: 3.013e-05</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>What does the value of intercept tell us?<br>
What does the value of <em>beauty</em> coefficient estimate tell us?</p>
</blockquote>
<p>You can also write the same code as follows. Both options are valid, but I will be using the latter one as it is much easier to work with in <code>tidyverse</code> functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(evals<span class="sc">$</span>eval <span class="sc">~</span> evals<span class="sc">$</span>beauty) <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = evals$eval ~ evals$beauty)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.79906 -0.36728  0.07762  0.40182  1.11261 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.68914    0.07760  47.541  &lt; 2e-16 ***
evals$beauty  0.06997    0.01660   4.215 3.01e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5451 on 461 degrees of freedom
Multiple R-squared:  0.0371,    Adjusted R-squared:  0.03501 
F-statistic: 17.76 on 1 and 461 DF,  p-value: 3.013e-05</code></pre>
</div>
</div>
<p>Summary is a useful command for depicting the results when you are woring in <code>R</code>, but for plotting and doing manipulations with the estimates, it is much easier to have them in the dataframe format. <code>tidy()</code> from <code>broom</code> gives us exactly that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m_eval1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   3.69      0.0776     47.5  7.66e-180
2 beauty        0.0700    0.0166      4.21 3.01e-  5</code></pre>
</div>
</div>
</section>
<section id="practice-explore-the-effect-of-age" class="level3">
<h3 class="anchored" data-anchor-id="practice-explore-the-effect-of-age">Practice: Explore the Effect of Age</h3>
<p>Plot the relationship between age and course evaluations. Estimate the effect using a linear regression. Interpret the coefficients from the model.</p>
<div class="cell">

</div>
</section>
<section id="categorical-predictor" class="level3">
<h3 class="anchored" data-anchor-id="categorical-predictor">Categorical Predictor</h3>
<p>Now let’s deviate and explore if there is an effect of gender on course evaluations (ignoring the <code>beauty</code> and all other variables for now):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(female)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  female     n
   &lt;dbl&gt; &lt;int&gt;
1      0   268
2      1   195</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>m_eval2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> female, <span class="at">data =</span> evals)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_eval2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = eval ~ female, data = evals)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.96903 -0.36903  0.03097  0.43097  0.99897 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  4.06903    0.03355  121.29  &lt; 2e-16 ***
female      -0.16800    0.05169   -3.25  0.00124 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5492 on 461 degrees of freedom
Multiple R-squared:  0.0224,    Adjusted R-squared:  0.02028 
F-statistic: 10.56 on 1 and 461 DF,  p-value: 0.001239</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>What does the value of intercept tell us?<br>
What does the value of <em>female</em> coefficient estimate tell us?</p>
</blockquote>
<p>Let’s also plot this relationship. Is there anything you’d change about this plot?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(evals, <span class="fu">aes</span>(female, eval)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Female"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_smooth(</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   method = "lm",</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   se = FALSE</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ) +</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r4da-week06_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now let’s go one step further and explore another categorical predictor’s effect on evaluations. This time, let’s look at a categorical/ordinal variable <code>rank</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(rank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  rank             n
  &lt;chr&gt;        &lt;int&gt;
1 teaching       102
2 tenure track   108
3 tenured        253</code></pre>
</div>
</div>
<p>Let’s see what is the default behavior when we put a character variable as a predictor in <code>R</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>m_eval3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> rank, <span class="at">data =</span> evals)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_eval3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = eval ~ rank, data = evals)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.86917 -0.36917  0.03083  0.46111  1.03083 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       4.13333    0.05458  75.727   &lt;2e-16 ***
ranktenure track -0.19444    0.07611  -2.555   0.0109 *  
ranktenured      -0.16416    0.06465  -2.539   0.0114 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5512 on 460 degrees of freedom
Multiple R-squared:  0.01727,   Adjusted R-squared:  0.01299 
F-statistic: 4.041 on 2 and 460 DF,  p-value: 0.01821</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Why do we only have two categories now? How do we interpret these coefficients?</p>
</blockquote>
<p>The default approach creates dummy variables for each category and then includes all but one of these dummy variables into the regression equation (stepping into multiple linear regression territory). Each coefficient for the category-variable thus represents the difference to the baseline category, which missing from the coefficients list but is represented in the intercept value. To illustrate this, let’s do the same procedure as <code>R</code> but by hand:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>evals <span class="ot">&lt;-</span> evals <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">tenuretrack_d =</span> <span class="fu">if_else</span>(rank <span class="sc">==</span> <span class="st">"tenure track"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tenure_d =</span> <span class="fu">if_else</span>(rank <span class="sc">==</span> <span class="st">"tenured"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">teaching_d =</span> <span class="fu">if_else</span>(rank <span class="sc">==</span> <span class="st">"teaching"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(teaching_d, tenuretrack_d, tenure_d, rank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  teaching_d tenuretrack_d tenure_d rank             n
       &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;        &lt;int&gt;
1          0             0        1 tenured        253
2          0             1        0 tenure track   108
3          1             0        0 teaching       102</code></pre>
</div>
</div>
<p>Now if we place all of the new dummy variables in the regression equation, we get almost the same result as above. Why do we see the row with <code>NA</code>s for <code>teaching_d</code>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>m_eval4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> tenuretrack_d <span class="sc">+</span> tenure_d <span class="sc">+</span> teaching_d, <span class="at">data =</span> evals)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_eval4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = eval ~ tenuretrack_d + tenure_d + teaching_d, data = evals)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.86917 -0.36917  0.03083  0.46111  1.03083 

Coefficients: (1 not defined because of singularities)
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    4.13333    0.05458  75.727   &lt;2e-16 ***
tenuretrack_d -0.19444    0.07611  -2.555   0.0109 *  
tenure_d      -0.16416    0.06465  -2.539   0.0114 *  
teaching_d          NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5512 on 460 degrees of freedom
Multiple R-squared:  0.01727,   Adjusted R-squared:  0.01299 
F-statistic: 4.041 on 2 and 460 DF,  p-value: 0.01821</code></pre>
</div>
</div>
<p>This is a better way to write that same thing (omitting the baseline catgory explicitly):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>m_eval4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> tenuretrack_d <span class="sc">+</span> tenure_d, <span class="at">data =</span> evals)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_eval4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = eval ~ tenuretrack_d + tenure_d, data = evals)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.86917 -0.36917  0.03083  0.46111  1.03083 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    4.13333    0.05458  75.727   &lt;2e-16 ***
tenuretrack_d -0.19444    0.07611  -2.555   0.0109 *  
tenure_d      -0.16416    0.06465  -2.539   0.0114 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5512 on 460 degrees of freedom
Multiple R-squared:  0.01727,   Adjusted R-squared:  0.01299 
F-statistic: 4.041 on 2 and 460 DF,  p-value: 0.01821</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Can we use a different baseline category? If yes, how? Will the coefficients change? What about predictions?</p>
</blockquote>
<p>This default approach makes the most sense when we have the categories that are not ranked, like nominal variables (such as parties or conflict types). This is also what <code>R</code> does by default with character variables. Sometimes, you might want to know the difference between particular categories in the middle, like between <em>Tenure Track</em> and <em>Tenured</em>. We could change the baseline in this case so that the coefficients reflect the effect of interest for us. But another way is to create dummy variables slightly differently (we already have these variables in the dataset):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(rank, teaching_d, tenuretrack_d, tenure, tenure_d, tenured)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  rank         teaching_d tenuretrack_d tenure tenure_d tenured     n
  &lt;chr&gt;             &lt;dbl&gt;         &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;
1 teaching              1             0      0        0       0   102
2 tenure track          0             1      1        0       0   108
3 tenured               0             0      1        1       1   253</code></pre>
</div>
</div>
<p>As a result, our predicted values for the dependent variable will be calculates as follows:</p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;"><span class="math inline">\(D_1\)</span></th>
<th style="text-align: center;"><span class="math inline">\(D_2\)</span></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Teaching</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td><span class="math inline">\(\hat Y = \beta_0\)</span></td>
</tr>
<tr class="even">
<td>Tenure Track</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td><span class="math inline">\(\hat Y = \beta_0 + \beta_1\)</span></td>
</tr>
<tr class="odd">
<td>Tenured</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td><span class="math inline">\(\hat Y = \beta_0 + \beta_1 + \beta_2\)</span></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>m_eval5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> tenure <span class="sc">+</span> tenured, <span class="at">data =</span> evals)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_eval5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = eval ~ tenure + tenured, data = evals)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.86917 -0.36917  0.03083  0.46111  1.03083 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  4.13333    0.05458  75.727   &lt;2e-16 ***
tenure      -0.19444    0.07611  -2.555   0.0109 *  
tenured      0.03028    0.06336   0.478   0.6329    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5512 on 460 degrees of freedom
Multiple R-squared:  0.01727,   Adjusted R-squared:  0.01299 
F-statistic: 4.041 on 2 and 460 DF,  p-value: 0.01821</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>What is the baseline category here? What do the coefficients represent?</p>
</blockquote>
<p>Crucially, regression is about <em>average</em> trends in the data. Thus, when interpreting regression coefficients, it is important to indicate this fact:</p>
<blockquote class="blockquote">
<p>A one unit increase in <em>predictor</em> is associated with, on average, <em>coefficient for predictor</em> change in the dependent variable.</p>
</blockquote>
</section>
</section>
<section id="predictions-with-new-data" class="level2">
<h2 class="anchored" data-anchor-id="predictions-with-new-data">Predictions with New Data</h2>
<p>Let’s go back to our model with beauty and course evaluations and generate some fitted values (along with other stats). <code>augment()</code> provides us nicely with the fitted values, i.e.&nbsp;predictions for the data points <em>existing</em> in our dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">augment</span>(m_eval1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 463 × 8
    eval beauty .fitted   .resid    .hat .sigma     .cooksd .std.resid
   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;
 1   4.5   3       3.90  0.601   0.00403  0.545 0.00247         1.10  
 2   4.4   7.33    4.20  0.198   0.0100   0.546 0.000674        0.365 
 3   4.2   5.5     4.07  0.126   0.00325  0.546 0.0000873       0.232 
 4   3.4   4       3.97 -0.569   0.00232  0.545 0.00127        -1.05  
 5   4.5   4.67    4.02  0.484   0.00222  0.545 0.000879        0.890 
 6   4     4.33    3.99  0.00765 0.00217  0.546 0.000000214     0.0140
 7   3.8   4.83    4.03 -0.227   0.00232  0.546 0.000203       -0.418 
 8   3.4   4       3.97 -0.569   0.00232  0.545 0.00127        -1.05  
 9   3.8   4.33    3.99 -0.192   0.00217  0.546 0.000135       -0.353 
10   4.3   4.33    3.99  0.308   0.00217  0.545 0.000347        0.565 
# ℹ 453 more rows</code></pre>
</div>
</div>
<p>Having fitted values, we can plot the line without <code>geom_smooth()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the difference between these plots?</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">augment</span>(m_eval1) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> beauty, <span class="at">y =</span> eval)) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted)) <span class="sc">+</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty"</span>,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>, <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r4da-week06_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">augment</span>(m_eval1) <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> beauty, <span class="at">y =</span> eval)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted)) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty"</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>, <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r4da-week06_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To recap the process of calculating fitted values, let’s obtain fitted values by hand:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># manually</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># say we want to predict the evaluations of someone with beauty score of, say, 5</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>m_eval1<span class="sc">$</span>coefficients <span class="co"># or coef(m_eval1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      beauty 
 3.68914074  0.06997205 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>manual_pred <span class="ot">&lt;-</span> m_eval1<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> m_eval1<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>manual_pred <span class="co"># note the name of the object is misleading</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
   4.039001 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>manual_pred <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>() <span class="co"># remove the name</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.039001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or for a sequence of beauty scores from 1 to 10 at once</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>manual_pred <span class="ot">&lt;-</span> m_eval1<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> m_eval1<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>manual_pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 3.759113 3.829085 3.899057 3.969029 4.039001 4.108973 4.178945 4.248917
 [9] 4.318889 4.388861</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># with predict() function</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create a tibble with the columns we need (using the basic tibble function)</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>evals_new <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">beauty =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a tibble with the columns we need</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expand_grid will create all possible combinations of variable values</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># will be useful with more than one variable later</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>evals_nes <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">beauty =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>evals_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 1
   beauty
    &lt;dbl&gt;
 1      1
 2      2
 3      3
 4      4
 5      5
 6      6
 7      7
 8      8
 9      9
10     10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add predictions to this data</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>evals_new <span class="ot">&lt;-</span> evals_new <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred =</span> <span class="fu">predict</span>(m_eval1, <span class="at">newdata =</span> .))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>evals_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   beauty  pred
    &lt;dbl&gt; &lt;dbl&gt;
 1      1  3.76
 2      2  3.83
 3      3  3.90
 4      4  3.97
 5      5  4.04
 6      6  4.11
 7      7  4.18
 8      8  4.25
 9      9  4.32
10     10  4.39</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check that manual predictions are the same as predict()</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>manual_pred <span class="sc">==</span> evals_new<span class="sc">$</span>pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   1    2    3    4    5    6    7    8    9   10 
TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Why did we choose <code>by = 1</code> in <code>seq()</code> function? Can we set it to another value?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(evals_new, <span class="fu">aes</span>(<span class="at">x =</span> beauty, <span class="at">y =</span> pred)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="r4da-week06_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="practice-predictions-for-categorical-variables" class="level3">
<h3 class="anchored" data-anchor-id="practice-predictions-for-categorical-variables">Practice: Predictions for Categorical Variables</h3>
<p>Work with the model for gender’s effect on evaluations (<code>m_eval2</code>). Calculate the predictions manually for both males and females:</p>
<div class="cell">

</div>
</section>
</section>
<section id="residuals-diagnostics" class="level2">
<h2 class="anchored" data-anchor-id="residuals-diagnostics">Residuals &amp; Diagnostics</h2>
<p>Linear regression comes with a number of assumptions, and inspecting residuals allows us to check whether they are met.</p>
<p>A residuals plot is a scatterplot of the regression residuals against the explanatory variable <span class="math inline">\(X\)</span> or the predicted (fitted) values <span class="math inline">\(\hat Y\)</span>. Residual plot is a diagnostic plot as it helps us to detect patterns in the residuals. Patterns in residuals signal that systematic influences on $Y $still have not been captured by our model, or that our model misrepresents the data, or that errors do not have a constant variance. Ideally, residuals plots should look as if the pattern was generated by pure chance.</p>
<p>Let’s have a look at the residuals plot (recall that <code>augment()</code> calculates them for us):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(m_eval1) <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> beauty, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#800010"</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty Score"</span>,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residuals"</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> F) <span class="co"># loess can help identify patterns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r4da-week06_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let’s think about the constant variance, a.k.a. homoskedasticity, assumption:</p>
<blockquote class="blockquote">
<p>What can we say about variance of residuals across the values of our independent variable, <em>Beauty Score</em>? Do we seem to be able to predict evaluations for some values of <em>Beauty Score</em> better (i.e.&nbsp;they have smaller residuals) than for others (i.e.&nbsp;the residuals are larger)?</p>
</blockquote>
<p>Now about the conditional mean assumption:</p>
<blockquote class="blockquote">
<p>Do the residuals, across each value of <em>Beauty score</em>, seem to sum up to zero (cancel each other out, are distributed equally above and below the zero line)?</p>
</blockquote>
<p>When inspecting the residuals, it is important to identify observations that may be dominating the estimates, and to assess how results change when such dominating data points are dropped. Here is a reminder on the terminology here:</p>
<ul>
<li><em>Outlier</em>: An observation with a <em>large residual</em>; may indicate a sample peculiarity, a data entry error, or some other problems.</li>
<li><em>Leverage</em>: An observation with an extreme value on an <em>independent</em> variable is said to have high leverage. Leverage is a measure of how far an independent variable deviates from its mean. These leverage points may have an effect on the estimate of regression coefficients.</li>
<li><em>Influence</em>: An observation is said to be influential if removing the observation substantially changes the estimate of coefficients.</li>
</ul>
<p>Now let’s check the model for these influential points:</p>
<blockquote class="blockquote">
<p>Which observations (if any) seem to have large residuals, i.e.&nbsp;are potential outliers? Which observations seem to be leverage points (if any)?</p>
</blockquote>
<p>There is also another useful quantity to evaluate influence, <em>Cook’s distance</em>: it is a measure of influence, which aggregates outlier and leverage properties together. The measure of Cook’s distance is based on the difference in predicted (fitted) values with and without particular observations. <code>augment()</code> calculates it for us:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>m_eval1 <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(.cooksd) <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
5.000e-08 2.444e-04 9.967e-04 2.188e-03 2.677e-03 4.059e-02 </code></pre>
</div>
</div>
<p>There are multiple interpretations for this measure, with some researchers recommending to be suspicious of observations with <span class="math inline">\(D_i &gt; 1\)</span> and others goind as far as <span class="math inline">\(\frac{4}{n}\)</span>, with <span class="math inline">\(n\)</span> being the sample size.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>m_eval1 <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.cooksd <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 8
# ℹ 8 variables: eval &lt;dbl&gt;, beauty &lt;dbl&gt;, .fitted &lt;dbl&gt;, .resid &lt;dbl&gt;,
#   .hat &lt;dbl&gt;, .sigma &lt;dbl&gt;, .cooksd &lt;dbl&gt;, .std.resid &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>m_eval1 <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.cooksd <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 26 × 8
    eval beauty .fitted .resid    .hat .sigma .cooksd .std.resid
   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;
 1   3.1   6.67    4.16 -1.06  0.00685  0.543 0.0130       -1.94
 2   2.2   1.67    3.81 -1.61  0.00918  0.540 0.0406       -2.96
 3   4.9   7.83    4.24  0.663 0.0130   0.545 0.00985       1.22
 4   3.4   7.83    4.24 -0.837 0.0130   0.544 0.0157       -1.55
 5   2.1   3       3.90 -1.80  0.00403  0.539 0.0221       -3.31
 6   3     6.67    4.16 -1.16  0.00685  0.543 0.0156       -2.13
 7   2.8   2.33    3.85 -1.05  0.00619  0.543 0.0117       -1.94
 8   2.9   1.67    3.81 -0.906 0.00918  0.544 0.0129       -1.67
 9   2.6   1.67    3.81 -1.21  0.00918  0.543 0.0229       -2.22
10   3     6.33    4.13 -1.13  0.00556  0.543 0.0121       -2.08
# ℹ 16 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(m_eval1) <span class="sc">%&gt;%</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">large_cd =</span> <span class="fu">if_else</span>(.cooksd <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">n</span>(), <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> beauty, <span class="at">y =</span> .resid, <span class="at">color =</span> large_cd)) <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#800010"</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty Score"</span>,</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Cook's Distance above 4/n"</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="r4da-week06_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In general, if we have observations with “large” Cook’s distance, we either want to re-specify our model to account for outliers (do they have something in common?) or to exclude them (and acknowledge that) and re-estimate the model to see if the results change.</p>
<p>With this being a bivariate regression, it is quite likely that there are other variables that are not accounted for. For the sake of demonstration, however, we will re-estimate the model here, dropping the observations with high Cook’s distance:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>evals_sample <span class="ot">&lt;-</span> m_eval1 <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.cooksd <span class="sc">&lt;=</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">n</span>())</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co"># re-estimate the model</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(eval <span class="sc">~</span> beauty, <span class="at">data =</span> evals_sample) <span class="sc">%&gt;%</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = eval ~ beauty, data = evals_sample)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.51277 -0.35528  0.03513  0.36806  1.02555 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.78282    0.07680  49.253  &lt; 2e-16 ***
beauty       0.05749    0.01670   3.443 0.000631 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.496 on 435 degrees of freedom
Multiple R-squared:  0.02653,   Adjusted R-squared:  0.02429 
F-statistic: 11.85 on 1 and 435 DF,  p-value: 0.000631</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># original model</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_eval1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = eval ~ beauty, data = evals)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.79906 -0.36728  0.07762  0.40182  1.11261 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.68914    0.07760  47.541  &lt; 2e-16 ***
beauty       0.06997    0.01660   4.215 3.01e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5451 on 461 degrees of freedom
Multiple R-squared:  0.0371,    Adjusted R-squared:  0.03501 
F-statistic: 17.76 on 1 and 461 DF,  p-value: 3.013e-05</code></pre>
</div>
</div>
</section>
<section id="multiple-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="multiple-linear-regression">Multiple Linear Regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>m_eval6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> beauty <span class="sc">+</span> female, <span class="at">data =</span> evals)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>res_eval6 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(m_eval6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>What is missing in this interpretation?<br>
- A one-unit increase in <code>beauty</code> is associated with, on average, 0.079 increase in teaching evaluation score.</p>
</blockquote>
<section id="visualizing-mlr-with-continuous-and-categorical-predictor" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-mlr-with-continuous-and-categorical-predictor">Visualizing MLR with Continuous and Categorical Predictor</h3>
<p>Let’s visualize this model. What seems off on this plot?</p>
<ol type="1">
<li><p>The regression line does not correspond to the model we estimated (i.e.&nbsp;the line is just the bivariate relationship between y and x)</p></li>
<li><p>Female seems like a continuous variable (which is not the case in this dataset)</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(evals, <span class="fu">aes</span>(beauty, eval, <span class="at">color =</span> female)) <span class="sc">+</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty"</span>,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>, <span class="at">se =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation: colour
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r4da-week06_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Changing the type of the <code>female</code> variable to character or to factor fixed the latter problem, and we have two lines now, one for females and one for males. But according to our model specification, the lines should be parallel, i.e.&nbsp;the effect of beauty is assumed to be the same for both males and females:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">female =</span> <span class="fu">if_else</span>(female <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Female"</span>, <span class="st">"Male"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(beauty, <span class="at">y =</span> eval, <span class="at">color =</span> (female))) <span class="sc">+</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty"</span>,</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="r4da-week06_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can manually draw to separate lines with <code>geom_abline()</code> like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">female =</span> <span class="fu">if_else</span>(female <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Female"</span>, <span class="st">"Male"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(beauty, <span class="at">y =</span> eval, <span class="at">color =</span> (female))) <span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty"</span>,</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> res_eval6<span class="sc">$</span>estimate[<span class="dv">1</span>],</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> res_eval6<span class="sc">$</span>estimate[<span class="dv">2</span>],</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="dv">2</span>)[<span class="dv">1</span>] <span class="co"># set matching color manually</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> res_eval6<span class="sc">$</span>estimate[<span class="dv">1</span>] <span class="sc">+</span> res_eval6<span class="sc">$</span>estimate[<span class="dv">3</span>],</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> res_eval6<span class="sc">$</span>estimate[<span class="dv">2</span>],</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="dv">2</span>)[<span class="dv">2</span>] <span class="co"># set matching color manually</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">5.5</span>)) <span class="sc">+</span> <span class="co"># why not c(1, 5)?</span></span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="r4da-week06_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Or we can use <code>geom_line()</code> and <code>predict()</code> function to plot the parallel lines much quicker. Note that in this case, the regression lines are only plotted for the range of data we have, unlike the <code>geom_abline()</code>. The latter does what is called <em>extrapolation</em> outside of the range of our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">female =</span> <span class="fu">if_else</span>(female <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Female"</span>, <span class="st">"Male"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(beauty, <span class="at">y =</span> eval, <span class="at">color =</span> (female))) <span class="sc">+</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty"</span>,</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span>,</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between Instructor Beauty and Course Evaluations"</span>,</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Instructor is"</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(m_eval6))) <span class="sc">+</span> <span class="co"># plots the parallel lines</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">5.5</span>)) <span class="sc">+</span> <span class="co"># why not c(1, 5)?</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="r4da-week06_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="models-with-multiple-predictors" class="level3">
<h3 class="anchored" data-anchor-id="models-with-multiple-predictors">Models with Multiple Predictors</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>m_eval7 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> beauty <span class="sc">+</span> female <span class="sc">+</span> age <span class="sc">+</span> nonenglish, <span class="at">data =</span> evals)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m_eval7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  3.89      0.177      22.0   8.35e-74
2 beauty       0.0753    0.0170      4.42  1.22e- 5
3 female      -0.212     0.0523     -4.07  5.64e- 5
4 age         -0.00242   0.00274    -0.885 3.77e- 1
5 nonenglish  -0.334     0.104      -3.23  1.34e- 3</code></pre>
</div>
</div>
<ul>
<li>How do we interpret these coefficients?</li>
</ul>
<blockquote class="blockquote">
<p>For a male English instructor with beauty score of zero and of age zero, the teaching evaluations are expected to be 3.89. This value is meaningless as age of zero is not possible given the assumed DGP.<br>
A one point increase in the beauty score is, on average, associated with a 0.08 increase in course evaluations, holding all else constant. &nbsp; Course of female instructors are, on average, evaluated 0.21 points lower than courses of male instructors, holding age, beauty, and native language constant.<br>
Having English as their native language is associated with an average increase of 0.33 points in course evaluations, holding all else constant.<br>
On average, every additional 10 years in age of the professor are associated with a 0.02 decrease in course evaluations, holding the beauty, sex, and native language constant.<br>
</p>
</blockquote>
<hr>
</section>
</section>
<section id="working-with-model-output" class="level2">
<h2 class="anchored" data-anchor-id="working-with-model-output">Working with Model Output</h2>
<section id="well-formatted-table" class="level3">
<h3 class="anchored" data-anchor-id="well-formatted-table">Well-formatted Table</h3>
<p>There are plenty of packages that you can use to make nice regression tables. We will primarily use <code>modelsummary</code>, which works well for both HTML and PDF formats and requires no extra manipulations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">models =</span> <span class="fu">list</span>(m_eval1, m_eval2, m_eval5),</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Linear Regression Estimates"</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">"IC|F|Log."</span>,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"lccc"</span>),</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">coef_map =</span> <span class="fu">c</span>( <span class="co"># renames + selects + orders coefs in the table</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"beauty"</span> <span class="ot">=</span> <span class="st">"Beauty Score"</span>,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"Female"</span>,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tenure"</span> <span class="ot">=</span> <span class="st">"Rank: Tenure Track"</span>,</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tenured"</span> <span class="ot">=</span> <span class="st">"Rank: Tenured"</span>,</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"(Intercept)"</span> <span class="ot">=</span> <span class="st">"Intercept"</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">notes =</span> <span class="st">"Notes: Standard errors in parentheses. Baseline category for Rank variable is Teaching."</span>,</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>, <span class="co"># round to 3 digits after zero</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>, <span class="co"># have no extra columns for SE</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> <span class="st">"{estimate} ({std.error})"</span>, <span class="co"># print coef and SE in one line</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table">
<caption>Linear Regression Estimates</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:center;"> Model 1 </th>
   <th style="text-align:center;"> Model 2 </th>
   <th style="text-align:center;"> Model 3 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Beauty Score </td>
   <td style="text-align:center;"> 0.07 (0.02) </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Female </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> −0.17 (0.05) </td>
   <td style="text-align:center;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Rank: Tenure Track </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> −0.19 (0.08) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Rank: Tenured </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> 0.03 (0.06) </td>
  </tr>
  <tr>
   <td style="text-align:left;box-shadow: 0px 1px"> Intercept </td>
   <td style="text-align:center;box-shadow: 0px 1px"> 3.69 (0.08) </td>
   <td style="text-align:center;box-shadow: 0px 1px"> 4.07 (0.03) </td>
   <td style="text-align:center;box-shadow: 0px 1px"> 4.13 (0.05) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Num.Obs. </td>
   <td style="text-align:center;"> 463 </td>
   <td style="text-align:center;"> 463 </td>
   <td style="text-align:center;"> 463 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> R2 </td>
   <td style="text-align:center;"> 0.037 </td>
   <td style="text-align:center;"> 0.022 </td>
   <td style="text-align:center;"> 0.017 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> R2 Adj. </td>
   <td style="text-align:center;"> 0.035 </td>
   <td style="text-align:center;"> 0.020 </td>
   <td style="text-align:center;"> 0.013 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> RMSE </td>
   <td style="text-align:center;"> 0.54 </td>
   <td style="text-align:center;"> 0.55 </td>
   <td style="text-align:center;"> 0.55 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<sup></sup> Notes: Standard errors in parentheses. Baseline category for Rank variable is Teaching.</td></tr></tfoot>
</table>

</div>
</div>
</section>
<section id="regression-equation" class="level3">
<h3 class="anchored" data-anchor-id="regression-equation">Regression equation</h3>
<p>While writing papers (in this class and beyond), you will be asked to specify your regression’ systematic component. It is fairly easy to do with Latex [Lah-tech], a special typesetting environment perfect for writing up formulas and equations. Here is how you would write the systematic component of the last model we worked with. You would write something like…</p>
<blockquote class="blockquote">
<p>I estimate an OLS model with the following systematic component: <span class="math display">\[
\operatorname{\widehat{Evaluation}} = \hat \beta_{0} + \hat\beta_{1}\text{Beauty Score}
\]</span></p>
</blockquote>
<p>This usually goes in the <em>Analysis</em> section of the research paper.</p>
<p>Good news: some smart people also wrote a package <code>equatiomatic</code> that extracts the model equations from model objects directly:</p>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: asis</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(m_eval1, <span class="at">intercept =</span> <span class="st">"beta"</span>, <span class="at">ital_vars =</span> T)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
eval = \beta_{0} + \beta_{1}(beauty) + \epsilon
\]</span></p>
</div>
<p>Note a few things:</p>
<ul>
<li>this equation is different from what we wrote above: it includes the error term, so it covers both the systematic and the stochastic components of the model</li>
<li>we need to tell <code>R</code> to treat the output as raw text by specifying chunk option <code>#| results: asis</code> for the equation to appear correctly</li>
<li>this works well with HTML output, but sometimes can cause troubles in PDF. A quick fix would be to start with the output provided, edit it, and insert it manually</li>
</ul>
</section>
</section>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">Resources</h2>
<ul>
<li>Bivariate Regression Analysis and Diagnostics in <a href="https://openintro-ims2.netlify.app/07-model-slr" class="uri">https://openintro-ims2.netlify.app/07-model-slr</a></li>
<li>Multiple Linear Regression Analysis in <a href="https://openintro-ims2.netlify.app/08-model-mlr" class="uri">https://openintro-ims2.netlify.app/08-model-mlr</a></li>
</ul>
</section>
<section id="data-prep-example-course-evaluations-data" class="level2">
<h2 class="anchored" data-anchor-id="data-prep-example-course-evaluations-data">Data Prep Example: Course Evaluations Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">"http://www.stat.ucla.edu/~handcock/216/examples/beauty/ProfEvaltnsBeautyPublic.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">class0 =</span> (<span class="fu">sum</span>(<span class="fu">c_across</span>(class1<span class="sc">:</span>class30))),</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">class0 =</span> <span class="fu">ifelse</span>(class0 <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(class0, <span class="at">.before =</span> class1) <span class="sc">%&gt;%</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(course_id, val, class0<span class="sc">:</span>class30) <span class="sc">%&gt;%</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(val <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>val) <span class="sc">%&gt;%</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">course_id =</span> <span class="fu">as.numeric</span>(<span class="fu">str_extract</span>(course_id, <span class="st">"</span><span class="sc">\\</span><span class="st">d.*"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">beauty =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">starts_with</span>(<span class="st">"beauty"</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">rank =</span> <span class="fu">case_when</span>(</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>      tenuretrack <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> tenured <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"tenured"</span>,</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>      tenuretrack <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> tenured <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"tenure track"</span>,</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>      tenuretrack <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> tenured <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"teaching"</span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">prof =</span> profnumber,</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">eval =</span> courseevaluation,</span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">tenure =</span> tenuretrack</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"bty"</span>),</span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>didevaluation,</span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>fulldept,</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>multipleclass,</span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>onecredit,</span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>percentevaluating,</span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>profevaluation,</span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(</span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fn =</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"bty_"</span>, <span class="fu">str_remove</span>(.x, <span class="st">"beauty"</span>)),</span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> beautyf2upper<span class="sc">:</span>beautymupperdiv</span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%T&gt;%</span></span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(<span class="st">"data/evals.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 463 Columns: 64
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (64): tenured, profnumber, minority, age, beautyf2upper, beautyflowerdiv...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 463 × 21
   tenured  prof minority   age bty_f2upper bty_flowerdiv bty_fupperdiv
     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
 1       1     2        0    59           2             4             4
 2       0     5        0    31           9             7             9
 3       1     6        0    62           5             6             6
 4       1     8        0    51           6             4             6
 5       0     9        0    33           5             3             7
 6       0    12        0    37           5             4             5
 7       1    13        0    42           5             4             7
 8       1    14        0    49           5             3             3
 9       0    18        0    48           6             3             5
10       1    19        0    46           5             4             4
# ℹ 453 more rows
# ℹ 14 more variables: bty_m2upper &lt;dbl&gt;, bty_mlowerdiv &lt;dbl&gt;,
#   bty_mupperdiv &lt;dbl&gt;, eval &lt;dbl&gt;, female &lt;dbl&gt;, formal &lt;dbl&gt;, lower &lt;dbl&gt;,
#   nonenglish &lt;dbl&gt;, students &lt;dbl&gt;, tenure &lt;dbl&gt;, blkandwhite &lt;dbl&gt;,
#   course_id &lt;dbl&gt;, beauty &lt;dbl&gt;, rank &lt;chr&gt;</code></pre>
</div>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb83" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Lab 6: Regression for Describing"</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Viktoriia Semenova"</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> source</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "October 18, 2023"</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: slides.scss </span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf:</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="co">    colorlinks: true</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="co">    geometry: </span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="co">      - top=30mm</span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="co">      - left=30mm</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="an">highlight-style:</span><span class="co"> github</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a><span class="co"># packages needed</span></span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a><span class="co"># put all packages we use in a vector</span></span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a>p_needed <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyverse"</span>, <span class="co"># shortcut for ggplot2, dplyr, readr</span></span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"janitor"</span>, <span class="co"># clean_names for datasets</span></span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"visdat"</span>, <span class="co"># visual inspection of datasets</span></span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"janitor"</span>, <span class="co"># clean variable names</span></span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"modelsummary"</span>, <span class="co"># descriptive table</span></span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"styler"</span>, <span class="co"># to style the code</span></span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"broom"</span>,</span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"magrittr"</span>, <span class="co"># for more pipes</span></span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"remotes"</span>, <span class="co"># to install packages from GitHub</span></span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"styler"</span> <span class="co"># to style the code</span></span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-39"><a href="#cb83-39" aria-hidden="true" tabindex="-1"></a><span class="co"># check if they are already installed, install if not installed</span></span>
<span id="cb83-40"><a href="#cb83-40" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(</span>
<span id="cb83-41"><a href="#cb83-41" aria-hidden="true" tabindex="-1"></a>  p_needed[<span class="sc">!</span>(p_needed <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>()))],</span>
<span id="cb83-42"><a href="#cb83-42" aria-hidden="true" tabindex="-1"></a>  install.packages</span>
<span id="cb83-43"><a href="#cb83-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-44"><a href="#cb83-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-45"><a href="#cb83-45" aria-hidden="true" tabindex="-1"></a><span class="co"># install a package from GitHub (if not installed already)</span></span>
<span id="cb83-46"><a href="#cb83-46" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">"equatiomatic"</span> <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>())) {</span>
<span id="cb83-47"><a href="#cb83-47" aria-hidden="true" tabindex="-1"></a>  remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"datalorax/equatiomatic"</span>)</span>
<span id="cb83-48"><a href="#cb83-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-49"><a href="#cb83-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-50"><a href="#cb83-50" aria-hidden="true" tabindex="-1"></a><span class="co"># load the packages</span></span>
<span id="cb83-51"><a href="#cb83-51" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(p_needed, library, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-52"><a href="#cb83-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-53"><a href="#cb83-53" aria-hidden="true" tabindex="-1"></a><span class="co"># same theme for all plots</span></span>
<span id="cb83-54"><a href="#cb83-54" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>())</span>
<span id="cb83-55"><a href="#cb83-55" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-56"><a href="#cb83-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-57"><a href="#cb83-57" aria-hidden="true" tabindex="-1"></a><span class="fu">## Goals for Today</span></span>
<span id="cb83-58"><a href="#cb83-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-59"><a href="#cb83-59" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Regression with <span class="in">`R`</span></span>
<span id="cb83-60"><a href="#cb83-60" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Fitting a linear model</span>
<span id="cb83-61"><a href="#cb83-61" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Interpreting coefficients for continuous predictors</span>
<span id="cb83-62"><a href="#cb83-62" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Interpreting coefficients for categorical predictors\</span>
<span id="cb83-63"><a href="#cb83-63" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Regression Diagnostics</span>
<span id="cb83-64"><a href="#cb83-64" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Regression Output</span>
<span id="cb83-65"><a href="#cb83-65" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Make a well-formatted regression table with <span class="in">`modelsummary`</span></span>
<span id="cb83-66"><a href="#cb83-66" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Write up regression equations nicely with <span class="in">`equatiomatic`</span></span>
<span id="cb83-67"><a href="#cb83-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-68"><a href="#cb83-68" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb83-69"><a href="#cb83-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-70"><a href="#cb83-70" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dataset</span></span>
<span id="cb83-71"><a href="#cb83-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-72"><a href="#cb83-72" aria-hidden="true" tabindex="-1"></a>We will be working with data on student evaluations of instructors' beauty and teaching quality for several courses at the University of Texas. The teaching evaluations were conducted at the end of the semester, and the beauty judgments were made later, by six students who had not attended the classes and were not aware of the course evaluations.</span>
<span id="cb83-73"><a href="#cb83-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-74"><a href="#cb83-74" aria-hidden="true" tabindex="-1"></a>|      Variable      | Description                                                                |</span>
<span id="cb83-75"><a href="#cb83-75" aria-hidden="true" tabindex="-1"></a>|:------------------:|----------------------------------------------------|</span>
<span id="cb83-76"><a href="#cb83-76" aria-hidden="true" tabindex="-1"></a>|       <span class="in">`eval`</span>       | Average course rating: (1) very unsatisfactory - (5) excellent             |</span>
<span id="cb83-77"><a href="#cb83-77" aria-hidden="true" tabindex="-1"></a>|      <span class="in">`beauty`</span>      | Composite beauty rating of 6 students', with 1 being lowest and 10 highest |</span>
<span id="cb83-78"><a href="#cb83-78" aria-hidden="true" tabindex="-1"></a>|      <span class="in">`female`</span>      | Instructor's a female                                                      |</span>
<span id="cb83-79"><a href="#cb83-79" aria-hidden="true" tabindex="-1"></a>|       <span class="in">`age`</span>        | Instructor's age                                                           |</span>
<span id="cb83-80"><a href="#cb83-80" aria-hidden="true" tabindex="-1"></a>|     <span class="in">`minority`</span>     | Minority status                                                            |</span>
<span id="cb83-81"><a href="#cb83-81" aria-hidden="true" tabindex="-1"></a>|    <span class="in">`nonenglish`</span>    | Instructor's non-English speaking native                                   |</span>
<span id="cb83-82"><a href="#cb83-82" aria-hidden="true" tabindex="-1"></a>|      <span class="in">`lower`</span>       | Lower division course (years 1-2)                                          |</span>
<span id="cb83-83"><a href="#cb83-83" aria-hidden="true" tabindex="-1"></a>|       <span class="in">`rank`</span>       | Professor's tenure rank (tenured, tenure track, teaching)                  |</span>
<span id="cb83-84"><a href="#cb83-84" aria-hidden="true" tabindex="-1"></a>|    <span class="in">`course_id`</span>     | Unique course ID                                                           |</span>
<span id="cb83-85"><a href="#cb83-85" aria-hidden="true" tabindex="-1"></a>|     <span class="in">`students`</span>     | Number of students per class                                               |</span>
<span id="cb83-86"><a href="#cb83-86" aria-hidden="true" tabindex="-1"></a>|      <span class="in">`formal`</span>      | Outfit of professor in picture: not formal, formal                         |</span>
<span id="cb83-87"><a href="#cb83-87" aria-hidden="true" tabindex="-1"></a>|   <span class="in">`blkandwhite`</span>    | color of professor's picture: color, black &amp; white                         |</span>
<span id="cb83-88"><a href="#cb83-88" aria-hidden="true" tabindex="-1"></a>| <span class="in">`bty_[student_id]`</span> | Beauty rating of professor from one of 6 students                          |</span>
<span id="cb83-89"><a href="#cb83-89" aria-hidden="true" tabindex="-1"></a>|      <span class="in">`tenure`</span>      | Instructor's on tenure track                                               |</span>
<span id="cb83-90"><a href="#cb83-90" aria-hidden="true" tabindex="-1"></a>|     <span class="in">`tenured`</span>      | Instructor's on tenure track and already got tenure                        |</span>
<span id="cb83-91"><a href="#cb83-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-92"><a href="#cb83-92" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Is this an observational study or an experiment? The original research question posed in the paper is whether beauty leads directly to the differences in course evaluations. Given the study design, is it possible to answer this question as it is phrased? If not, rephrase the question.</span></span>
<span id="cb83-93"><a href="#cb83-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-96"><a href="#cb83-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-97"><a href="#cb83-97" aria-hidden="true" tabindex="-1"></a>evals <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/evals.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-98"><a href="#cb83-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb83-99"><a href="#cb83-99" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(evals)</span>
<span id="cb83-100"><a href="#cb83-100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-101"><a href="#cb83-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-104"><a href="#cb83-104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-105"><a href="#cb83-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive stats table for our datasets</span></span>
<span id="cb83-106"><a href="#cb83-106" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb83-107"><a href="#cb83-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(str_to_title) <span class="sc">%&gt;%</span> <span class="co"># capitalize all columns for table</span></span>
<span id="cb83-108"><a href="#cb83-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Course_id, <span class="sc">-</span>Prof) <span class="sc">%&gt;%</span> <span class="co"># remove ID variables</span></span>
<span id="cb83-109"><a href="#cb83-109" aria-hidden="true" tabindex="-1"></a>  modelsummary<span class="sc">::</span><span class="fu">datasummary_skim</span>(</span>
<span id="cb83-110"><a href="#cb83-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Descriptive Statistics for Course Evaluations Dataset"</span>,</span>
<span id="cb83-111"><a href="#cb83-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">histogram =</span> <span class="cn">FALSE</span></span>
<span id="cb83-112"><a href="#cb83-112" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-113"><a href="#cb83-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-114"><a href="#cb83-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-115"><a href="#cb83-115" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plotting the Relationship</span></span>
<span id="cb83-116"><a href="#cb83-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-117"><a href="#cb83-117" aria-hidden="true" tabindex="-1"></a>The fundamental phenomenon suggested by the study is that better looking teachers are evaluated more favorably. Let's create a scatterplot to see if this appears to be the case:</span>
<span id="cb83-118"><a href="#cb83-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-121"><a href="#cb83-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-122"><a href="#cb83-122" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(evals, <span class="fu">aes</span>(<span class="at">x =</span> beauty, <span class="at">y =</span> eval)) <span class="sc">+</span></span>
<span id="cb83-123"><a href="#cb83-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb83-124"><a href="#cb83-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-125"><a href="#cb83-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-126"><a href="#cb83-126" aria-hidden="true" tabindex="-1"></a>Before we draw conclusions about the trend, compare the number of observations in the data frame with the approximate number of points on the scatterplot. Is anything awry?</span>
<span id="cb83-127"><a href="#cb83-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-128"><a href="#cb83-128" aria-hidden="true" tabindex="-1"></a>Let's replot the scatterplot, but this time use <span class="in">`geom_jitter`</span> and changing the transparency of the data points to handle the potential overplotting:</span>
<span id="cb83-129"><a href="#cb83-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-132"><a href="#cb83-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-133"><a href="#cb83-133" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(evals, <span class="fu">aes</span>(beauty, eval)) <span class="sc">+</span></span>
<span id="cb83-134"><a href="#cb83-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb83-135"><a href="#cb83-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb83-136"><a href="#cb83-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb83-137"><a href="#cb83-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb83-138"><a href="#cb83-138" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-139"><a href="#cb83-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb83-140"><a href="#cb83-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty"</span>,</span>
<span id="cb83-141"><a href="#cb83-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span></span>
<span id="cb83-142"><a href="#cb83-142" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-143"><a href="#cb83-143" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_smooth(</span></span>
<span id="cb83-144"><a href="#cb83-144" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   method = "lm",</span></span>
<span id="cb83-145"><a href="#cb83-145" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   se = FALSE</span></span>
<span id="cb83-146"><a href="#cb83-146" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ) +</span></span>
<span id="cb83-147"><a href="#cb83-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>, <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb83-148"><a href="#cb83-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb83-149"><a href="#cb83-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-150"><a href="#cb83-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-151"><a href="#cb83-151" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fitting a Linear Regression</span></span>
<span id="cb83-152"><a href="#cb83-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-153"><a href="#cb83-153" aria-hidden="true" tabindex="-1"></a><span class="fu">### Continuous Predictor</span></span>
<span id="cb83-154"><a href="#cb83-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-155"><a href="#cb83-155" aria-hidden="true" tabindex="-1"></a>Now let's fit the regression and explore the output:</span>
<span id="cb83-156"><a href="#cb83-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-159"><a href="#cb83-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-160"><a href="#cb83-160" aria-hidden="true" tabindex="-1"></a>m_eval1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> beauty, <span class="at">data =</span> evals)</span>
<span id="cb83-161"><a href="#cb83-161" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_eval1)</span>
<span id="cb83-162"><a href="#cb83-162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-163"><a href="#cb83-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-164"><a href="#cb83-164" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; What does the value of intercept tell us?\</span></span>
<span id="cb83-165"><a href="#cb83-165" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; What does the value of *beauty* coefficient estimate tell us?</span></span>
<span id="cb83-166"><a href="#cb83-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-167"><a href="#cb83-167" aria-hidden="true" tabindex="-1"></a>You can also write the same code as follows. Both options are valid, but I will be using the latter one as it is much easier to work with in <span class="in">`tidyverse`</span> functions:</span>
<span id="cb83-168"><a href="#cb83-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-171"><a href="#cb83-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-172"><a href="#cb83-172" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(evals<span class="sc">$</span>eval <span class="sc">~</span> evals<span class="sc">$</span>beauty) <span class="sc">%&gt;%</span></span>
<span id="cb83-173"><a href="#cb83-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb83-174"><a href="#cb83-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-175"><a href="#cb83-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-176"><a href="#cb83-176" aria-hidden="true" tabindex="-1"></a>Summary is a useful command for depicting the results when you are woring in <span class="in">`R`</span>, but for plotting and doing manipulations with the estimates, it is much easier to have them in the dataframe format. <span class="in">`tidy()`</span> from <span class="in">`broom`</span> gives us exactly that:</span>
<span id="cb83-177"><a href="#cb83-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-180"><a href="#cb83-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-181"><a href="#cb83-181" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m_eval1)</span>
<span id="cb83-182"><a href="#cb83-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-183"><a href="#cb83-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-184"><a href="#cb83-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-185"><a href="#cb83-185" aria-hidden="true" tabindex="-1"></a><span class="fu">### Practice: Explore the Effect of Age </span></span>
<span id="cb83-186"><a href="#cb83-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-187"><a href="#cb83-187" aria-hidden="true" tabindex="-1"></a>Plot the relationship between age and course evaluations. Estimate the effect using a linear regression. Interpret the coefficients from the model.</span>
<span id="cb83-188"><a href="#cb83-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-191"><a href="#cb83-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-192"><a href="#cb83-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-193"><a href="#cb83-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-194"><a href="#cb83-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-195"><a href="#cb83-195" aria-hidden="true" tabindex="-1"></a><span class="fu">### Categorical Predictor</span></span>
<span id="cb83-196"><a href="#cb83-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-197"><a href="#cb83-197" aria-hidden="true" tabindex="-1"></a>Now let's deviate and explore if there is an effect of gender on course evaluations (ignoring the <span class="in">`beauty`</span> and all other variables for now):</span>
<span id="cb83-198"><a href="#cb83-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-201"><a href="#cb83-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-202"><a href="#cb83-202" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb83-203"><a href="#cb83-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(female)</span>
<span id="cb83-204"><a href="#cb83-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-205"><a href="#cb83-205" aria-hidden="true" tabindex="-1"></a>m_eval2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> female, <span class="at">data =</span> evals)</span>
<span id="cb83-206"><a href="#cb83-206" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_eval2)</span>
<span id="cb83-207"><a href="#cb83-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-208"><a href="#cb83-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-209"><a href="#cb83-209" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; What does the value of intercept tell us?\</span></span>
<span id="cb83-210"><a href="#cb83-210" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; What does the value of *female* coefficient estimate tell us?</span></span>
<span id="cb83-211"><a href="#cb83-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-212"><a href="#cb83-212" aria-hidden="true" tabindex="-1"></a>Let's also plot this relationship. Is there anything you'd change about this plot?</span>
<span id="cb83-213"><a href="#cb83-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-216"><a href="#cb83-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-217"><a href="#cb83-217" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(evals, <span class="fu">aes</span>(female, eval)) <span class="sc">+</span></span>
<span id="cb83-218"><a href="#cb83-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb83-219"><a href="#cb83-219" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb83-220"><a href="#cb83-220" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb83-221"><a href="#cb83-221" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb83-222"><a href="#cb83-222" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-223"><a href="#cb83-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb83-224"><a href="#cb83-224" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Female"</span>,</span>
<span id="cb83-225"><a href="#cb83-225" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span></span>
<span id="cb83-226"><a href="#cb83-226" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-227"><a href="#cb83-227" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_smooth(</span></span>
<span id="cb83-228"><a href="#cb83-228" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   method = "lm",</span></span>
<span id="cb83-229"><a href="#cb83-229" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   se = FALSE</span></span>
<span id="cb83-230"><a href="#cb83-230" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ) +</span></span>
<span id="cb83-231"><a href="#cb83-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb83-232"><a href="#cb83-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-233"><a href="#cb83-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-234"><a href="#cb83-234" aria-hidden="true" tabindex="-1"></a>Now let's go one step further and explore another categorical predictor's effect on evaluations. This time, let's look at a categorical/ordinal variable <span class="in">`rank`</span>.</span>
<span id="cb83-235"><a href="#cb83-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-238"><a href="#cb83-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-239"><a href="#cb83-239" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb83-240"><a href="#cb83-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(rank)</span>
<span id="cb83-241"><a href="#cb83-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-242"><a href="#cb83-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-243"><a href="#cb83-243" aria-hidden="true" tabindex="-1"></a>Let's see what is the default behavior when we put a character variable as a predictor in <span class="in">`R`</span>:</span>
<span id="cb83-244"><a href="#cb83-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-247"><a href="#cb83-247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-248"><a href="#cb83-248" aria-hidden="true" tabindex="-1"></a>m_eval3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> rank, <span class="at">data =</span> evals)</span>
<span id="cb83-249"><a href="#cb83-249" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_eval3)</span>
<span id="cb83-250"><a href="#cb83-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-251"><a href="#cb83-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-252"><a href="#cb83-252" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Why do we only have two categories now? How do we interpret these coefficients?</span></span>
<span id="cb83-253"><a href="#cb83-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-254"><a href="#cb83-254" aria-hidden="true" tabindex="-1"></a>The default approach creates dummy variables for each category and then includes all but one of these dummy variables into the regression equation (stepping into multiple linear regression territory). Each coefficient for the category-variable thus represents the difference to the baseline category, which missing from the coefficients list but is represented in the intercept value. To illustrate this, let's do the same procedure as <span class="in">`R`</span> but by hand:</span>
<span id="cb83-255"><a href="#cb83-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-258"><a href="#cb83-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-259"><a href="#cb83-259" aria-hidden="true" tabindex="-1"></a>evals <span class="ot">&lt;-</span> evals <span class="sc">%&gt;%</span></span>
<span id="cb83-260"><a href="#cb83-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb83-261"><a href="#cb83-261" aria-hidden="true" tabindex="-1"></a>    <span class="at">tenuretrack_d =</span> <span class="fu">if_else</span>(rank <span class="sc">==</span> <span class="st">"tenure track"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb83-262"><a href="#cb83-262" aria-hidden="true" tabindex="-1"></a>    <span class="at">tenure_d =</span> <span class="fu">if_else</span>(rank <span class="sc">==</span> <span class="st">"tenured"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb83-263"><a href="#cb83-263" aria-hidden="true" tabindex="-1"></a>    <span class="at">teaching_d =</span> <span class="fu">if_else</span>(rank <span class="sc">==</span> <span class="st">"teaching"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb83-264"><a href="#cb83-264" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-265"><a href="#cb83-265" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb83-266"><a href="#cb83-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(teaching_d, tenuretrack_d, tenure_d, rank)</span>
<span id="cb83-267"><a href="#cb83-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-268"><a href="#cb83-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-269"><a href="#cb83-269" aria-hidden="true" tabindex="-1"></a>Now if we place all of the new dummy variables in the regression equation, we get almost the same result as above. Why do we see the row with <span class="in">`NA`</span>s for <span class="in">`teaching_d`</span>?</span>
<span id="cb83-270"><a href="#cb83-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-273"><a href="#cb83-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-274"><a href="#cb83-274" aria-hidden="true" tabindex="-1"></a>m_eval4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> tenuretrack_d <span class="sc">+</span> tenure_d <span class="sc">+</span> teaching_d, <span class="at">data =</span> evals)</span>
<span id="cb83-275"><a href="#cb83-275" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_eval4)</span>
<span id="cb83-276"><a href="#cb83-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-277"><a href="#cb83-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-278"><a href="#cb83-278" aria-hidden="true" tabindex="-1"></a>This is a better way to write that same thing (omitting the baseline catgory explicitly):</span>
<span id="cb83-279"><a href="#cb83-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-282"><a href="#cb83-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-283"><a href="#cb83-283" aria-hidden="true" tabindex="-1"></a>m_eval4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> tenuretrack_d <span class="sc">+</span> tenure_d, <span class="at">data =</span> evals)</span>
<span id="cb83-284"><a href="#cb83-284" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_eval4)</span>
<span id="cb83-285"><a href="#cb83-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-286"><a href="#cb83-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-287"><a href="#cb83-287" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Can we use a different baseline category? If yes, how? Will the coefficients change? What about predictions?</span></span>
<span id="cb83-288"><a href="#cb83-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-289"><a href="#cb83-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-290"><a href="#cb83-290" aria-hidden="true" tabindex="-1"></a>This default approach makes the most sense when we have the categories that are not ranked, like nominal variables (such as parties or conflict types). This is also what <span class="in">`R`</span> does by default with character variables. Sometimes, you might want to know the difference between particular categories in the middle, like between *Tenure Track* and *Tenured*. We could change the baseline in this case so that the coefficients reflect the effect of interest for us. But another way is to create dummy variables slightly differently (we already have these variables in the dataset):</span>
<span id="cb83-291"><a href="#cb83-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-294"><a href="#cb83-294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-295"><a href="#cb83-295" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb83-296"><a href="#cb83-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(rank, teaching_d, tenuretrack_d, tenure, tenure_d, tenured)</span>
<span id="cb83-297"><a href="#cb83-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-298"><a href="#cb83-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-299"><a href="#cb83-299" aria-hidden="true" tabindex="-1"></a>As a result, our predicted values for the dependent variable will be calculates as follows:</span>
<span id="cb83-300"><a href="#cb83-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-301"><a href="#cb83-301" aria-hidden="true" tabindex="-1"></a>|                   | $D_1$ | $D_2$ |                                        |</span>
<span id="cb83-302"><a href="#cb83-302" aria-hidden="true" tabindex="-1"></a>|-------------------|:-----:|:-----:|----------------------------------------|</span>
<span id="cb83-303"><a href="#cb83-303" aria-hidden="true" tabindex="-1"></a>| Teaching |   0   |   0   | $\hat Y = \beta_0$                     |</span>
<span id="cb83-304"><a href="#cb83-304" aria-hidden="true" tabindex="-1"></a>| Tenure  Track    |   1   |   0   | $\hat Y = \beta_0 + \beta_1$           |</span>
<span id="cb83-305"><a href="#cb83-305" aria-hidden="true" tabindex="-1"></a>| Tenured           |   1   |   1   | $\hat Y = \beta_0 + \beta_1 + \beta_2$ |</span>
<span id="cb83-306"><a href="#cb83-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-307"><a href="#cb83-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-308"><a href="#cb83-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-311"><a href="#cb83-311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-312"><a href="#cb83-312" aria-hidden="true" tabindex="-1"></a>m_eval5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> tenure <span class="sc">+</span> tenured, <span class="at">data =</span> evals)</span>
<span id="cb83-313"><a href="#cb83-313" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_eval5)</span>
<span id="cb83-314"><a href="#cb83-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-315"><a href="#cb83-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-316"><a href="#cb83-316" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; What is the baseline category here? </span></span>
<span id="cb83-317"><a href="#cb83-317" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; What do the coefficients represent? </span></span>
<span id="cb83-318"><a href="#cb83-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-319"><a href="#cb83-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-320"><a href="#cb83-320" aria-hidden="true" tabindex="-1"></a>Crucially, regression is about _average_ trends in the data. Thus, when interpreting regression coefficients, it is important to indicate this fact:</span>
<span id="cb83-321"><a href="#cb83-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-322"><a href="#cb83-322" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A one unit increase in *predictor* is associated with, on average, *coefficient for predictor* change in the dependent variable. </span></span>
<span id="cb83-323"><a href="#cb83-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-324"><a href="#cb83-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-325"><a href="#cb83-325" aria-hidden="true" tabindex="-1"></a><span class="fu">## Predictions with New Data</span></span>
<span id="cb83-326"><a href="#cb83-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-327"><a href="#cb83-327" aria-hidden="true" tabindex="-1"></a>Let's go back to our model with beauty and course evaluations and generate some fitted values (along with other stats). <span class="in">`augment()`</span> provides us nicely with the fitted values, i.e. predictions for the data points *existing* in our dataset.</span>
<span id="cb83-328"><a href="#cb83-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-331"><a href="#cb83-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-332"><a href="#cb83-332" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">augment</span>(m_eval1)</span>
<span id="cb83-333"><a href="#cb83-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-334"><a href="#cb83-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-335"><a href="#cb83-335" aria-hidden="true" tabindex="-1"></a>Having fitted values, we can plot the line without <span class="in">`geom_smooth()`</span>:</span>
<span id="cb83-336"><a href="#cb83-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-339"><a href="#cb83-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-340"><a href="#cb83-340" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the difference between these plots?</span></span>
<span id="cb83-341"><a href="#cb83-341" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">augment</span>(m_eval1) <span class="sc">%&gt;%</span></span>
<span id="cb83-342"><a href="#cb83-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> beauty, <span class="at">y =</span> eval)) <span class="sc">+</span></span>
<span id="cb83-343"><a href="#cb83-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb83-344"><a href="#cb83-344" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb83-345"><a href="#cb83-345" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb83-346"><a href="#cb83-346" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb83-347"><a href="#cb83-347" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-348"><a href="#cb83-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted)) <span class="sc">+</span></span>
<span id="cb83-349"><a href="#cb83-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb83-350"><a href="#cb83-350" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty"</span>,</span>
<span id="cb83-351"><a href="#cb83-351" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span></span>
<span id="cb83-352"><a href="#cb83-352" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-353"><a href="#cb83-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>, <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb83-354"><a href="#cb83-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb83-355"><a href="#cb83-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-356"><a href="#cb83-356" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">augment</span>(m_eval1) <span class="sc">%&gt;%</span></span>
<span id="cb83-357"><a href="#cb83-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> beauty, <span class="at">y =</span> eval)) <span class="sc">+</span></span>
<span id="cb83-358"><a href="#cb83-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb83-359"><a href="#cb83-359" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb83-360"><a href="#cb83-360" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb83-361"><a href="#cb83-361" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb83-362"><a href="#cb83-362" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-363"><a href="#cb83-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted)) <span class="sc">+</span></span>
<span id="cb83-364"><a href="#cb83-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb83-365"><a href="#cb83-365" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty"</span>,</span>
<span id="cb83-366"><a href="#cb83-366" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span></span>
<span id="cb83-367"><a href="#cb83-367" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-368"><a href="#cb83-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>, <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb83-369"><a href="#cb83-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb83-370"><a href="#cb83-370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-371"><a href="#cb83-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-372"><a href="#cb83-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-373"><a href="#cb83-373" aria-hidden="true" tabindex="-1"></a>To recap the process of calculating fitted values, let's obtain fitted values by hand:</span>
<span id="cb83-374"><a href="#cb83-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-377"><a href="#cb83-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-378"><a href="#cb83-378" aria-hidden="true" tabindex="-1"></a><span class="co"># manually</span></span>
<span id="cb83-379"><a href="#cb83-379" aria-hidden="true" tabindex="-1"></a><span class="co"># say we want to predict the evaluations of someone with beauty score of, say, 5</span></span>
<span id="cb83-380"><a href="#cb83-380" aria-hidden="true" tabindex="-1"></a>m_eval1<span class="sc">$</span>coefficients <span class="co"># or coef(m_eval1)</span></span>
<span id="cb83-381"><a href="#cb83-381" aria-hidden="true" tabindex="-1"></a>manual_pred <span class="ot">&lt;-</span> m_eval1<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> m_eval1<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb83-382"><a href="#cb83-382" aria-hidden="true" tabindex="-1"></a>manual_pred <span class="co"># note the name of the object is misleading</span></span>
<span id="cb83-383"><a href="#cb83-383" aria-hidden="true" tabindex="-1"></a>manual_pred <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>() <span class="co"># remove the name</span></span>
<span id="cb83-384"><a href="#cb83-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-385"><a href="#cb83-385" aria-hidden="true" tabindex="-1"></a><span class="co"># or for a sequence of beauty scores from 1 to 10 at once</span></span>
<span id="cb83-386"><a href="#cb83-386" aria-hidden="true" tabindex="-1"></a>manual_pred <span class="ot">&lt;-</span> m_eval1<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> m_eval1<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb83-387"><a href="#cb83-387" aria-hidden="true" tabindex="-1"></a>manual_pred</span>
<span id="cb83-388"><a href="#cb83-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-389"><a href="#cb83-389" aria-hidden="true" tabindex="-1"></a><span class="co"># with predict() function</span></span>
<span id="cb83-390"><a href="#cb83-390" aria-hidden="true" tabindex="-1"></a><span class="co"># create a tibble with the columns we need (using the basic tibble function)</span></span>
<span id="cb83-391"><a href="#cb83-391" aria-hidden="true" tabindex="-1"></a>evals_new <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb83-392"><a href="#cb83-392" aria-hidden="true" tabindex="-1"></a>  <span class="at">beauty =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb83-393"><a href="#cb83-393" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-394"><a href="#cb83-394" aria-hidden="true" tabindex="-1"></a><span class="co"># create a tibble with the columns we need</span></span>
<span id="cb83-395"><a href="#cb83-395" aria-hidden="true" tabindex="-1"></a><span class="co"># expand_grid will create all possible combinations of variable values</span></span>
<span id="cb83-396"><a href="#cb83-396" aria-hidden="true" tabindex="-1"></a><span class="co"># will be useful with more than one variable later</span></span>
<span id="cb83-397"><a href="#cb83-397" aria-hidden="true" tabindex="-1"></a>evals_nes <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb83-398"><a href="#cb83-398" aria-hidden="true" tabindex="-1"></a>  <span class="at">beauty =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb83-399"><a href="#cb83-399" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-400"><a href="#cb83-400" aria-hidden="true" tabindex="-1"></a>evals_new</span>
<span id="cb83-401"><a href="#cb83-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-402"><a href="#cb83-402" aria-hidden="true" tabindex="-1"></a><span class="co"># add predictions to this data</span></span>
<span id="cb83-403"><a href="#cb83-403" aria-hidden="true" tabindex="-1"></a>evals_new <span class="ot">&lt;-</span> evals_new <span class="sc">%&gt;%</span></span>
<span id="cb83-404"><a href="#cb83-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred =</span> <span class="fu">predict</span>(m_eval1, <span class="at">newdata =</span> .))</span>
<span id="cb83-405"><a href="#cb83-405" aria-hidden="true" tabindex="-1"></a>evals_new</span>
<span id="cb83-406"><a href="#cb83-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-407"><a href="#cb83-407" aria-hidden="true" tabindex="-1"></a><span class="co"># check that manual predictions are the same as predict()</span></span>
<span id="cb83-408"><a href="#cb83-408" aria-hidden="true" tabindex="-1"></a>manual_pred <span class="sc">==</span> evals_new<span class="sc">$</span>pred</span>
<span id="cb83-409"><a href="#cb83-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-410"><a href="#cb83-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-411"><a href="#cb83-411" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Why did we choose </span><span class="in">`by = 1`</span><span class="at"> in </span><span class="in">`seq()`</span><span class="at"> function? Can we set it to another value? </span></span>
<span id="cb83-412"><a href="#cb83-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-413"><a href="#cb83-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-416"><a href="#cb83-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-417"><a href="#cb83-417" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(evals_new, <span class="fu">aes</span>(<span class="at">x =</span> beauty, <span class="at">y =</span> pred)) <span class="sc">+</span></span>
<span id="cb83-418"><a href="#cb83-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb83-419"><a href="#cb83-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb83-420"><a href="#cb83-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-421"><a href="#cb83-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-422"><a href="#cb83-422" aria-hidden="true" tabindex="-1"></a><span class="fu">### Practice: Predictions for Categorical Variables </span></span>
<span id="cb83-423"><a href="#cb83-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-424"><a href="#cb83-424" aria-hidden="true" tabindex="-1"></a>Work with the model for gender's effect on evaluations (<span class="in">`m_eval2`</span>). Calculate the predictions manually for both males and females:</span>
<span id="cb83-425"><a href="#cb83-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-428"><a href="#cb83-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-429"><a href="#cb83-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-430"><a href="#cb83-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-431"><a href="#cb83-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-432"><a href="#cb83-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-433"><a href="#cb83-433" aria-hidden="true" tabindex="-1"></a><span class="fu">## Residuals &amp; Diagnostics</span></span>
<span id="cb83-434"><a href="#cb83-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-435"><a href="#cb83-435" aria-hidden="true" tabindex="-1"></a>Linear regression comes with a number of assumptions, and inspecting residuals allows us to check whether they are met. </span>
<span id="cb83-436"><a href="#cb83-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-437"><a href="#cb83-437" aria-hidden="true" tabindex="-1"></a>A residuals plot is a scatterplot of the regression residuals against the explanatory variable $X$ or the predicted (fitted) values $\hat Y$. Residual plot is a diagnostic plot as it helps us to detect patterns in the residuals. Patterns in residuals signal that systematic influences on $Y $still have not been captured by our model, or that our model misrepresents the data, or that errors do</span>
<span id="cb83-438"><a href="#cb83-438" aria-hidden="true" tabindex="-1"></a>not have a constant variance. Ideally, residuals plots should look as if the pattern was generated by pure chance.</span>
<span id="cb83-439"><a href="#cb83-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-440"><a href="#cb83-440" aria-hidden="true" tabindex="-1"></a>Let's have a look at the residuals plot (recall that <span class="in">`augment()`</span> calculates them for us):</span>
<span id="cb83-441"><a href="#cb83-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-444"><a href="#cb83-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-445"><a href="#cb83-445" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(m_eval1) <span class="sc">%&gt;%</span></span>
<span id="cb83-446"><a href="#cb83-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> beauty, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb83-447"><a href="#cb83-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb83-448"><a href="#cb83-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb83-449"><a href="#cb83-449" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb83-450"><a href="#cb83-450" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#800010"</span></span>
<span id="cb83-451"><a href="#cb83-451" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-452"><a href="#cb83-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb83-453"><a href="#cb83-453" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty Score"</span>,</span>
<span id="cb83-454"><a href="#cb83-454" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residuals"</span></span>
<span id="cb83-455"><a href="#cb83-455" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-456"><a href="#cb83-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> F) <span class="co"># loess can help identify patterns</span></span>
<span id="cb83-457"><a href="#cb83-457" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-458"><a href="#cb83-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-459"><a href="#cb83-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-460"><a href="#cb83-460" aria-hidden="true" tabindex="-1"></a>Let's think about the constant variance, a.k.a. homoskedasticity, assumption:</span>
<span id="cb83-461"><a href="#cb83-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-462"><a href="#cb83-462" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; What can we say about variance of residuals across the values of our independent variable, *Beauty Score*? Do we seem to be able to predict evaluations for some values of *Beauty Score* better (i.e. they have smaller residuals) than for others (i.e. the residuals are larger)?</span></span>
<span id="cb83-463"><a href="#cb83-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-464"><a href="#cb83-464" aria-hidden="true" tabindex="-1"></a>Now about the conditional mean assumption:</span>
<span id="cb83-465"><a href="#cb83-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-466"><a href="#cb83-466" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Do the residuals, across each value of *Beauty score*, seem to sum up to zero (cancel each other out, are distributed equally above and below the zero line)?</span></span>
<span id="cb83-467"><a href="#cb83-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-468"><a href="#cb83-468" aria-hidden="true" tabindex="-1"></a>When inspecting the residuals, it is important to identify observations that may be dominating the estimates, and to assess how results change when such dominating data points are dropped. Here is a reminder on the terminology here:</span>
<span id="cb83-469"><a href="#cb83-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-470"><a href="#cb83-470" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*Outlier*: An observation with a *large residual*; may indicate a sample peculiarity, a data entry error, or some other problems.</span>
<span id="cb83-471"><a href="#cb83-471" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*Leverage*: An observation with an extreme value on an *independent* variable is said to have high leverage. Leverage is a measure of how far an independent variable deviates from its mean. These leverage points may have an effect on the estimate of regression</span>
<span id="cb83-472"><a href="#cb83-472" aria-hidden="true" tabindex="-1"></a>coefficients.</span>
<span id="cb83-473"><a href="#cb83-473" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*Influence*: An observation is said to be influential if removing the observation substantially changes the estimate of coefficients.</span>
<span id="cb83-474"><a href="#cb83-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-475"><a href="#cb83-475" aria-hidden="true" tabindex="-1"></a>Now let's check the model for these influential points:</span>
<span id="cb83-476"><a href="#cb83-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-477"><a href="#cb83-477" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Which observations (if any) seem to have large residuals, i.e. are potential outliers?</span></span>
<span id="cb83-478"><a href="#cb83-478" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Which observations seem to be leverage points (if any)? </span></span>
<span id="cb83-479"><a href="#cb83-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-480"><a href="#cb83-480" aria-hidden="true" tabindex="-1"></a>There is also another useful quantity to evaluate influence, *Cook’s distance*: it is a measure of influence, which aggregates outlier and leverage properties together. The measure of Cook's distance is based on the difference in predicted (fitted) values with</span>
<span id="cb83-481"><a href="#cb83-481" aria-hidden="true" tabindex="-1"></a>and without particular observations. <span class="in">`augment()`</span> calculates it for us:</span>
<span id="cb83-482"><a href="#cb83-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-485"><a href="#cb83-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-486"><a href="#cb83-486" aria-hidden="true" tabindex="-1"></a>m_eval1 <span class="sc">%&gt;%</span></span>
<span id="cb83-487"><a href="#cb83-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-488"><a href="#cb83-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(.cooksd) <span class="sc">%&gt;%</span></span>
<span id="cb83-489"><a href="#cb83-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb83-490"><a href="#cb83-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-491"><a href="#cb83-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-492"><a href="#cb83-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-493"><a href="#cb83-493" aria-hidden="true" tabindex="-1"></a>There are multiple interpretations for this measure, with some researchers recommending to be suspicious of observations with $D_i &gt; 1$ and others goind as far as $\frac{4}{n}$, with $n$ being the sample size. </span>
<span id="cb83-494"><a href="#cb83-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-497"><a href="#cb83-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-498"><a href="#cb83-498" aria-hidden="true" tabindex="-1"></a>m_eval1 <span class="sc">%&gt;%</span></span>
<span id="cb83-499"><a href="#cb83-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-500"><a href="#cb83-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.cooksd <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb83-501"><a href="#cb83-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-502"><a href="#cb83-502" aria-hidden="true" tabindex="-1"></a>m_eval1 <span class="sc">%&gt;%</span></span>
<span id="cb83-503"><a href="#cb83-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-504"><a href="#cb83-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.cooksd <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">n</span>())</span>
<span id="cb83-505"><a href="#cb83-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-506"><a href="#cb83-506" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(m_eval1) <span class="sc">%&gt;%</span></span>
<span id="cb83-507"><a href="#cb83-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">large_cd =</span> <span class="fu">if_else</span>(.cooksd <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">n</span>(), <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-508"><a href="#cb83-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> beauty, <span class="at">y =</span> .resid, <span class="at">color =</span> large_cd)) <span class="sc">+</span></span>
<span id="cb83-509"><a href="#cb83-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb83-510"><a href="#cb83-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb83-511"><a href="#cb83-511" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb83-512"><a href="#cb83-512" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#800010"</span></span>
<span id="cb83-513"><a href="#cb83-513" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-514"><a href="#cb83-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb83-515"><a href="#cb83-515" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty Score"</span>,</span>
<span id="cb83-516"><a href="#cb83-516" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb83-517"><a href="#cb83-517" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Cook's Distance above 4/n"</span></span>
<span id="cb83-518"><a href="#cb83-518" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-519"><a href="#cb83-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb83-520"><a href="#cb83-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span>
<span id="cb83-521"><a href="#cb83-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-522"><a href="#cb83-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-523"><a href="#cb83-523" aria-hidden="true" tabindex="-1"></a>In general, if we have observations with "large" Cook's distance, we either want to re-specify our model to account for outliers (do they have something in common?) or to exclude them  (and acknowledge that) and re-estimate the model to see if the results change.</span>
<span id="cb83-524"><a href="#cb83-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-525"><a href="#cb83-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-526"><a href="#cb83-526" aria-hidden="true" tabindex="-1"></a>With this being a bivariate regression, it is quite likely that there are other variables that are not accounted for. For the sake of demonstration, however, we will re-estimate the model here, dropping the observations with high Cook's distance:</span>
<span id="cb83-527"><a href="#cb83-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-530"><a href="#cb83-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-531"><a href="#cb83-531" aria-hidden="true" tabindex="-1"></a>evals_sample <span class="ot">&lt;-</span> m_eval1 <span class="sc">%&gt;%</span></span>
<span id="cb83-532"><a href="#cb83-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-533"><a href="#cb83-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.cooksd <span class="sc">&lt;=</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">n</span>())</span>
<span id="cb83-534"><a href="#cb83-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-535"><a href="#cb83-535" aria-hidden="true" tabindex="-1"></a><span class="co"># re-estimate the model</span></span>
<span id="cb83-536"><a href="#cb83-536" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(eval <span class="sc">~</span> beauty, <span class="at">data =</span> evals_sample) <span class="sc">%&gt;%</span></span>
<span id="cb83-537"><a href="#cb83-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb83-538"><a href="#cb83-538" aria-hidden="true" tabindex="-1"></a><span class="co"># original model</span></span>
<span id="cb83-539"><a href="#cb83-539" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_eval1)</span>
<span id="cb83-540"><a href="#cb83-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-541"><a href="#cb83-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-542"><a href="#cb83-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-543"><a href="#cb83-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-544"><a href="#cb83-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-545"><a href="#cb83-545" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multiple Linear Regression</span></span>
<span id="cb83-546"><a href="#cb83-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-549"><a href="#cb83-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-550"><a href="#cb83-550" aria-hidden="true" tabindex="-1"></a>m_eval6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> beauty <span class="sc">+</span> female, <span class="at">data =</span> evals)</span>
<span id="cb83-551"><a href="#cb83-551" aria-hidden="true" tabindex="-1"></a>res_eval6 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(m_eval6)</span>
<span id="cb83-552"><a href="#cb83-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-553"><a href="#cb83-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-554"><a href="#cb83-554" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; What is missing in this interpretation?\</span></span>
<span id="cb83-555"><a href="#cb83-555" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - A one-unit increase in </span><span class="in">`beauty`</span><span class="at"> is associated with, on average, </span><span class="in">`r round(m_eval6$coefficients["beauty"], 3)`</span><span class="at"> increase in teaching evaluation score.</span></span>
<span id="cb83-556"><a href="#cb83-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-557"><a href="#cb83-557" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualizing MLR with Continuous and Categorical Predictor</span></span>
<span id="cb83-558"><a href="#cb83-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-559"><a href="#cb83-559" aria-hidden="true" tabindex="-1"></a>Let's visualize this model. What seems off on this plot?</span>
<span id="cb83-560"><a href="#cb83-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-561"><a href="#cb83-561" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>The regression line does not correspond to the model we estimated (i.e. the line is just the bivariate relationship between y and x)</span>
<span id="cb83-562"><a href="#cb83-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-563"><a href="#cb83-563" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Female seems like a continuous variable (which is not the case in this dataset)</span>
<span id="cb83-564"><a href="#cb83-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-567"><a href="#cb83-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-568"><a href="#cb83-568" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(evals, <span class="fu">aes</span>(beauty, eval, <span class="at">color =</span> female)) <span class="sc">+</span></span>
<span id="cb83-569"><a href="#cb83-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb83-570"><a href="#cb83-570" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb83-571"><a href="#cb83-571" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb83-572"><a href="#cb83-572" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb83-573"><a href="#cb83-573" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-574"><a href="#cb83-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb83-575"><a href="#cb83-575" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty"</span>,</span>
<span id="cb83-576"><a href="#cb83-576" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span></span>
<span id="cb83-577"><a href="#cb83-577" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-578"><a href="#cb83-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>, <span class="at">se =</span> F)</span>
<span id="cb83-579"><a href="#cb83-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-580"><a href="#cb83-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-581"><a href="#cb83-581" aria-hidden="true" tabindex="-1"></a>Changing the type of the <span class="in">`female`</span> variable to character or to factor fixed the latter problem, and we have two lines now, one for females and one for males. But according to our model specification, the lines should be parallel, i.e. the effect of beauty is assumed to be the same for both males and females:</span>
<span id="cb83-582"><a href="#cb83-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-585"><a href="#cb83-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-586"><a href="#cb83-586" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb83-587"><a href="#cb83-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">female =</span> <span class="fu">if_else</span>(female <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Female"</span>, <span class="st">"Male"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-588"><a href="#cb83-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(beauty, <span class="at">y =</span> eval, <span class="at">color =</span> (female))) <span class="sc">+</span></span>
<span id="cb83-589"><a href="#cb83-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb83-590"><a href="#cb83-590" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb83-591"><a href="#cb83-591" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb83-592"><a href="#cb83-592" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb83-593"><a href="#cb83-593" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-594"><a href="#cb83-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb83-595"><a href="#cb83-595" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty"</span>,</span>
<span id="cb83-596"><a href="#cb83-596" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span></span>
<span id="cb83-597"><a href="#cb83-597" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-598"><a href="#cb83-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span>
<span id="cb83-599"><a href="#cb83-599" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-600"><a href="#cb83-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-601"><a href="#cb83-601" aria-hidden="true" tabindex="-1"></a>We can manually draw to separate lines with <span class="in">`geom_abline()`</span> like this:</span>
<span id="cb83-602"><a href="#cb83-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-605"><a href="#cb83-605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-606"><a href="#cb83-606" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb83-607"><a href="#cb83-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">female =</span> <span class="fu">if_else</span>(female <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Female"</span>, <span class="st">"Male"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-608"><a href="#cb83-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(beauty, <span class="at">y =</span> eval, <span class="at">color =</span> (female))) <span class="sc">+</span></span>
<span id="cb83-609"><a href="#cb83-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb83-610"><a href="#cb83-610" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb83-611"><a href="#cb83-611" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb83-612"><a href="#cb83-612" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb83-613"><a href="#cb83-613" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-614"><a href="#cb83-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb83-615"><a href="#cb83-615" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty"</span>,</span>
<span id="cb83-616"><a href="#cb83-616" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span></span>
<span id="cb83-617"><a href="#cb83-617" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-618"><a href="#cb83-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb83-619"><a href="#cb83-619" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> res_eval6<span class="sc">$</span>estimate[<span class="dv">1</span>],</span>
<span id="cb83-620"><a href="#cb83-620" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> res_eval6<span class="sc">$</span>estimate[<span class="dv">2</span>],</span>
<span id="cb83-621"><a href="#cb83-621" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="dv">2</span>)[<span class="dv">1</span>] <span class="co"># set matching color manually</span></span>
<span id="cb83-622"><a href="#cb83-622" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-623"><a href="#cb83-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb83-624"><a href="#cb83-624" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> res_eval6<span class="sc">$</span>estimate[<span class="dv">1</span>] <span class="sc">+</span> res_eval6<span class="sc">$</span>estimate[<span class="dv">3</span>],</span>
<span id="cb83-625"><a href="#cb83-625" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> res_eval6<span class="sc">$</span>estimate[<span class="dv">2</span>],</span>
<span id="cb83-626"><a href="#cb83-626" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="dv">2</span>)[<span class="dv">2</span>] <span class="co"># set matching color manually</span></span>
<span id="cb83-627"><a href="#cb83-627" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-628"><a href="#cb83-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb83-629"><a href="#cb83-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb83-630"><a href="#cb83-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb83-631"><a href="#cb83-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb83-632"><a href="#cb83-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">5.5</span>)) <span class="sc">+</span> <span class="co"># why not c(1, 5)?</span></span>
<span id="cb83-633"><a href="#cb83-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span>
<span id="cb83-634"><a href="#cb83-634" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-635"><a href="#cb83-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-636"><a href="#cb83-636" aria-hidden="true" tabindex="-1"></a>Or we can use <span class="in">`geom_line()`</span> and <span class="in">`predict()`</span> function to plot the parallel lines much quicker. Note that in this case, the regression lines are only plotted for the range of data we have, unlike the <span class="in">`geom_abline()`</span>. The latter does what is called *extrapolation* outside of the range of our data.</span>
<span id="cb83-637"><a href="#cb83-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-640"><a href="#cb83-640" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-641"><a href="#cb83-641" aria-hidden="true" tabindex="-1"></a>evals <span class="sc">%&gt;%</span></span>
<span id="cb83-642"><a href="#cb83-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">female =</span> <span class="fu">if_else</span>(female <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Female"</span>, <span class="st">"Male"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-643"><a href="#cb83-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(beauty, <span class="at">y =</span> eval, <span class="at">color =</span> (female))) <span class="sc">+</span></span>
<span id="cb83-644"><a href="#cb83-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb83-645"><a href="#cb83-645" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb83-646"><a href="#cb83-646" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb83-647"><a href="#cb83-647" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span></span>
<span id="cb83-648"><a href="#cb83-648" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-649"><a href="#cb83-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb83-650"><a href="#cb83-650" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Beauty"</span>,</span>
<span id="cb83-651"><a href="#cb83-651" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Teaching Evaluation"</span>,</span>
<span id="cb83-652"><a href="#cb83-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between Instructor Beauty and Course Evaluations"</span>,</span>
<span id="cb83-653"><a href="#cb83-653" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Instructor is"</span></span>
<span id="cb83-654"><a href="#cb83-654" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb83-655"><a href="#cb83-655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(m_eval6))) <span class="sc">+</span> <span class="co"># plots the parallel lines</span></span>
<span id="cb83-656"><a href="#cb83-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb83-657"><a href="#cb83-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb83-658"><a href="#cb83-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb83-659"><a href="#cb83-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">5.5</span>)) <span class="sc">+</span> <span class="co"># why not c(1, 5)?</span></span>
<span id="cb83-660"><a href="#cb83-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span>
<span id="cb83-661"><a href="#cb83-661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-662"><a href="#cb83-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-663"><a href="#cb83-663" aria-hidden="true" tabindex="-1"></a><span class="fu">### Models with Multiple Predictors</span></span>
<span id="cb83-664"><a href="#cb83-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-667"><a href="#cb83-667" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-668"><a href="#cb83-668" aria-hidden="true" tabindex="-1"></a>m_eval7 <span class="ot">&lt;-</span> <span class="fu">lm</span>(eval <span class="sc">~</span> beauty <span class="sc">+</span> female <span class="sc">+</span> age <span class="sc">+</span> nonenglish, <span class="at">data =</span> evals)</span>
<span id="cb83-669"><a href="#cb83-669" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m_eval7)</span>
<span id="cb83-670"><a href="#cb83-670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-671"><a href="#cb83-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-672"><a href="#cb83-672" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>How do we interpret these coefficients?</span>
<span id="cb83-673"><a href="#cb83-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-674"><a href="#cb83-674" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; For a male English instructor with beauty score of zero and of age zero, the teaching evaluations are expected to be 3.89. This value is meaningless as age of zero is not possible given the assumed DGP.\</span></span>
<span id="cb83-675"><a href="#cb83-675" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A one point increase in the beauty score is, on average, associated with a 0.08 increase in course evaluations, holding all else constant. &nbsp; Course of female instructors are, on average, evaluated 0.21 points lower than courses of male instructors, holding age, beauty, and native language constant.\</span></span>
<span id="cb83-676"><a href="#cb83-676" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Having English as their native language is associated with an average increase of 0.33 points in course evaluations, holding all else constant.\</span></span>
<span id="cb83-677"><a href="#cb83-677" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; On average, every additional 10 years in age of the professor are associated with a 0.02 decrease in course evaluations, holding the beauty, sex, and native language constant.\</span></span>
<span id="cb83-678"><a href="#cb83-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-679"><a href="#cb83-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-680"><a href="#cb83-680" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb83-681"><a href="#cb83-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-682"><a href="#cb83-682" aria-hidden="true" tabindex="-1"></a><span class="fu">## Working with Model Output</span></span>
<span id="cb83-683"><a href="#cb83-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-684"><a href="#cb83-684" aria-hidden="true" tabindex="-1"></a><span class="fu">### Well-formatted Table</span></span>
<span id="cb83-685"><a href="#cb83-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-686"><a href="#cb83-686" aria-hidden="true" tabindex="-1"></a>There are plenty of packages that you can use to make nice regression tables. We will primarily use <span class="in">`modelsummary`</span>, which works well for both HTML and PDF formats and requires no extra manipulations.</span>
<span id="cb83-687"><a href="#cb83-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-690"><a href="#cb83-690" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-691"><a href="#cb83-691" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb83-692"><a href="#cb83-692" aria-hidden="true" tabindex="-1"></a>  <span class="at">models =</span> <span class="fu">list</span>(m_eval1, m_eval2, m_eval5),</span>
<span id="cb83-693"><a href="#cb83-693" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Linear Regression Estimates"</span>,</span>
<span id="cb83-694"><a href="#cb83-694" aria-hidden="true" tabindex="-1"></a>  <span class="at">gof_omit =</span> <span class="st">"IC|F|Log."</span>,</span>
<span id="cb83-695"><a href="#cb83-695" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"lccc"</span>),</span>
<span id="cb83-696"><a href="#cb83-696" aria-hidden="true" tabindex="-1"></a>  <span class="at">coef_map =</span> <span class="fu">c</span>( <span class="co"># renames + selects + orders coefs in the table</span></span>
<span id="cb83-697"><a href="#cb83-697" aria-hidden="true" tabindex="-1"></a>    <span class="st">"beauty"</span> <span class="ot">=</span> <span class="st">"Beauty Score"</span>,</span>
<span id="cb83-698"><a href="#cb83-698" aria-hidden="true" tabindex="-1"></a>    <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"Female"</span>,</span>
<span id="cb83-699"><a href="#cb83-699" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tenure"</span> <span class="ot">=</span> <span class="st">"Rank: Tenure Track"</span>,</span>
<span id="cb83-700"><a href="#cb83-700" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tenured"</span> <span class="ot">=</span> <span class="st">"Rank: Tenured"</span>,</span>
<span id="cb83-701"><a href="#cb83-701" aria-hidden="true" tabindex="-1"></a>    <span class="st">"(Intercept)"</span> <span class="ot">=</span> <span class="st">"Intercept"</span></span>
<span id="cb83-702"><a href="#cb83-702" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-703"><a href="#cb83-703" aria-hidden="true" tabindex="-1"></a>  <span class="at">notes =</span> <span class="st">"Notes: Standard errors in parentheses. Baseline category for Rank variable is Teaching."</span>,</span>
<span id="cb83-704"><a href="#cb83-704" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>, <span class="co"># round to 3 digits after zero</span></span>
<span id="cb83-705"><a href="#cb83-705" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>, <span class="co"># have no extra columns for SE</span></span>
<span id="cb83-706"><a href="#cb83-706" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> <span class="st">"{estimate} ({std.error})"</span>, <span class="co"># print coef and SE in one line</span></span>
<span id="cb83-707"><a href="#cb83-707" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-708"><a href="#cb83-708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-709"><a href="#cb83-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-710"><a href="#cb83-710" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regression equation</span></span>
<span id="cb83-711"><a href="#cb83-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-712"><a href="#cb83-712" aria-hidden="true" tabindex="-1"></a>While writing papers (in this class and beyond), you will be asked to specify your regression' systematic component. It is fairly easy to do with Latex <span class="sc">\[</span>Lah-tech<span class="sc">\]</span>, a special typesetting environment perfect for writing up formulas and equations. Here is how you would write the systematic component of the last model we worked with. You would write something like...</span>
<span id="cb83-713"><a href="#cb83-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-714"><a href="#cb83-714" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; I estimate an OLS model with the following systematic component: $$</span></span>
<span id="cb83-715"><a href="#cb83-715" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; \operatorname{\widehat{Evaluation}} = \hat \beta_{0} + \hat\beta_{1}\text{Beauty Score}</span></span>
<span id="cb83-716"><a href="#cb83-716" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $$</span></span>
<span id="cb83-717"><a href="#cb83-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-718"><a href="#cb83-718" aria-hidden="true" tabindex="-1"></a>This usually goes in the *Analysis* section of the research paper.</span>
<span id="cb83-719"><a href="#cb83-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-720"><a href="#cb83-720" aria-hidden="true" tabindex="-1"></a>Good news: some smart people also wrote a package <span class="in">`equatiomatic`</span> that extracts the model equations from model objects directly:</span>
<span id="cb83-721"><a href="#cb83-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-724"><a href="#cb83-724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-725"><a href="#cb83-725" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: asis</span></span>
<span id="cb83-726"><a href="#cb83-726" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: fenced</span></span>
<span id="cb83-727"><a href="#cb83-727" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(m_eval1, <span class="at">intercept =</span> <span class="st">"beta"</span>, <span class="at">ital_vars =</span> T)</span>
<span id="cb83-728"><a href="#cb83-728" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-729"><a href="#cb83-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-730"><a href="#cb83-730" aria-hidden="true" tabindex="-1"></a>Note a few things:</span>
<span id="cb83-731"><a href="#cb83-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-732"><a href="#cb83-732" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>this equation is different from what we wrote above: it includes the error term, so it covers both the systematic and the stochastic components of the model</span>
<span id="cb83-733"><a href="#cb83-733" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>we need to tell <span class="in">`R`</span> to treat the output as raw text by specifying chunk option <span class="in">`#| results: asis`</span> for the equation to appear correctly</span>
<span id="cb83-734"><a href="#cb83-734" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>this works well with HTML output, but sometimes can cause troubles in PDF. A quick fix would be to start with the output provided, edit it, and insert it manually</span>
<span id="cb83-735"><a href="#cb83-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-736"><a href="#cb83-736" aria-hidden="true" tabindex="-1"></a><span class="fu">## Resources</span></span>
<span id="cb83-737"><a href="#cb83-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-738"><a href="#cb83-738" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bivariate Regression Analysis and Diagnostics in <span class="ot">&lt;https://openintro-ims2.netlify.app/07-model-slr&gt;</span></span>
<span id="cb83-739"><a href="#cb83-739" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Multiple Linear Regression Analysis in <span class="ot">&lt;https://openintro-ims2.netlify.app/08-model-mlr&gt;</span></span>
<span id="cb83-740"><a href="#cb83-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-741"><a href="#cb83-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-742"><a href="#cb83-742" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Prep Example: Course Evaluations Data</span></span>
<span id="cb83-743"><a href="#cb83-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-746"><a href="#cb83-746" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-747"><a href="#cb83-747" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">"http://www.stat.ucla.edu/~handcock/216/examples/beauty/ProfEvaltnsBeautyPublic.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-748"><a href="#cb83-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-749"><a href="#cb83-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb83-750"><a href="#cb83-750" aria-hidden="true" tabindex="-1"></a>    <span class="at">class0 =</span> (<span class="fu">sum</span>(<span class="fu">c_across</span>(class1<span class="sc">:</span>class30))),</span>
<span id="cb83-751"><a href="#cb83-751" aria-hidden="true" tabindex="-1"></a>    <span class="at">class0 =</span> <span class="fu">ifelse</span>(class0 <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-752"><a href="#cb83-752" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb83-753"><a href="#cb83-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-754"><a href="#cb83-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(class0, <span class="at">.before =</span> class1) <span class="sc">%&gt;%</span></span>
<span id="cb83-755"><a href="#cb83-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(course_id, val, class0<span class="sc">:</span>class30) <span class="sc">%&gt;%</span></span>
<span id="cb83-756"><a href="#cb83-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(val <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-757"><a href="#cb83-757" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>val) <span class="sc">%&gt;%</span></span>
<span id="cb83-758"><a href="#cb83-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">course_id =</span> <span class="fu">as.numeric</span>(<span class="fu">str_extract</span>(course_id, <span class="st">"</span><span class="sc">\\</span><span class="st">d.*"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-759"><a href="#cb83-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-760"><a href="#cb83-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">beauty =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">starts_with</span>(<span class="st">"beauty"</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb83-761"><a href="#cb83-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-762"><a href="#cb83-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb83-763"><a href="#cb83-763" aria-hidden="true" tabindex="-1"></a>    <span class="at">rank =</span> <span class="fu">case_when</span>(</span>
<span id="cb83-764"><a href="#cb83-764" aria-hidden="true" tabindex="-1"></a>      tenuretrack <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> tenured <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"tenured"</span>,</span>
<span id="cb83-765"><a href="#cb83-765" aria-hidden="true" tabindex="-1"></a>      tenuretrack <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> tenured <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"tenure track"</span>,</span>
<span id="cb83-766"><a href="#cb83-766" aria-hidden="true" tabindex="-1"></a>      tenuretrack <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> tenured <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"teaching"</span></span>
<span id="cb83-767"><a href="#cb83-767" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-768"><a href="#cb83-768" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb83-769"><a href="#cb83-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb83-770"><a href="#cb83-770" aria-hidden="true" tabindex="-1"></a>    <span class="at">prof =</span> profnumber,</span>
<span id="cb83-771"><a href="#cb83-771" aria-hidden="true" tabindex="-1"></a>    <span class="at">eval =</span> courseevaluation,</span>
<span id="cb83-772"><a href="#cb83-772" aria-hidden="true" tabindex="-1"></a>    <span class="at">tenure =</span> tenuretrack</span>
<span id="cb83-773"><a href="#cb83-773" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb83-774"><a href="#cb83-774" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb83-775"><a href="#cb83-775" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"bty"</span>),</span>
<span id="cb83-776"><a href="#cb83-776" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>didevaluation,</span>
<span id="cb83-777"><a href="#cb83-777" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>fulldept,</span>
<span id="cb83-778"><a href="#cb83-778" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>multipleclass,</span>
<span id="cb83-779"><a href="#cb83-779" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>onecredit,</span>
<span id="cb83-780"><a href="#cb83-780" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>percentevaluating,</span>
<span id="cb83-781"><a href="#cb83-781" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>profevaluation,</span>
<span id="cb83-782"><a href="#cb83-782" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb83-783"><a href="#cb83-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(</span>
<span id="cb83-784"><a href="#cb83-784" aria-hidden="true" tabindex="-1"></a>    <span class="at">.fn =</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"bty_"</span>, <span class="fu">str_remove</span>(.x, <span class="st">"beauty"</span>)),</span>
<span id="cb83-785"><a href="#cb83-785" aria-hidden="true" tabindex="-1"></a>    <span class="at">.cols =</span> beautyf2upper<span class="sc">:</span>beautymupperdiv</span>
<span id="cb83-786"><a href="#cb83-786" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%T&gt;%</span></span>
<span id="cb83-787"><a href="#cb83-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(<span class="st">"data/evals.csv"</span>)</span>
<span id="cb83-788"><a href="#cb83-788" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>